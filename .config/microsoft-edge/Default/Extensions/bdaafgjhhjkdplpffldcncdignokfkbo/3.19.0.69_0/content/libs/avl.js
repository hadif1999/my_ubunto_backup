!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.AVLTree=r()}(this,function(){"use strict";function r(t,r){var e=[];return function t(r,e,o,n,a){r&&(n(e+(o?"└── ":"├── ")+a(r)+"\n"),e=e+(o?"    ":"│   "),r.left&&t(r.left,e,!1,n,a),r.right&&t(r.right,e,!0,n,a))}(t,"",!0,function(t){return e.push(t)},r=void 0===r?function(t){return t.key}:r),e.join("")}function n(t){return t?1+Math.max(n(t.left),n(t.right)):0}function e(t,r){return r<t?1:t<r?-1:0}function u(t){var r=t.right;return t.right=r.left,r.left&&(r.left.parent=t),r.parent=t.parent,r.parent&&(r.parent.left===t?r.parent.left=r:r.parent.right=r),((t.parent=r).left=t).balanceFactor+=1,r.balanceFactor<0&&(t.balanceFactor-=r.balanceFactor),r.balanceFactor+=1,0<t.balanceFactor&&(r.balanceFactor+=t.balanceFactor),r}function c(t){var r=t.left;return t.left=r.right,t.left&&(t.left.parent=t),r.parent=t.parent,r.parent&&(r.parent.left===t?r.parent.left=r:r.parent.right=r),--((t.parent=r).right=t).balanceFactor,0<r.balanceFactor&&(t.balanceFactor-=r.balanceFactor),--r.balanceFactor,t.balanceFactor<0&&(r.balanceFactor+=t.balanceFactor),r}function t(t,r){void 0===r&&(r=!1),this._comparator=t||e,this._root=null,this._size=0,this._noDuplicates=!!r}var o={size:{}};return t.prototype.destroy=function(){return this.clear()},t.prototype.clear=function(){return this._root=null,this._size=0,this},o.size.get=function(){return this._size},t.prototype.contains=function(t){if(this._root)for(var r=this._root,e=this._comparator;r;){var o=e(t,r.key);if(0===o)return!0;r=o<0?r.left:r.right}return!1},t.prototype.next=function(t){var r=t;if(r)if(r.right)for(r=r.right;r&&r.left;)r=r.left;else for(r=t.parent;r&&r.right===t;)r=(t=r).parent;return r},t.prototype.prev=function(t){var r=t;if(r)if(r.left)for(r=r.left;r&&r.right;)r=r.right;else for(r=t.parent;r&&r.left===t;)r=(t=r).parent;return r},t.prototype.forEach=function(t){for(var r=this._root,e=[],o=!1,n=0;!o;)r?(e.push(r),r=r.left):0<e.length?(t(r=e.pop(),n++),r=r.right):o=!0;return this},t.prototype.range=function(t,r,e,o){for(var n=[],a=this._comparator,i=this._root;0!==n.length||i;)if(i)n.push(i),i=i.left;else{if(0<a((i=n.pop()).key,r))break;if(0<=a(i.key,t)&&e.call(o,i))return this;i=i.right}return this},t.prototype.keys=function(){for(var t=this._root,r=[],e=[],o=!1;!o;)t?(r.push(t),t=t.left):0<r.length?(t=r.pop(),e.push(t.key),t=t.right):o=!0;return e},t.prototype.values=function(){for(var t=this._root,r=[],e=[],o=!1;!o;)t?(r.push(t),t=t.left):0<r.length?(t=r.pop(),e.push(t.data),t=t.right):o=!0;return e},t.prototype.at=function(t){for(var r=this._root,e=[],o=!1,n=0;!o;)if(r)e.push(r),r=r.left;else if(0<e.length){if(r=e.pop(),n===t)return r;n++,r=r.right}else o=!0;return null},t.prototype.minNode=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t},t.prototype.min=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t.key},t.prototype.max=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t.key},t.prototype.isEmpty=function(){return!this._root},t.prototype.pop=function(){var t=this._root,r=null;if(t){for(;t.left;)t=t.left;r={key:t.key,data:t.data},this.remove(t.key)}return r},t.prototype.find=function(t){for(var r,e=this._root,o=this._comparator;e;){if(0===(r=o(t,e.key)))return e;e=r<0?e.left:e.right}return null},t.prototype.insert=function(t,r){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:t,data:r},this._size++,this._root;var e=this._comparator,o=this._root,n=null,a=0;if(this._noDuplicates)for(;o;){if(0===(a=e(t,(n=o).key)))return null;o=a<0?o.left:o.right}else for(;o;)o=(a=e(t,(n=o).key))<=0?o.left:o.right;var i,r={left:null,right:null,balanceFactor:0,parent:n,key:t,data:r};for(a<=0?n.left=r:n.right=r;n&&((a=e(n.key,t))<0?--n.balanceFactor:n.balanceFactor+=1,0!==n.balanceFactor);){if(n.balanceFactor<-1){1===n.right.balanceFactor&&c(n.right),i=u(n),n===this._root&&(this._root=i);break}if(1<n.balanceFactor){-1===n.left.balanceFactor&&u(n.left),i=c(n),n===this._root&&(this._root=i);break}n=n.parent}return this._size++,r},t.prototype.remove=function(t){if(!this._root)return null;for(var r,e=this._root,o=this._comparator;e&&0!==(r=o(t,e.key));)e=r<0?e.left:e.right;if(!e)return null;var n,a,i=e.key;if(e.left){for(n=e.left;n.left||n.right;){for(;n.right;)n=n.right;e.key=n.key,e.data=n.data,n.left&&(n=(e=n).left)}e.key=n.key,e.data=n.data,e=n}if(e.right){for(a=e.right;a.left||a.right;){for(;a.left;)a=a.left;e.key=a.key,e.data=a.data,a.right&&(a=(e=a).right)}e.key=a.key,e.data=a.data,e=a}for(var f,l=e.parent,h=e;l&&(l.left===h?--l.balanceFactor:l.balanceFactor+=1,l.balanceFactor<-1?(1===l.right.balanceFactor&&c(l.right),f=u(l),l===this._root&&(this._root=f),l=f):1<l.balanceFactor&&(-1===l.left.balanceFactor&&u(l.left),f=c(l),l===this._root&&(this._root=f),l=f),-1!==l.balanceFactor&&1!==l.balanceFactor);)l=(h=l).parent;return e.parent&&(e.parent.left===e?e.parent.left=null:e.parent.right=null),e===this._root&&(this._root=null),this._size--,i},t.prototype.load=function(t,r,e){if(void 0===t&&(t=[]),void 0===r&&(r=[]),0!==this._size)throw new Error("bulk-load: tree is not empty");var o=t.length;return e&&function t(r,e,o,n,a){if(!(n<=o)){for(var i=r[o+n>>1],f=o-1,l=n+1;;){for(;a(r[++f],i)<0;);for(;0<a(r[--l],i););if(l<=f)break;var h=r[f];r[f]=r[l],r[l]=h,h=e[f],e[f]=e[l],e[l]=h}t(r,e,o,l,a),t(r,e,l+1,n,a)}}(t,r,0,o-1,this._comparator),this._root=function t(r,e,o,n,a){var i=a-n;return 0<i?((r={key:e[i=n+Math.floor(i/2)],data:o[i],parent:r}).left=t(r,e,o,n,i),r.right=t(r,e,o,i+1,a),r):null}(null,t,r,0,o),function t(r){if(null===r)return 0;var e=t(r.left),o=t(r.right);return r.balanceFactor=e-o,Math.max(e,o)+1}(this._root),this._size=o,this},t.prototype.isBalanced=function(){return function t(r){if(null===r)return!0;var e=n(r.left),o=n(r.right);return!!(Math.abs(e-o)<=1&&t(r.left)&&t(r.right))}(this._root)},t.prototype.toString=function(t){return r(this._root,t)},Object.defineProperties(t.prototype,o),t.default=t});