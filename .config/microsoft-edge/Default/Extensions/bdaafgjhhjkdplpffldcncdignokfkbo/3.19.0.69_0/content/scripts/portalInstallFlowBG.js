!function(e){"use strict";(e.NSSS=e.NSSS||{}).portalInstallFlowBG=function(a,e){let n=a.utils,r=a.utils.isNil,o=a.utils.isntNil,l=a.extensionAdapter,i=e.constants,S=e.NSSSHelper;const{uiConstants:E,uiConstants:{MESSAGES:_}}=e;let T={_isCurrentExtensionsStoreURL:e=>!(!a.utils.isStorePageURL(e)||!S.isCurrentExtensionURL(e)),_updateTabUrlFlow:(e,s)=>{var t;r(e)||r(s)||(t=l.getWindowIDForTab(e),o(t)&&l.focusWindow(t,()=>{const t=a.extensionAdapter.getTabID(e);o(t)&&l.updateTabUrl(t,s,e=>{l.activateTab(t)})}))},_closeTabUrlFlow:e=>{r(e)||(e=a.extensionAdapter.getTabID(e),o(e)&&l.closeTab(e))},_canUpdateOrCloseTab:e=>{var{BROWSER_TYPE:t}=a["constants"];if(a.globals.BROWSER!==t.EDGE_CHROMIUM||E.EXTENSION_TYPE!==E.SAFEWEB_EXTENSION)return T._isCurrentExtensionsStoreURL(e);if(!n.isStorePageURL(e))return!1;const s=new URL(e).pathname;return i.NORTON_EXTENSION_IDS.some(e=>s.includes(e))},_updateOrCloseExtensionStoreURL:(t,s)=>{t!==_.LOAD_STORE_URL&&t!==_.CLOSE_STORE_PAGE||l.getActiveTab(e=>{o(e)&&(T._canUpdateOrCloseTab(e.url)||S.isChromeInterstitialPageURL(e.url))?t===_.LOAD_STORE_URL?T._updateTabUrlFlow(e,s):T._closeTabUrlFlow(e):l.getAllTabs(e=>{e.forEach(e=>{o(e)&&(T._canUpdateOrCloseTab(e.url)||S.isChromeInterstitialPageURL(e.url))&&(t===_.LOAD_STORE_URL?T._updateTabUrlFlow(e,s):T._closeTabUrlFlow(e))})})})},handleMessage:(e,t,s)=>{var a=e.name;T.constants;switch(a){case _.LOAD_STORE_URL:var n=e.message;T._updateOrCloseExtensionStoreURL(_.LOAD_STORE_URL,n);break;case _.CLOSE_STORE_PAGE:T._updateOrCloseExtensionStoreURL(_.CLOSE_STORE_PAGE)}}};return l.addMessageListener(T.handleMessage),T}(e.SymBfw,e.NSSS)}(executionContext);