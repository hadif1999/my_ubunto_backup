!function(e){"use strict";(e.NSSS=e.NSSS||{}).nfmEvents={NAVIGATE_COMPLETE:"89DF66E0-4A4C-4ECE-800B-AA2048A97207",FRAME_BEGIN:"0740B756-B9DF-4D5E-9BBA-14971AF77194",FRAME_END:"73785734-1E75-4E5D-A6D7-2169F43A9F6E",ONCLOSE:"4B42DBE4-7E80-4851-A19C-98D3903AA93C",DOMCONTENT_LOADED:"951DBC0F-E1DB-4E76-8986-A1339B795123",ANALYZE_SEARCH_DOMAIN:"12837E8F-766E-4DC8-84FF-A2231D728B4A",SEARCH_URLS:"A33AD401-A1BC-40B9-B140-555B0FCC3052",SEARCH_URLS_ANALYZED:"5C5556F8-BDE2-45FD-8991-D65AF9322322",PAGE_ANALYZED:"43139813-E528-4C9F-BD20-BFABABCCB53A",SETTINGS_REQUEST:"902B1CBB-74A2-4500-98B8-075E7E44B0E5",SETTINGS_RESPONSE:"47839CBC-9CC3-4212-B971-C7D1E745FF84",REPORT_SITE:"CAB9C059-62F4-4D3E-964C-13791B476D7C",SEND_PING:"219E396C-E16C-4C49-B182-71486A6B167B",DOWNLOAD_URL_ANALYZED:"8FC606EB-0821-4420-8875-5FF41ED26C9D",DOWNLOAD_EVENT:"5407DEDE-8008-4EFC-A624-AEAFD95A3F9A"}}(this),function(e){"use strict";var t;(e.NSSS=e.NSSS||{}).constants=(t=e.SymBfw,e.NSSS,(e={DEFAULT_HOMEPAGE:"defaultHomepage",DEFAULT_SEARCH:"defaultSearch",TAB_OVERALLSTATUS:"tabstatus",TABID:"tabID",SESSION_CONTAINERS:"SESSION_CONTAINERS"}).TAB_OVERALLSTATUS="tabstatus",e.DID_ONBOARDINGFLOW="didOnBoardingFlow",e.SHOW_FULLREPORT="showFullReport",e.SHOW_REPORTSITE="showReportSite",e.NSSS_GLOBAL_SETTINGS_CONTAINER="44CB4D75-FAD1-449D-9C9E-B0A3090B18B8",e.NSSS_SESSION_SETTINGS_CONTAINER="ef00d2d7-4d47-403b-9491-ce8fafa0bbe6",e.NSSS_INSTALLDATEKEY="extensionInstalldate",e.BLOCKPAGE="blockPage",e.CGUIDKEY="cutomerGuid",e.PARAMSTRINGKEY="paramstring",e.VENDORKEY="vendor",e.DS_OCODE="",e.DHP_OCODE="",e.SEARCH_OCODE="",e.BLOCKEDPAGE_SEARCH_OCODE="",e.TPR="111",e.PRT="SSS",e.VERSION="3.19.0.69",e.PARTNERIDKEY="chn",e.CAMPAIGN_MEDIUM="campaignMedium",e.IS_FLAVORIZED="flavorized",e.DEFAULT_PARTNER_ID="store",e.PRODUCT_NAME="Norton Safe Web",e.TELEMETRY_TRACKING_ID="UA-12436054-58",e.BACKUP_HOMEPAGE="backupHomePage",e.PRODUCT_LABEL=t.extensionAdapter.getExtensionId()+"-"+e.VERSION,e.TELEMETRY_OPTOUT_URL="https://##TELEMETRY_OPTOUT_URI##.norton.com/xbp-tour",e.TELEMETRY_OPTOUT_TIMEOUT="##TELEMETRYTIMEOUT##",e.DEFAULT_INFO_ICON="ic-safeweb-info-50.svg",e.IS_HP_FIRST_LAUNCH="isHPFirstLaunch",e.IS_DSP_FIRST_LAUNCH="isDSPFirstLaunch",e.HP_ID="ophopjonlomiomjdjphigoapegkicmih",e.MYWAY_SECURE_SEARCH_CHROME_EXTN_ID="aipacdclkmcnfkfoiebiokfemanllgag",e.MYWAY_IFRAME_HP_URL="https://hp.norton.myway.com/norton/",e.MYWAY_IFRAME_HP_URL_FF="https://ak.staticimgfarm.com/images/webtooltab/ttdetect-2/prd/ttdetect.html#https://hp.norton.myway.com",e.MYWAY_CHROME_EXTN_PAGE_URL="chrome-extension://"+e.MYWAY_SECURE_SEARCH_CHROME_EXTN_ID,e.CHROME_NEW_TAB_URL="chrome://newtab/",e.FIREFOX_EXTN_URL_START_KEYWORD="moz-extension://",e.FIREFOX_EXTN_NEW_DYNAMIC_TAB_HTML="dynamicNewTab.html",e.FIREFOX_EXTN_NEW_DYNAMIC_HOMEPAGE_HTML="dynamicHomePage.html",e.SHOULD_BLOCK_KEY="shouldBlock",e.CONTINUE_SITE_LOADED_KEY="blockedSiteLoaded",e.NORTONSAFE_HOSTNAME="nortonsafe.search.ask.com",e.SAFE_WEB_EXTENSION="Norton Safe Web",e.HOME_PAGE_EXTENSION="Norton Home Page",e.DEFAULT_SEARCH_EXTENSION="Norton Safe Search",e.SEARCHBOX_VISIBLE="false",e.NATIVE_TAB_PREFIX=["chrome://","about:"],e.ABOUT_BLANK="about:blank",e.POPUP_PAGE="/content/ui/popup.html",e.SETTINGS_PAGE="/content/ui/settings.html",e.HOME_PAGE="homePage.html",e.BUTTON_GLOBAL_CHECKED="../images/btn-global-checked.svg",e.BUTTON_GLOBAL_UNCHECKED="../images/btn-global-unchecked.svg",e.DEFAULT_COUNTRY="US",e.CAUTION_IMAGE="safe-web-icon-norton-caution",e.WARNING_IMAGE="safe-web-icon-warning",e.FORMJACK_IMAGE="safe-web-icon-formjack",e.SUSPICIOUS_IMAGE="safe-web-icon-suspicious",e.UNTESTED_IMAGE="safe-web-icon-norton-untested",e.SAFE_IMAGE="safe-web-icon-norton-safe",e.RETINAL_UNTESTED_IMAGE="safe-web-icon-norton-untested@2x",e.RETINAL_SAFE_IMAGE="safe-web-icon-norton-safe@2x",e.SETTINGS_KEY_DS="defaultSearchEnabled",e.HOME_PAGE_URL="https://search.norton.com/",e.SEARCH_URL="https://nortonsafe.search.ask.com/web",e.VENDOR="ask",e.VENDOR_MIGRATION="##VENDOR_MIGRATION##",e.STORE_URL_NAME="##STORE_URL_NAME##",e.SHOW_CONSENT_UI_UPDATE_FLOW="##SHOW_CONSENT_UI_UPDATE_FLOW##",e.ALLOW_SUSPICIOUS_BLOCK_LIST="allowSuspiciousBlockList",e.ALLOW_SUSPICIOUS_BLOCK_DURATION=18e5,e.MYWAY="myway",e.IAC="ask",e.YAHOO="yahoo",e.VENDOR_IS_PRESENT="vendorIsPresent",e.GET_INSTALL_DATE="getInstallDate",e.GET_ASSOCIATION_DATE="getAssociationDate",e.IAC="ask",e.YAHOO="yahoo",e.ACTUAL_HREF="actualhref",e.REPLACED_HREF="replacedhref",e.CLICK_PREVENTION_GUID="clickPreventionGUID",e.CLICK_PREVENTION_NODE_LIST="clickPreventionNodeList",e.URL_IDENTIFIER="urlIdentifier",e.subLinksURLIdentifiers="sublinksURLIdentifiers",e.FINAL_REDIRECTED_TAB_URL="finalRedirectedTabUrl",e.ENGLISH="en",e.LAUNCHED_ON_EXTENSION_CLICK="launchedOn=extensionClick",e.YAHOO_VENDOR_LOCALES=["en-US","en-CA","fr-CA"],e.GEO_LOCATION_KEY="geo_location",e.CUSTOM_CHICKLETS_KEY="customChicklets",e.events={CLICK:"click",MOUSE_DOWN:"mousedown"},e.SHOW_TWITTER_SECTION="showTwitterSection",e.SHOW_SECURITY_CENTER_SECTION="showSecurityCenterSection",e.CONSENT_IN_PROGRESS_IMAGE="sw-red@3x",e.PRIVACY_CONSENT_ACCEPT_CLICK="privacyConsentAcceptClick",e.HP={Chrome:{[e.YAHOO]:"mhffmephdchhhbfjmdpoaldedhhdanbn",[e.IAC]:null},Firefox:{[e.YAHOO]:"nortonhomepage_ven_y@symantec.com",[e.IAC]:null},"Edge-Chromium":{[e.YAHOO]:"piogpjkklafcodjjjoincimjjeciecnk",[e.IAC]:null}},e.DS={Chrome:{[e.YAHOO]:"mpnlkmlkncncpgnnkmkgoobfpnjmblnk",[e.IAC]:null},Firefox:{[e.YAHOO]:"nortonsafesearch_ul_ven_y_2@symantec.com",[e.IAC]:null},"Edge-Chromium":{[e.YAHOO]:"blbchkkacgjbiiobglcjcmbdhnnnokef",[e.IAC]:null}},e.EXTENSION_PAIR_IDS={"Norton Safe Search":e.HP,"Norton Home Page":e.DS},e.EXTENSION_PAIR_IDS={"Norton Safe Search":e.HP,"Norton Home Page":e.DS},e.CLICK_PREVENTION_MAP="clickPreventionMap",e.CLICK_PREVENTED_TAB="clickPreventedTab",e.PRIVACY_POLICY_SSDCAT=150,e.LEGAL_SSDCAT=151,e.DEFAULT_ORIGIN_VALUE="nsss",e.NEWFEATURE_ORIGIN_VALUE="NewFeature",e.IPS_LEARN_MORE_SSDCAT=137,e.SITE_DIRECTOR_URL="http://sitedirector.norton.com/932743328?ssdcat=SSDCAT_VALUE&env=prod&origin=ORIGIN&displang=iso3:ISO3_LAN_CODE&displocale=iso3:ISO3_COUNTRY_CODE&dest=DESTINATION",e.DEST_PARAM_PRIVACY="privacy",e.DEST_PARAM_LEGAL="legal",e.SITE_DIRECTOR_IPS_URL="http://sitedirector.norton.com/932743328?ssdcat=SSDCAT_VALUE&env=prod&origin=ORIGIN&lang=LAN_CODE",e.SITE_DIRECTOR_ADDITIONAL_PARAM="&layouttype=LAYOUT_TYPE&partnerid=PARTNERID&puid=PUID",e.ISPID="&ispid=55555",e.ISO2_ISO3_LANGUAGE={AB:"ABK",AA:"AAR",AF:"AFR",AK:"AKA",SQ:"SQI",AM:"AMH",AR:"ARA",AN:"ARG",HY:"HYE",AS:"ASM",AV:"AVA",AE:"AVE",AY:"AYM",AZ:"AZE",BM:"BAM",BA:"BAK",EU:"EUS",BE:"BEL",BN:"BEN",BH:"BIH",BI:"BIS",BS:"BOS",BR:"BRE",BG:"BUL",MY:"MYA",CA:"CAT",CH:"CHA",CE:"CHE",NY:"NYA",ZH:"ZHO",CV:"CHV",KW:"COR",CO:"COS",CR:"CRE",HR:"HRV",CS:"CES",DA:"DAN",DV:"DIV",NL:"NLD",DZ:"DZO",EN:"ENG",EO:"EPO",ET:"EST",EE:"EWE",FO:"FAO",FJ:"FIJ",FI:"FIN",FR:"FRA",FF:"FUL",GL:"GLG",KA:"KAT",DE:"DEU",EL:"ELL",GN:"GRN",GU:"GUJ",HT:"HAT",HA:"HAU",HE:"HEB",HZ:"HER",HI:"HIN",HO:"HMO",HU:"HUN",IA:"INA",ID:"IND",IE:"ILE",GA:"GLE",IG:"IBO",IK:"IPK",IO:"IDO",IS:"ISL",IT:"ITA",IU:"IKU",JA:"JPN",JV:"JAV",KL:"KAL",KN:"KAN",KR:"KAU",KS:"KAS",KK:"KAZ",KM:"KHM",KI:"KIK",RW:"KIN",KY:"KIR",KV:"KOM",KG:"KON",KO:"KOR",KU:"KUR",KJ:"KUA",LA:"LAT",LB:"LTZ",LG:"LUG",LI:"LIM",LN:"LIN",LO:"LAO",LT:"LIT",LU:"LUB",LV:"LAV",GV:"GLV",MK:"MKD",MG:"MLG",MS:"MSA",ML:"MAL",MT:"MLT",MI:"MRI",MR:"MAR",MH:"MAH",MN:"MON",NA:"NAU",NV:"NAV",ND:"NDE",NE:"NEP",NG:"NDO",NB:"NOB",NN:"NNO",NO:"NOR",II:"III",NR:"NBL",OC:"OCI",OJ:"OJI",CU:"CHU",OM:"ORM",OR:"ORI",OS:"OSS",PA:"PAN",PI:"PLI",FA:"FAS",PL:"POL",PS:"PUS",PT:"POR",QU:"QUE",RM:"ROH",RN:"RUN",RO:"RON",RU:"RUS",SA:"SAN",SC:"SRD",SD:"SND",SE:"SME",SM:"SMO",SG:"SAG",SR:"SRP",GD:"GLA",SN:"SNA",SI:"SIN",SK:"SLK",SL:"SLV",SO:"SOM",ST:"SOT",ES:"SPA",SU:"SUN",SW:"SWA",SS:"SSW",SV:"SWE",TA:"TAM",TE:"TEL",TG:"TGK",TH:"THA",TI:"TIR",BO:"BOD",TK:"TUK",TL:"TGL",TN:"TSN",TO:"TON",TR:"TUR",TS:"TSO",TT:"TAT",TW:"TWI",TY:"TAH",UG:"UIG",UK:"UKR",UR:"URD",UZ:"UZB",VE:"VEN",VI:"VIE",VO:"VOL",WA:"WLN",CY:"CYM",WO:"WOL",FY:"FRY",XH:"XHO",YI:"YID",YO:"YOR",ZA:"ZHA",ZU:"ZUL"},e.FIREGLASS_SUPPORTED_LAYOUTS=["RETAIL","ESD"],e.BT_LAYOUT_PARTNERID="1003610",e.BT_EE_PARTNERID="1053960",e.BT_EE_PUID="17523",e.ISO2_ISO3_COUNTRY={AX:"ALA",AF:"AFG",AL:"ALB",DZ:"DZA",AS:"ASM",AD:"AND",AO:"AGO",AI:"AIA",AQ:"ATA",AG:"ATG",AR:"ARG",AM:"ARM",AW:"ABW",AU:"AUS",AT:"AUT",AZ:"AZE",BS:"BHS",BH:"BHR",BD:"BGD",BB:"BRB",BY:"BLR",BE:"BEL",BZ:"BLZ",BJ:"BEN",BM:"BMU",BT:"BTN",BO:"BOL",BA:"BIH",BW:"BWA",BV:"BVT",BR:"BRA",IO:"IOT",BN:"BRN",BG:"BGR",BF:"BFA",BI:"BDI",KH:"KHM",CM:"CMR",CA:"CAN",CV:"CPV",KY:"CYM",CF:"CAF",TD:"TCD",CL:"CHL",CN:"CHN",CX:"CXR",CC:"CCK",CO:"COL",KM:"COM",CD:"COD",CG:"COG",CK:"COK",CR:"CRI",CI:"CIV",HR:"HRV",CU:"CUB",CY:"CYP",CZ:"CZE",DK:"DNK",DJ:"DJI",DM:"DMA",DO:"DOM",EC:"ECU",EG:"EGY",SV:"SLV",GQ:"GNQ",ER:"ERI",EE:"EST",ET:"ETH",FK:"FLK",FO:"FRO",FJ:"FJI",FI:"FIN",FR:"FRA",GF:"GUF",PF:"PYF",TF:"ATF",GA:"GAB",GM:"GMB",GE:"GEO",DE:"DEU",GH:"GHA",GI:"GIB",GR:"GRC",GL:"GRL",GD:"GRD",GP:"GLP",GU:"GUM",GT:"GTM",GN:"GIN",GW:"GNB",GY:"GUY",HT:"HTI",HM:"HMD",HN:"HND",HK:"HKG",HU:"HUN",IS:"ISL",IN:"IND",ID:"IDN",IR:"IRN",IQ:"IRQ",IE:"IRL",IL:"ISR",IT:"ITA",JM:"JAM",JP:"JPN",JO:"JOR",KZ:"KAZ",KE:"KEN",KI:"KIR",KP:"PRK",KR:"KOR",KW:"KWT",KG:"KGZ",LA:"LAO",LV:"LVA",LB:"LBN",LS:"LSO",LR:"LBR",LY:"LBY",LI:"LIE",LT:"LTU",LU:"LUX",MO:"MAC",MK:"MKD",MG:"MDG",MW:"MWI",MY:"MYS",MV:"MDV",ML:"MLI",MT:"MLT",MH:"MHL",MQ:"MTQ",MR:"MRT",MU:"MUS",YT:"MYT",MX:"MEX",FM:"FSM",MD:"MDA",MC:"MCO",MN:"MNG",MS:"MSR",MA:"MAR",MZ:"MOZ",MM:"MMR",NA:"NAM",NR:"NRU",NP:"NPL",NL:"NLD",AN:"ANT",NC:"NCL",NZ:"NZL",NI:"NIC",NE:"NER",NG:"NGA",NU:"NIU",NF:"NFK",MP:"MNP",NO:"NOR",OM:"OMN",PK:"PAK",PW:"PLW",PS:"PSE",PA:"PAN",PG:"PNG",PY:"PRY",PE:"PER",PH:"PHL",PN:"PCN",PL:"POL",PT:"PRT",PR:"PRI",QA:"QAT",RE:"REU",RO:"ROU",RU:"RUS",RW:"RWA",SH:"SHN",KN:"KNA",LC:"LCA",PM:"SPM",VC:"VCT",WS:"WSM",SM:"SMR",ST:"STP",SA:"SAU",SN:"SEN",CS:"SCG",SC:"SYC",SL:"SLE",SG:"SGP",SK:"SVK",SI:"SVN",SB:"SLB",SO:"SOM",ZA:"ZAF",GS:"SGS",ES:"ESP",LK:"LKA",SD:"SDN",SR:"SUR",SJ:"SJM",SZ:"SWZ",SE:"SWE",CH:"CHE",SY:"SYR",TW:"TWN",TJ:"TJK",TZ:"TZA",TH:"THA",TL:"TLS",TG:"TGO",TK:"TKL",TO:"TON",TT:"TTO",TN:"TUN",TR:"TUR",TM:"TKM",TC:"TCA",TV:"TUV",UG:"UGA",UA:"UKR",AE:"ARE",GB:"GBR",US:"USA",UM:"UMI",UY:"URY",UZ:"UZB",VU:"VUT",VA:"VAT",VE:"VEN",VN:"VNM",VG:"VGB",VI:"VIR",WF:"WLF",EH:"ESH",YE:"YEM",ZM:"ZMB",ZW:"ZWE"},e.ONBOARDING_URL="https://identitysafe.norton.com/",e.URL_PARAMS_KEY={PARTNERID:"partnerid",CGUID:"guid",DATE_OF_INSTALL:"doi",DATE_OF_ASSOCIATION:"doa",OCODE:"o",PRT:"prt",VERSION:"ver",TPR:"tpr",PARTNER_UNIT_ID:"puid",PRODUCT_NAME:"product",LAYOUT_TYPE:"layouttype",TRACK_ID:"trackId",TYPE:"type",GEO_CODE:"geo",CUSTOMER_TYPE:"ctype",FEATURE:"feature",BROWSER:"browser",CAMPAIGN_CODE:"cmpgnCode",CAMPAIGN_NAME:"cmpgn",INSTALL_SOURCE:"installsource",FULL_VERSION:"version",CHN:"chn",WEEK_OF_ASSOCIATION:"weekOfAssociation",YEAR_OF_ASSOCIATION:"yearOfAssociation",IAC_QUERY:"q",YAHOO_QUERY:"p",HL:"hl",COMMAND:"command",VENDOR_OFFERED:"vendorOffered",VENDOR_OFFERED_ALIAS:"vo",VENDOR_OFFERED_MAPPING:{y:e.YAHOO,i:e.IAC},TEST_ELIGIBILITY:"testEligible",GEO_LOCATION:"geoLoc",GEO_LOCATION_ALIAS:"gl",VENDOR_CONFIGURED:"vendorConfigured",BEACONPARAM:{PARAM1:"param1",PARAM2:"param2",PARAM3:"param3",PARAM4:"param4"},MIGRATION_TYPE:"mType",ANNOTATION:"annot"},e.FG_URL_PARAMS={MID:"mid",PRODUCT_ID:"product_id",PRODUCT_VERSION:"product_version",PRODUCT_NAME:"product_name",DOI:"doi"},e.IS_SERP_CAMPAIGN_ENABLED=!0,e.SERP_SESSION={BLOCK_BY_SERP_CAMPAIGN:"blockedBySerp",OPENER_TAB_ID:"serpOpenerTabId"},e.SERP_CAMPAIGN_SUPPORTED_DOMAIN={"yahoo.com":"YAHOO","ask.com":"ASK"},e.YAHOO_DOMAIN_NAME="yahoo.com",e.SERP_CAMPAIGN_PARAM={ASK:{CAMPAIGN_NAME:"cmpgn",CAMPAIGN_VALUE:"medici"},YAHOO:{CAMPAIGN_NAME:"type",CAMPAIGN_VALUE:"medici"}},e.SERP_RESULT_CLICKED="03d4787f-800c-486c-be47-bbf38fd426d8",e.SCAM_INGSIGHT="scam",e.ONBOARDING_PORTAL_DOMAIN_MAP={"norton.com":["identitysafe","search","searchsafe"],"myway.com":["secure.norton"]},e.ONBOARDING_PORTAL_URL_PATHS_MAP={"norton.com":{search:["/migration","/protect","/nsssOnboarding","/safewebOnboarding","/protect/npt","/protect/cpt"],searchsafe:["/protect"]}},e.telemetryOptOut={REOFFER_TIME_WINDOW:7776e6,NOTIFICATION_LEEWAY:12e4,NOTIFICATION_LEEWAY_FIREFOX:6e4},e.IS_WCID_HEURISTICS_LOW_PRIORITY=!0,e.SCAM_INSIGHT_BLOCK_PAGE_PATH="content/ui/scam-insight-block-page.html",e.BLOCK_PAGE_PATH="content/ui/blockedPage.html",e.FORMJACK_PROTECTION_BLOCK_PAGE="/content/ui/formjackProtectionBlockPage.html",e.FORMJACK_PROTECTION_LEARN_MORE="/content/ui/formjackProtectionLearnMore.html",e.FORMJACK_PROTECTION_LEARN_TECHNICAL_DETAILS="https://www.nortonlifelock.com/blogs/norton-labs/credit-card-skimmers",e.webProtectionPolicy={WEB_PROTECTION_POLICY_CONTAINER:"62517E4C-BFAD-46DE-977B-1A388E5399C7",SAFEWEB_STATUS:"AEE8B6DB-FB95-46D2-9C21-B594440BDF91",WCID_HEURISTICS_STATUS:"B0E77D14-7B68-477E-981C-21EB2E65A7C9",WCID_CHECK_URL_STATUS:"4621C921-C4C1-4813-9F24-83FF7800471F",IPS_STATUS:"A81DABD1-935C-4504-91C8-90BC99EE4E29",FORMJACK_STATUS:"8652E2F2-D7B3-4CF3-8293-E0360E33C6DA"},e.IPS={SITE_RATING:{IPS_STATE:16},RATING_TYPE:{IPS:"BBF78165-B712-4E8A-A720-02F3D6C07CC5"},SUPPORTED_BROWSERS:["Chrome","Firefox","Edge","Edge-Chromium"]},e.FORMJACK_PROTECTION={SITE_RATING:{FORMJACK_STATE:18},RATING_TYPE:{FORMJACK_TYPE:"A1F7E523-B6B5-4C81-AEC5-96C4C5A53441"}},e.performanceReporter={NSSS:"NSSS"},e.scamInsightAgeRating={VERY_NEW:"verynew",NEW:"new"},e.scamInsightPrevalenceRating={NO_USERS:"nousers",FEW_USERS:"fewusers"},e.scamInsightScore={LOWER_LIMIT:25,UPPER_LIMIT:49},e.yahooVendorConstants={HSPART:"hspart",HSPART_VALUE:"norton",HSIMP:"hsimp",HSIMP_VALUE:"yhs-ext_onb",HSIMP_VALUE_THREE_IN_ONE:"yhs-ext_safe",HSIMP_VALUE_EDGE_CHROMIUM:"yhs-edge",HSPART_VALUE_LEGACY:"symantec"},e.WCID_ANALYSIS_WAIT_TIME=2e3,e.CHROME_STORE_URL="https://chrome.google.com/webstore/detail/",e.HEARTBEAT_CONFIG={HEARTBEAT_SDK_PING_INTERVAL:864e5,HEARTBEAT_SDK_PING_INTERVAL_48_HOURS:1728e5,DATA_SOURCE:"extension"},e.TIME={THIRTY_MINUTES:18e5},e.GEO_LOCATION_API_URL="https://cloudconnect2.norton.com/v1/geolocationapi/location/countryembargoinformation/",e.YAHOO_VENDOR_OFFERING={supportedCountry:["US","CA"]},e.FG_LEARN_MORE_SSDCAT="310",e.UNINSTALL_SURVEY_URL="https://nebula-cdn.kampyle.com/direct/form.html?region=prodUsOregon&websiteId=458056&formId=30258&source=Uninstall",e.UNINSTALL_SURVEY_PARAMS={MID:"mid",PRODUCT:"product",FEATURE:"feature",DOI:"doi",LANGUAGE:"language"},e.SEARCH_SUGGESTION_METADATA={ask:{suggestionUrl:"https://ss-sym.search.ask.com/ss?",queryParams:{limit:10,li:"ff",hl:"",q:""}},yahoo:{suggestionUrl:{"en-us":"https://us.search.yahoo.com/sugg/gossip/gossip-us-partner?","fr-ca":"https://qc.search.yahoo.com/sugg/gossip/gossip-qc-partner?","en-ca":"https://ca.search.yahoo.com/sugg/gossip/gossip-ca-partner?"},defaultSuggestionCountryCode:"en-us",queryParams:{output:"fxjson",appid:"sym",command:""}},defaultLangCode:"en",defaultCountryCode:"us"},e.SEARCH_RESULT_METADATA={yahoo:{defaultSERPCampaignCode:"medici",weekKeyword:"wk",separator:"_",browserNameShortForm:{Chrome:"cr",Firefox:"ff",Edge:"ed",IE:"ie",Safari:"sf",Opera:"op"},searchUrl:{"en-us":"https://search.yahoo.com/yhs/search?","fr-ca":"https://qc.search.yahoo.com/yhs/search?","en-ca":"https://ca.search.yahoo.com/yhs/search?"},defaultCountryCode:"en-us",defaultExtensionCode:"hp"},ask:{searchUrl:"https://nortonsafe.search.ask.com/web?"}},e.GEO_LOCATION_SUBDOMAIN_MAP={us:{default:""},gb:{default:"uk"},au:{default:"au"},ca:{en:"ca",fr:"qc",default:"ca"},br:{default:"br"},fr:{default:"fr"},it:{default:"it"},de:{default:"de"},nl:{default:"nl"},es:{default:"es"},mx:{default:"mx"},in:{default:"in"},se:{default:"se"},ch:{de:"ch",fr:"chfr",it:"chit",default:"ch"},nz:{default:"nz"},dk:{default:"dk"},sg:{default:"sg"},ar:{default:"ar"},at:{default:"at"},hk:{default:"hk"},co:{default:"co"},no:{default:"no"},ie:{default:"uk"},cl:{default:"cl"},fi:{default:"fi"}},e.YAHOO_URL_PATTERN="https://subdomain.search.yahoo.com/",e.SUBDOMAIN="subdomain",e.REPLACE_STRING_FOR_US="subdomain.",e.SEARCH_URL_PATHNAME="yhs/search?",e.SEARCH_SUGGESTIONS_URL_PATHNAME="sugg/gossip/gossip-geo_location-partner?",e.QUICKLINKS_CDN_URL="https://static.nortoncdn.com/nortonsafesearch/quickLinks/",e.TWITTER_FEEDS_CDN_URL="https://static.nortoncdn.com/nortonextensionhomepage/nloktweets.json",e.twitterFeedsJsonRootCA=`
    -----BEGIN CERTIFICATE-----
    MIIEvjCCA6agAwIBAgIQBtjZBNVYQ0b2ii+nVCJ+xDANBgkqhkiG9w0BAQsFADBh
    MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
    d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD
    QTAeFw0yMTA0MTQwMDAwMDBaFw0zMTA0MTMyMzU5NTlaME8xCzAJBgNVBAYTAlVT
    MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxKTAnBgNVBAMTIERpZ2lDZXJ0IFRMUyBS
    U0EgU0hBMjU2IDIwMjAgQ0ExMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
    AQEAwUuzZUdwvN1PWNvsnO3DZuUfMRNUrUpmRh8sCuxkB+Uu3Ny5CiDt3+PE0J6a
    qXodgojlEVbbHp9YwlHnLDQNLtKS4VbL8Xlfs7uHyiUDe5pSQWYQYE9XE0nw6Ddn
    g9/n00tnTCJRpt8OmRDtV1F0JuJ9x8piLhMbfyOIJVNvwTRYAIuE//i+p1hJInuW
    raKImxW8oHzf6VGo1bDtN+I2tIJLYrVJmuzHZ9bjPvXj1hJeRPG/cUJ9WIQDgLGB
    Afr5yjK7tI4nhyfFK3TUqNaX3sNk+crOU6JWvHgXjkkDKa77SU+kFbnO8lwZV21r
    eacroicgE7XQPUDTITAHk+qZ9QIDAQABo4IBgjCCAX4wEgYDVR0TAQH/BAgwBgEB
    /wIBADAdBgNVHQ4EFgQUt2ui6qiqhIx56rTaD5iyxZV2ufQwHwYDVR0jBBgwFoAU
    A95QNVbRTLtm8KPiGxvDl7I90VUwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
    CCsGAQUFBwMBBggrBgEFBQcDAjB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUHMAGG
    GGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBABggrBgEFBQcwAoY0aHR0cDovL2Nh
    Y2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNydDBCBgNV
    HR8EOzA5MDegNaAzhjFodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRH
    bG9iYWxSb290Q0EuY3JsMD0GA1UdIAQ2MDQwCwYJYIZIAYb9bAIBMAcGBWeBDAEB
    MAgGBmeBDAECATAIBgZngQwBAgIwCAYGZ4EMAQIDMA0GCSqGSIb3DQEBCwUAA4IB
    AQCAMs5eC91uWg0Kr+HWhMvAjvqFcO3aXbMM9yt1QP6FCvrzMXi3cEsaiVi6gL3z
    ax3pfs8LulicWdSQ0/1s/dCYbbdxglvPbQtaCdB73sRD2Cqk3p5BJl+7j5nL3a7h
    qG+fh/50tx8bIKuxT8b1Z11dmzzp/2n3YWzW2fP9NsarA4h20ksudYbj/NhVfSbC
    EXffPgK2fPOre3qGNm+499iTcc+G33Mw+nur7SpZyEKEOxEXGlLzyQ4UfaJbcme6
    ce1XR2bFuAJKZTRei9AqPCCcUZlM51Ke92sRKw2Sfh3oius2FkOH6ipjv3U/697E
    A7sKPPcw7+uvTPyLNhBzPvOk
    -----END CERTIFICATE-----
    `,e.CERT_INFO={CERT_ISSUER_NAME:"DigiCert TLS RSA SHA256 2020 CA1",CERT_ISSUED:"static.nortoncdn.com"},e.TWITTER_FEEDS_CDN_FETCH_LAST_TIMESTAMP_KEY="TweetsFetchedTimeStamp",e.TWITTER_FEEDS_DATA_KEY="TweetsData",e.TWITTER_FEEDS_CDN_FETCH_DELAY=288e5,e.TWITTER_FEEDS_TIMER_DELAY=18e5,e.TWITTER_FEEDS_PERIOD_IN_MINUTES=30,e.NORTON_HP_EXTENSION_IDS=["okplngpklcjmpdemleibnhidjihcobef","piogpjkklafcodjjjoincimjjeciecnk","anjofbnleaccllcmijopfbkfifbcbdbm"],e.NORTON_DS_EXTENSION_IDS=["ikkagnliefbhcdgnnhfidhhbocdhkdeb","blbchkkacgjbiiobglcjcmbdhnnnokef","bjnpkhpgmeboceplngcojgnefnihgjdd"],e.NORTON_SW_EXTENSION_IDS=["bdaafgjhhjkdplpffldcncdignokfkbo","jaejnllepaebcjhadianpnnijbdbgpmb"],e.NORTON_THREE_IN_ONE_EXTENSION_IDS=["mjdefkdjmefjabbablpbkgekceflllkk","oaljpbfennijfcdnkjdodihikcdepkep"],e.HOMEPAGE_TOUR_LAST_SHOWN_TIMESTAMP_KEY="HomepageTourLastShownTimeStamp",e.CHICKLET_TOUR_LAST_SHOWN_TIMESTAMP_KEY="ChickletTourLastShownTimeStamp",e.NORTON_EXTENSION_IDS=[...e.NORTON_HP_EXTENSION_IDS,...e.NORTON_DS_EXTENSION_IDS,...e.NORTON_SW_EXTENSION_IDS,...e.NORTON_THREE_IN_ONE_EXTENSION_IDS],e.SOS_LAYOUT="SOS",e.UNINSTALL_SURVEY_SUPPORTED_EXTENSIONS=["ds","hp"],e.EXTENSIONS_MAP={hp:{ask:"generic",yahoo:"repetitive"},ds:{ask:"repetitive",yahoo:"generic"},"three-in-one":{ask:"repetitive",yahoo:"generic"}},e.VENDOR_LIST=[e.IAC],e.ocodeMap={[e.IAC]:{hp:e.DHP_OCODE,ds:e.DS_OCODE}},e.HOST_NAME={ask:"nortonsafe.search.ask.com",yahoo:"search.yahoo.com"},e.PRIVACY_PROMPT={},e.PRIVACY_PROMPT.SETTINGS_CONTAINER="083D0A7D-C9CB-4012-8CDF-86336ABF089C",e.PRIVACY_PROMPT.PRIVACY_CONSENT="privacyConsent",e.PRIVACY_PROMPT.BROWSER_RESTART_TIMES="browserRestartTimes",e.PRIVACY_PROMPT.REMOVE_NSW_URL="https://addons.mozilla.org/LOCALE_LANG/firefox/addon/norton-safe-web",e.PRIVACY_PROMPT.FF_AMO_GLOBAL_PRIVACY_STMT_URL={sw:"https://addons.mozilla.org/en-US/firefox/addon/norton-safe-web/privacy",hp:"https://www.nortonlifelock.com/us/en/privacy/product-privacy-notices/#norton-home-page",ds:"https://www.nortonlifelock.com/us/en/privacy/product-privacy-notices/#norton-safe-search","three-in-one":"https://www.nortonlifelock.com/us/en/privacy/product-privacy-notices/#norton-safe-search"},e.PRIVACY_PROMPT.FF_AMO_TELEMETRY_MESSAGE="1E963E97-5264-4E7A-A77F-8C2AAB7C7CD5",e.INSTALL_STATUS_KEY="installStatus",e.INSTALL_STATUS={INSTALL:"install",UPDATE:"update"},e.DYNAMIC_QUICK_LINKS_DATA="dynamicQuickLinksData",e.IS_VENDOR_MIGRATION_DONE_KEY="16cbe1ce-31df-43c8-b095-74ac144929e6",e.VENDOR_MIGRATION_KEY="vendor_migration",e.INPUT_TYPES=["text","number","tel"],e.TELEMETRY_DATA_LIMIT=1e3,e.KEY_CODES={ESCAPE_KEY:27,ENTER_KEY:13},e.AB_TESTING_VIEWS={GOOGLE_APPS:"GOOGLE_APPS"},e.MULTIVARIATE_SDK_CONFIG={SCHEDULER_INTERVAL:864e5,CDN_URL:"https://static.nortoncdn.com/nortonextensionhomepage/multi-variate-testing-rules.json",ROOT_CA:`
      -----BEGIN CERTIFICATE-----
      MIIEvjCCA6agAwIBAgIQBtjZBNVYQ0b2ii+nVCJ+xDANBgkqhkiG9w0BAQsFADBh
      MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
      d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD
      QTAeFw0yMTA0MTQwMDAwMDBaFw0zMTA0MTMyMzU5NTlaME8xCzAJBgNVBAYTAlVT
      MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxKTAnBgNVBAMTIERpZ2lDZXJ0IFRMUyBS
      U0EgU0hBMjU2IDIwMjAgQ0ExMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
      AQEAwUuzZUdwvN1PWNvsnO3DZuUfMRNUrUpmRh8sCuxkB+Uu3Ny5CiDt3+PE0J6a
      qXodgojlEVbbHp9YwlHnLDQNLtKS4VbL8Xlfs7uHyiUDe5pSQWYQYE9XE0nw6Ddn
      g9/n00tnTCJRpt8OmRDtV1F0JuJ9x8piLhMbfyOIJVNvwTRYAIuE//i+p1hJInuW
      raKImxW8oHzf6VGo1bDtN+I2tIJLYrVJmuzHZ9bjPvXj1hJeRPG/cUJ9WIQDgLGB
      Afr5yjK7tI4nhyfFK3TUqNaX3sNk+crOU6JWvHgXjkkDKa77SU+kFbnO8lwZV21r
      eacroicgE7XQPUDTITAHk+qZ9QIDAQABo4IBgjCCAX4wEgYDVR0TAQH/BAgwBgEB
      /wIBADAdBgNVHQ4EFgQUt2ui6qiqhIx56rTaD5iyxZV2ufQwHwYDVR0jBBgwFoAU
      A95QNVbRTLtm8KPiGxvDl7I90VUwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
      CCsGAQUFBwMBBggrBgEFBQcDAjB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUHMAGG
      GGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBABggrBgEFBQcwAoY0aHR0cDovL2Nh
      Y2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNydDBCBgNV
      HR8EOzA5MDegNaAzhjFodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRH
      bG9iYWxSb290Q0EuY3JsMD0GA1UdIAQ2MDQwCwYJYIZIAYb9bAIBMAcGBWeBDAEB
      MAgGBmeBDAECATAIBgZngQwBAgIwCAYGZ4EMAQIDMA0GCSqGSIb3DQEBCwUAA4IB
      AQCAMs5eC91uWg0Kr+HWhMvAjvqFcO3aXbMM9yt1QP6FCvrzMXi3cEsaiVi6gL3z
      ax3pfs8LulicWdSQ0/1s/dCYbbdxglvPbQtaCdB73sRD2Cqk3p5BJl+7j5nL3a7h
      qG+fh/50tx8bIKuxT8b1Z11dmzzp/2n3YWzW2fP9NsarA4h20ksudYbj/NhVfSbC
      EXffPgK2fPOre3qGNm+499iTcc+G33Mw+nur7SpZyEKEOxEXGlLzyQ4UfaJbcme6
      ce1XR2bFuAJKZTRei9AqPCCcUZlM51Ke92sRKw2Sfh3oius2FkOH6ipjv3U/697E
      A7sKPPcw7+uvTPyLNhBzPvOk
      -----END CERTIFICATE-----
      `},e.PRODUCT_NAME_CATEGORY_MAP={"Norton Safe Web":"Safeweb","Norton Safe Search":"Safesearch","Norton Home Page":"Homepage"},e.OCODE_PROVIDER={AB_TEST:"AB_TEST"},e.OCODE_KEYS={hp:"DHP_OCODE",ds:"DS_OCODE"},e.GOOGLE_APPS_CLICK="google_apps_click",e.EXTENSION_INSTALL_MONTH_YEAR="extension_install_month_year",e.FORMJACK_TOUR_DISPLAYED="formjack_tour_displayed",e.ALARM_NAMES={QUICK_LINKS:"f5392882-c85d-4489-a2f0-dd5e0a3c2460",TELEMETRY_NOTIFICATION:"29332c3b-10cf-4823-a010-46970bcb2148",TWITTER_FEEDS:"9c7ed636-9d4f-4c71-92e1-7a842a7e469e",FETCH_ANTI_TRACKER_STATUS:"8a6cc5c9-4253-4be7-89a4-45e9bb836235",PERIODIC_ANTI_TRACKER_SCHEDULER:"c36c6aa6-a53d-4daf-8763-b3c1e7a8309e",FORMJACK_TOUR_SCHEDULER:"024c3630-494a-11ed-bde3-0800200c9a66"},e.MS_TO_MIN_CONVERSION_VALUE=6e4,e.DS_REDIRECTOR_RULE_COUNT=1,e.ALLOCATED_LENGTH="allocated_length",e.ID="id",e.ERROR="error",e.ERROR_MESSAGES={MAX_RULES_COUNT_EXHAUSTED:"Exhausted max dynamic rules",PARTIAL_RULE_IDS_ALLOCATION:"Unable to allocate requested number of rule ids"},e.TELEMETRY_NOTIFICATION_ID_KEY="telemetryNotificationId",e.BLOCKED_DOMAIN="blockedDomain",e.ORIGINAL_URL="originalURL",e.BLOCK_TYPE="blockType",e.BLOCK_DELAY="blockDelay",e.BLANK_TAB_LINK="about:blank",e.NEW_TAB="about:newtab",e.EXTENSION_URL="chrome-extension://",e.UI_PATH="/content/ui/",e.FORMJACK_LEARNMORE_LAUNCH_POINT={FORMJACK_TOUR:"formjackTour",FORMJACK_BLOCK_PAGE:"formjackBlockPage"},e.WWW_PATTERN="www.",e.MAIN_FRAME="main_frame",e)}(this),function(e){"use strict";var{BROWSER_TYPE:{EDGE_CHROMIUM:t,CHROME:n}}=SymBfw["constants"];let i={TYPE:{KNOWNBAD:"knownbad",SUSPECTEDBAD:"suspectedbad",MALICIOUS:"malicious",MALICIOUSSHOP:"maliciousshop",IPS:"IPS",FORMJACK:"FORMJACK"},HTML:"blockedPage.html",parameterKeys:{ORIGINAL_URL:"originalURL",REPORT_URL:"reportURL",BLOCK_PAGE_TYPE:"blockPageType",ULANG:"ulang",CONTINUE_TO_SITE_URL:"continueToSiteURL"}},a={strings:["Safe Web","Scam Insight: Personal Information Risk","This site is safe, but…","It asks for personal information and is not well established with the Norton Community. Use caution when entering any of your information on this site. ","Visit ","Norton ","to learn more about personal information risk on Websites.","Age: ","Very New","This website was published very recently.","New","This website has been available for a short time.","Prevalence: ","No Users","No Norton community members have used this site.","Few Users","Very few Norton community members have used this site.","Continue to Site","Exit Site","If you think this website is categorized incorrectly, ","Report Issue."]};const o={strings:["Safe Web","BLOCKED BY","Possible credit card skimmer blocked!","Learn more","This web address may be associated with the illegal collection of credit card information by cyberthieves.","We strongly recommend you don't enter any information into this page:","Learn technical details","Accept risk and continue","Exit this page (recommended)"],learnMoreStrings:["LEARN MORE","About credit card skimmers and formjacking","What is formjacking?","Malicious actors can compromise online purchase sites in a variety of ways, skimming their checkout pages and stealing your credit or debit card information. This is known as formjacking.","How does formjacking work?","Help protect against cybercriminals' attacks","In the same way that a skimmer creates a fake front on an ATM or a public payment display, such as at a gas station, formjackers can hack into a website's back end. They can then insert code that creates a fake front on the site's payment page and capture your credit or debit card info.","Norton Safe Web's proprietary technology can help protect against formjacking while you shop online. ","We'll notify you if we detect that an e-commerce site has a compromised payment system, ","or if an e-commerce site you're purchasing from has a fake front on their payment page."],descText:"A known malicious website {0} has been embedded into this payment page and could re-route your credit card information.",HTML:"formjackProtectionBlockPage.html"};let s={strings:["Norton","Safe Search","Quick Links","Privacy","Search the Web Safely","Legal","Copyright © 2022 NortonLifeLock Inc. All rights reserved.","NortonLifeLock Latest Updates","Security & Privacy Center","Welcome to Norton Safe Search","Take a tour to see what has changed and make the most of your Safe Search features.","Start Tour","Peace of mind with every search","Norton Safe Search shows site safety ratings in your search results.","Get security updates and tips from Norton","Explore the latest security and privacy blogs from NortonLifeLock and learn more about digital safety.","A tour of Norton Safe Search is available in Settings.","Next","Done","The Quick Link you're trying to add is already provided for you.","Title","URL","Edit Your Quick Link","Add","Cancel","Save","Edit","Remove","Add Quick Link","Type a valid URL","Quick Links is all new!","Add your favorite sites to the new Quick Links bar.","Quick links to access popular sites with ease","Editable quick links"],googleApps:{}},r=(s.googleApps.strings={moreAppsText:"More Apps",tourStrings:{"Link to your apps":"Link to your apps","Access your apps quickly and easily from your Norton Home Page.":"Access your apps quickly and easily from your Norton Home Page.",Done:"Done"}},{strings:["Home Page","Safe Web","Safe Search","Safe Search Enhanced","Settings","Share Data with Norton","Share usage and error data anonymously with Norton and help us make our products even better","Privacy","Signed in as","Sign out","Link Guard","Identify unsafe links in Webmail, Facebook, and Twitter","Learn More","Start Tour","New"]}),E={strings:["You have successfully logged out of your NortonLifeLock Account","Sorry, something went wrong. Please try again."]},_={HTML:"content/ui/privacy-prompt.html",strings:["Norton Safe Web","Let us help protect you","To better understand our data collection policies, please visit our","Global Privacy Statement","Accept","Decline","Decline & Uninstall","Your Permission Is Required","Should you decline then Norton Safe Web will not work and won't be able to provide safety ratings for sites for you.","Please click below to review your permission and accept our request to collect the anonymous information you submit.","Review Your Permissions","Remove Norton Safe Web","Share usage and error data anonymously with Norton to help make our products and services even better.","Mozilla Firefox has updated its add-ons policy. Please give your permission again to continue using Norton Safe Search."],sw:{productName:"Norton Safe Web",description1:"Norton Safe Web must have permissions to access and collect the web addresses (urls) that you visit. ",description2:"This way, we can provide safety ratings that can help protect while browsing the Web.",declineText:"Should you decline, Norton Safe Web will not work and won't be able to provide safety ratings for sites for you.",uninstallDialogMessage:"\n Uninstalling Safe Web will mean that Norton will not be able to detect if sites are malicious and can't help protect you. We recommend clicking keep Installed and accepting permission for Safe Web to operate on your device. \n"},ds:{productName:"Norton Safe Search",description1:"Safe Search must have permission to collect the web addresses you search on, to determine if the sites are malicious before you visit them.",description2:"This will enable us to detect whether they are malicious, and will let us warn you before you access them.",declineText:"If you decline, Safe Search will not be able to help protect your device from malicious sites.",uninstallDialogMessage:"\n Uninstalling Safe Search will mean that Norton will not be able to detect if the site results you find are malicious, nor can we help protect you. We recommend clicking on Keep Installed and accepting permission for Safe Search to operate on your device.\n",protectText:"Search more safely, protect your device"},hp:{productName:"Norton Home Page",description1:"Home Page must have permission to access and collect the web addresses that you search on. ",description2:"This way, we can help detect whether these sites are malicious before you access them.",declineText:"If you decline, Home Page will not be able to help protect you from malicious sites.",uninstallDialogMessage:"\n Uninstalling Norton Home Page will mean that Norton will not be able to detect if the sites you search are malicious, nor can we help protect you. We recommend clicking Keep Installed and accepting permission for Home Page to operate on your device.\n",protectText:"Search more safely from your home page"},"three-in-one":{productName:"Norton Safe Search",description1:"Norton must have permission to access and collect the web addresses that you browse on the web, from your address bar, and your home page. ",description2:"This way, we can help detect whether the sites you searched are malicious before you access them, and provide you with safe search results.",declineText:"If you decline, Norton will not be able to help protect your device from malicious sites, nor will we be able to provide you with safe search results.",uninstallDialogMessage:"\n Uninstalling Norton Safe Search will mean that Norton will not be able to detect if the sites you search are malicious, nor we will be able to provide any safe search results for you. We recommend clicking on Keep Installed and accepting permission for Safe Search to operate on your device.\n",protectText:"Search more safely, protect your device"}};var l={EXISTING_USER:"existingUser",NEW_USER:"newUser"};let S={MESSAGES:{BLOCKEDPAGE_SEARCH:"93D3C1B6-E181-48DA-8841-EB995ADC5D48",BLOCKEDPAGE_INIT:"049B762D-F8CB-4BB1-93AB-F9D55E13D65E",BEFORE_UNLOAD_EVENT:"6D54B993-F098-4C47-B4CC-596C3D22E402",DOMEVENT:"4BEBC3FD-7552-4AE9-9FB1-717AA14B650A",SHOW_ANNOTATION_POPUP:"9BBDD5C9-4BAF-44EC-9F29-67AD5E2CF524",CLOSE_ANNOATION_POPUP:"47420986-DBE5-471F-8D64-64DCEBDF8541",FLAVOR_RETRIEVED:"554E40BF-48A3-416D-8988-9661B90F94CC",OPEN_DO_NOT_BLOCK_PAGE:"54E66C14-3E30-4F16-B4BC-259C662FF64B",HANDLE_UI_EVENTS:"B2C77321-D8F4-47A8-DCCF-D99BE95F4BC9",UPDATE_POPOVER_UI:"642A1139-910F-4D9A-B15F-12BBB6AA6276",SCAM_INSIGHT_BLOCKPAGE_INIT:"de656873-852a-4c10-8698-be4040be18ff",SCAM_EXIT_SITE:"da5f0029-7869-41af-bfc6-cd5138f13c07",SCAM_CONTINUE_TO_SITE:"9e7cd3d3-759c-49f6-87ae-4c49180d6118",SCAM_REPORT_ISSUE:"97d7cc47-bfdd-480e-9d28-0d069d965283",SET_TELEMETRY_ENABLED:"6213A0CF-075B-42BB-861A-0E54D62DE44E",SET_LINK_GUARD_ENABLED_NOTIFICATION:"F1E723C0-325B-4B40-8105-DE45FF866910",SETTINGS_PRIVACY_POLICY:"53E7B83C-CB55-463F-91B0-41F125589605",SIGN_OUT:"5CC02BA4-A79E-4451-B64A-B61217EC6B16",SETTINGS_PAGE_UI_INIT:"99534CCC-1303-4135-B98F-2B57FB3C2115",OPEN_IPS_LEARN_MORE_URL:"B63BF039-0BF2-4ED4-AD7F-61C482CF5E1D",UPDATE_FG_LINK_GUARD:"AC2A03CC-8755-48A8-9713-B37F8792056D",UPDATE_FG_VALUES:"96DD5DC7-E54C-4028-AA35-4E26C5EEED34",SET_DS_VENDOR:"051cc1e3-0abf-45de-97ea-318b8904104a",STORE_CLICK_PREVENTION_URL:"0F830272-E06E-4E97-BC06-4D2BD5DC8D9A",RETRIEVE_CLICK_PREVENTION_URL:"9EAC3837-7ECF-4C03-9A74-D848ECD9012C",ADD_TO_CLICK_PREVENTION_SAFELIST:"7A4A8585-40B8-406C-B63B-3CD865C58584",UNDO_CLICK_PREVENTION:"2E9E571E-93AA-468E-AC40-B451BE79B1C5",REDO_CLICK_PREVENTION:"890F7575-59ED-42D4-9DEE-D76FF84941F0",CLICK_PREVENTION_FAILURE_TELEMETRY:"D7FADF7A-4055-4005-82BC-3F75FE2C2ACB",FG_LEARN_MORE_LINK:"dff56850-8158-4b01-a3c3-12dacad9ec40",GET_HOME_PAGE_METADATA:"e4e8577d-7976-4bbf-ba6f-07a749055ec5",EXTN_HOME_PAGE_CHICKLET_CLICKED:"B379AF5D-9FE4-4EEF-AD39-6F846E2D1FA5",EXTN_HOME_PAGE_CHICKLET_SAVE_CLICKED:"E04BD857-F611-4143-884F-1D6C20F182A7",EXTN_HOME_PAGE_UPDATE_CUSTOM_CHICKLETS_LINKS:"896B1FD3-E70B-4DF3-8F8F-33763E3D9809",EXTN_HOME_PAGE_CHICKLET_TO_REMOVE:"53B69E14-A518-45EC-B583-2A88121E0463",EXTN_HOME_PAGE_SEARCH_SUGGESTION_CLICKED_TELEMETRY:"6D512FFF-A83B-4B47-ADAA-20EDB120CD9F",EXTN_HOME_PAGE_SEARCH_BUTTON_CLICKED_TELEMETRY:"C335B6F1-8FCE-44C5-9016-2AC8270301EB",EXTN_HOME_PAGE_LOADED_TELEMETRY:"9E2E8EF4-DB13-40ED-89A1-742852A9DD17",EXTN_SETTINGS_PAGE_LOADED_TELEMETRY:"60343FBA-DDF4-401F-9262-D8C6FCA1D6B5",LAUNCH_SEARCH_TAB_WITH_URL:"6ABBBAED-6E04-4B97-A95B-435D84AE7505",GET_INTERNAL_IDENTIFIER:"fe1ddbad-808a-4d79-bcdd-6d22e2927e97",SEND_INTERNAL_IDENTIFIER:"27e166ee-48a1-4323-ad53-5e398bdf0d8f",LAUNCH_SETTINGS_PAGE:"CAC12841-6D25-4079-A72A-42B2D952BB79",BACKGROUND_SCRIPT_LOADED:"48e97d22-e7a6-4bc0-af9e-94d88ff183d6",SHOULD_SHOW_HP_KEEP_ASSIST_POPUP:"0b0ca639-62c7-4102-879d-5cfe25fe4c29",SHOULD_SHOW_DS_KEEP_ASSIST_POPUP:"0dcb230f-23e7-4381-ba9d-356b585fea83",CLOSE_KEEP_ASSIST_UI:"de5136ec-11a1-4912-9f9f-c12372f1cdae",KEEP_ASSIST_UI_INIT:"13d25c2b-9131-4c13-953b-d1a2afae0b18",DONE_BUTTON_CLICKED:"02ed873b-f533-40bf-a5e1-6c20cdfc98b2",KEEP_ASSIST_SHOWN:"ed5488de-abf0-41a4-94ef-9e18af537066",OPEN_LEGAL_PAGE:"e46c5d2e-846e-447e-922f-4ec8934d4af4",GET_VENDOR:"d2abce22-27da-4122-94ee-c277494082a6",EXTN_HOME_PAGE_ENGLISH_ONLY_HP_SHOWN_TELEMETRY:"E6E728A3-24E1-48FF-BB97-124492C0D0DE",EXTN_HOME_PAGE_TWEET_ITEM_CLICKED:"C467AE5D-48FA-4A5B-B7DF-710C6B859B32",EXTN_HOME_PAGE_SECURITY_CENTER_NEWS_ITEM_CLICKED:"793C067F-6E5A-45A5-B8E1-365533384D05",SET_SHOW_SECURITY_CENTER_SECTION_VALUE:"6e01fb7b-174b-4a0f-808b-8b1767f83dfb",SET_SHOW_TWITTER_SECTION_VALUE:"340d7d54-5206-4a6b-8626-6e0556208931",START_HOME_PAGE_TOUR:"3E8A4897-90E1-41A6-83E7-55AD23374BB4",HOME_PAGE_TOUR_FINISHED:"1A57CC55-D8E6-41B3-B43C-A5277D248B90",HOME_PAGE_TOUR_KEY_PRESSED_FOR_CANCEL:"ad724e8e-cc19-445d-96e5-6961df21ba41",HOME_PAGE_TOUR_KEY_PRESSED_FOR_NEXT:"6f7f4f07-6db0-46ba-bc6f-5c9ce0b34059",CUSTOM_QUICK_LINK_TRIGGER_EVENT:"04d7e66e-0c38-4494-ace7-7850102b4c97",CUSTOM_QUICK_LINK_FAILURE:"df4843ac-e61c-40d1-b957-dd7a60ab4868",CUSTOM_QUICK_LINK_TOUR_FINISHED:"6026950A-4EA9-41F5-BC22-5D6BDB580ACE",PRIVACY_PROMPT_SCREEN_UI_INIT:"cbb8971e-963a-4f71-9b16-b560de122867",ON_PRIVACY_CONSENT_ACCEPT:"E43EEFB7-DEAD-4346-B214-F05EAD311786",ON_PRIVACY_CONSENT_DECLINE:"17F71FD7-9CFA-4351-86B2-12D14A5C104C",ENABLE_ALL_FLOW_FROM_PORTAL:"CE6526AB-1B8E-4E2D-84C7-04B39F04755D",OPEN_GLOBAL_PRIVACY_PAGE:"A40E3D55-068D-4902-BC0B-1AEC35CC424E",REMOVE_NSW_CLICKED:"7E455748-157F-4FDB-A5CD-63F0A3F0BBB2",ENABLE_ALL_COMMUNICATION_LISTENER_ADDED:"713ECFCB-F442-40B3-802B-661DE44C72A0",SEND_TELEMETRY_HOMEPAGE:"b82e9a05-e902-40e9-bde7-759db67dddfb",UPDATE_EXTENSION_ICON:"84011348-554B-46A0-A6C1-C7C4DE6DB28B",EXTENSION_INSTALLATION_TRIGGERED:"aa5fc70a-1979-4684-97f1-a4fbe8bc7ad5",EXTENSION_ENABLE_FLOW_TRIGGERED:"a9eac864-f2f5-4fd9-825e-962bfffa4596",LOAD_STORE_URL:"71c5234a-6dae-48a0-b5c0-7a088e1ca022",CLOSE_STORE_PAGE:"803eefc4-40ef-445e-8a6e-a072e5db04f3",GET_EXTENSIONS_STATUS:"2316b873-1c22-4470-a66a-739ed1af1b5d",EXTENSION_INSTALLED_RESPONSE:"3dc56984-701c-41fa-864f-f93d2cc08dca",CC_TELEMETRY_CAPTURE_NETWORK_CALLS:"4856CB31-43BD-4EC6-98BA-981B60CDEA9D",GET_PRIVACY_CONSENT_ACKNOWLEDGEMENT_STATUS:"4576b88b-9bd3-4a80-88f6-0efe1b545084",GOOGLE_APP_CLICKED:"C679AFTR-9FF6-4EGT-AD67-6F857F2D1FA4",MORE_GOOGLE_APPS_CLICKED:"b4a0bb95-20fe-4839-afda-569b74c048ed",GOOGLE_APPS_POPUP_SHOWN:"fab33274-8a50-42e1-a640-8d41c9eda833",FORMJACK_PROTECTION_MONITOR_NETWORK_CALLS:"5e4c1418-f828-433d-a282-702d7e390b49",FORMJACK_BLOCKPAGE_INIT:"a4b68533-7679-4473-b121-6489958b15b3",FORMJACK_CONTINUE_TO_SITE:"47f641ccb66f42e4af12112265fd91c7",FORMJACK_LEARN_MORE_LINK_CLICK:"b5a65793-8258-4282-ba3a-dc581ca52e52",FORMJACK_LEARN_TECHNICAL_DETAILS_CLICK:"929c9862-2e0f-478a-9790-3e1eb943a952",FORMJACK_EXIT_PAGE:"21c397aa-6181-488f-8204-1a40c3eef67e",FORMJACK_TOUR_UI_INIT:"cf3508b1-a9ce-4474-aac9-d74fc3980be5",FORMJACK_TOUR_CLOSE_BUTTON_CLICKED:"41de4468-0242-478c-b7cf-7351c276db57",FORMJACK_TOUR_UI_SHOWN:"9b85d40b-168e-483e-8ab4-75146ef780c8",FORMJACK_TOUR_LEARN_MORE_LINK_CLICKED:"979aceea-5385-4cda-a7be-4d66ceba4ef8",FORMJACK_PROTECTION_LEARN_MORE_UI_INIT:"b0bcb28c-e469-4a4c-a8b9-f2eebbb1de6f"},BLOCKPAGE:i,SCAM_INSIGHT_BLOCK_PAGE:a,SETTINGS_UI:r,BROWSER_NOTIFICATION:E,HOMEPAGE:s,PRIVACY_PROMPT_SCREEN:_,KEEP_ASSIST_UI:{[n]:{title:"Welcome to {0}",keepText:"Keep It",keepButtonText:"Keep it"},[t]:{title:"Thanks for choosing {0}",keepText:"Keep Changes",keepButtonText:"Keep changes"},descriptionTextEdge:"Once you've installed the browser extension, click {1}, if prompted by Microsoft Edge, to preserve your {0}.",hp:{description1:"Thanks for choosing NortonLifeLock.",description2:"If a Chrome message appears at the top of the screen, click the {1} button to preserve your {0} in Chrome."},ds:{description1:"Thank you for choosing NortonLifeLock.",description2:"Maintain your {0} protection in Chrome by clicking the {1} button if a Chrome message appears at the top of the screen."},done:"Done"},FORM_JACK_PROTECTION_BLOCK_PAGE:o,FORMJACK_TOUR_UI:{HTML:"content/ui/formjackTour.html",[l.EXISTING_USER]:{header:{title:"New feature from Norton Safe Web!",description:"Protection from Formjacking"},tiles:{creditCard:{description:"Norton Safe Web can help you avoid formjacking while you shop online."},paymentAlert:{description:"We'll notify you if we detect that the site you're buying from has a compromised payment system."}},footer:{description:"What is formjacking?",linkText:"Learn More"}},[l.NEW_USER]:{header:{title:"Norton Safe Web",description:"Thanks for installing",descriptionSuffix:"Norton Safe Web!",subDescription:"Take advantage of all these great features:"},tiles:{websiteRatings:{title:"Website Ratings",description:"Our website ratings will let you know if a site is safe or if you should be cautious before providing it with your data."},intrusionPrevention:{title:"Intrusion Prevention",description:"Norton Safe Web helps protect against known bugs and cyberthreats in popular browsers."},formjackPrevention:{title:"Formjacking Prevention",description:"Norton Safe Web will notify you if it detects an e-commerce site has a compromised payment system."},websiteBlocking:{title:"Website Blocking",description:"Norton Safe Web notifies you, then helps block malicious sites before you click."},antiPhishing:{title:"Anti-Phishing Protection",description:"This feature lets you know if the site you're clicking on is officially certified, not a phishing site."},linkGuard:{title:"Link Guard",description:"Scans webmail and social media feeds for links that are suspicious or malicious."}}}},EXTENSION_TYPE:"sw",SAFEWEB_EXTENSION:"sw",TWO_IN_ONE:"2in1",THREE_IN_ONE:"three-in-one",HOMEPAGE_EXTENSION:"hp",DEFAULT_SEARCH_EXTENSION:"ds",BROWSER_NOTIFICATION_IMAGE:"../../Icon-48.png",HomepageTourSteps:{WELCOME_DIALOG:"welcome_dialog",SEARCH_BOX:"search_box",STATIC_CHICKLETS:"static_chicklets",CUSTOM_CHICKLETS:"custom_chicklets",TWITTER_FEEDS:"twitter_feeds",SECURITY_CENTER_FEEDS:"security_center_feeds",SETTINGS_ICON:"settings_icon",GOOGLE_APPS:"google_apps"}};S.ChickletsTourStepsData={id:"chickeltTour",start:S.HomepageTourSteps.STATIC_CHICKLETS,[S.HomepageTourSteps.STATIC_CHICKLETS]:{positionCSS:" tooltip-position-static-chicklets ",pageNumberText:"1/2",nextStep:S.HomepageTourSteps.CUSTOM_CHICKLETS,descriptionText:"Quick links to access popular sites with ease",buttonText:"Next"},[S.HomepageTourSteps.CUSTOM_CHICKLETS]:{positionCSS:" tooltip-position-custom-chicklets ",pageNumberText:"2/2",nextStep:null,titleText:"Editable quick links",descriptionText:"Add your favorite sites to the new Quick Links bar.",buttonText:"Done"}},S.KEY_CODES={ENTER:13},S.formjackTour={TOUR_TYPE:l,TOUR_TYPE_PARAM:"tour_type"},S.formjackTourData={[l.NEW_USER]:{windowStyle:{container:"formjack-tour-container-new-user",imageWrapper:"formjack-tour-image-new-user",image:"img-formjack-tour-image"},tileStyle:{container:"formjack-tour-tiles-container-new-user",wrapper:"formjack-tour-tile-wrapper-new-user",textWrapper:"formjack-tour-tile-text-wrapper-new-user",image:"formjack-tour-tile-image-new-user",description:"formjack-tour-tile-description-new-user",title:"formjack-tour-tile-title-new-user"},headerStyle:{container:"formjack-tour-header-container-new-user",titleWrapper:"formjack-tour-header-title-wrapper-new-user",title:"formjack-tour-header-title-new-user",descriptionWrapper:"formjack-tour-header-title-description-wrapper",description:"formjack-tour-header-title-description-new-user",descriptionSuffix:"formjack-tour-header-title-description-suffix-new-user",subDescription:"formjack-tour-header-title-sub-description-new-user"},tilesData:[{image:"formjack-tour-wrs-tile",tag:"websiteRatings"},{image:"formjack-tour-ips-tile",tag:"intrusionPrevention"},{image:"formjack-tour-fj-tile",tag:"formjackPrevention"},{image:"formjack-tour-block-tile",tag:"websiteBlocking"},{image:"formjack-tour-lg-tile",tag:"linkGuard"},{image:"formjack-tour-phish-tile",tag:"antiPhishing"}]},[l.EXISTING_USER]:{windowStyle:{container:"formjack-tour-container",imageWrapper:"formjack-tour-image",image:"img-formjack-tour-image"},tileStyle:{container:"formjack-tour-tiles-container",wrapper:"formjack-tour-tile-wrapper",textWrapper:"formjack-tour-tile-text-wrapper",image:"formjack-tour-tile-image",description:"formjack-tour-tile-description",title:"formjack-tour-tile-title"},headerStyle:{container:"formjack-tour-header-container",titleWrapper:"formjack-tour-header-title-wrapper",title:"formjack-tour-header-title",descriptionWrapper:"formjack-tour-header-title-description-wrapper formjack-tour-header-title-description-wrapper-existing-user",description:"formjack-tour-header-title-description",subDescription:"formjack-tour-header-title-sub-description"},tilesData:[{image:"formjack-tour-cc-tile",tag:"creditCard"},{image:"formjack-tour-alert-tile",tag:"paymentAlert"}]}},(e.NSSS=e.NSSS||{}).uiConstants=S}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).uiHelper=function(s,r){var E={};s.utils.isntNil;const _=s.utils.isNil,i=r.nfmEvents;var l={untested:0,safe:1,caution:2,warn:3},S=r.constants,c=s.localizer,a=r.uiConstants.BLOCKPAGE.TYPE,T={};return T.Safe=l.safe,T.Caution=l.caution,T.Untested=l.untested,T["Safe Web is off"]=l.untested,T.Warning=l.warn,T["Not Licensed"]=l.warn,T["Unsafe to Shop"]=l.warn,T.Monitoring=l.untested,T["Page not analyzed"]=l.untested,E.siteStatusRatingMap=T,E.rating=l,E.messageType={SEARCH:0,FULLREPORT:1,REPORTSITE:2,SETTINGS:3,ONLOAD:4},E.ratingStyle=["untested","safe","caution","warn","suspicious","formjack"],E.customizedRatingStyle={suspiciousRegionBlock:"suspicious",formjackProtection:"formjack"},E.uiEvents="UI-Event",E.settingsEvent="Settings-Event",E.setupUI="Setup-UI",E.updateUI="Update-UI",E.updateUIComplete="Update-UI-Complete",E.setupSettingsUI="Setup-Settings-UI",E.FULL_REPORT_EVENTID="2786E625-7D87-4997-AB8B-DB46539A48F8",E.REPORTSITE_EVENTID="76DAED94-D538-4C07-909D-8C7C0442FA5C",E.SETTINGS_CLICKED_EVENTID="D33EEEAD-B101-4A69-8B71-564E69FD5880",E.SEARCH_EVENTID="5C57C303-1C69-4C07-850C-062563BE3C1D",E.DEFAULT_SEARCH_EVENTID="FD6141FE-3E11-40E1-88A9-ED2EECC2E052",E.DEFAULT_HOMEPAGE_EVENTID="D266FC01-E845-4292-8890-30AE32FE48E2",E.setShowFullReportForSessionID=function(e,t){r.helperUtils.setSessionSetting(e,S.SHOW_FULLREPORT,t)},E.showFullReportForSessionID=function(e){let t=r.helperUtils.getSessionSetting(e,S.SHOW_FULLREPORT);return t=_(t)?!0:t},E.setShowReportSiteForSessionID=function(e,t){r.helperUtils.setSessionSetting(e,S.SHOW_REPORTSITE,t)},E.showReportSiteForSessionID=function(e){let t=r.helperUtils.getSessionSetting(e,S.SHOW_REPORTSITE);return t=_(t)?!0:t},E.toolbarStatusForSessionID=function(e){if(_(e))return null;let t=r.helperUtils.getSessionSetting(e,i.PAGE_ANALYZED);if(_(t))return null;if(t.getRating)return t.getRating();const n=new r.Rating(t);return n.getRating()},E.uiStatusForSessionID=function(e,t){if(_(e))return E.uiStatusForUntestedSite(t);s.logger,s.settings;var n=r.helperUtils.getFeatureFlavorization();if(r.helperUtils.isURLWhitelisted(t))return E.uiStatusForUntestedSite(t);var i=E.toolbarStatusForSessionID(e);if(_(i))return E.uiStatusForUntestedSite(t);var t=i.siteStatus,a=E.showFullReportForSessionID(e),o=E.showReportSiteForSessionID(e),e=(E.setShowReportSiteForSessionID(e,o),c.getLocalizedString(i.siteStatus)),t=T[t];return{uiStatus:{sitename:i.url,rating:t,ratingText:e,showSafeWebSearchbox:n.showSafeWebSearchbox},regularIcon:i.siteIcon+".png",retinaIcon:i.siteIcon+"@2x.png",showFullReport:a,showReportSite:o,siteRating:i.siteRating,fullReportURL:i.fullReportURL}},E.privateUIStatusForSafeOrUntestedOrMonitoringSite=function(e,t){var n=r.helperUtils.getFeatureFlavorization(),i=c.getLocalizedString(t);const a={sitename:e=!_(e)&&""!==e?e:S.ABOUT_BLANK,rating:l.untested,ratingText:i,computerThreats:0,identityThreats:0,annoyanceThreats:0,totalThreats:0,showSafeWebSearchbox:n.showSafeWebSearchbox};let o=S.UNTESTED_IMAGE+".png",s=S.RETINAL_UNTESTED_IMAGE+".png";return"Safe"===t&&(o=S.SAFE_IMAGE+".png",s=S.RETINAL_SAFE_IMAGE+".png",a.rating=l.safe),{uiStatus:a,regularIcon:o,retinaIcon:s,showFullReport:!1,showReportSite:!1}},E.uiStatusForSafeSite=function(e){return E.privateUIStatusForSafeOrUntestedOrMonitoringSite(e,"Safe")},E.uiStatusForUntestedSite=function(e){return E.privateUIStatusForSafeOrUntestedOrMonitoringSite(e,"Untested")},E.uiStatusForMonitoringSite=function(e){return E.privateUIStatusForSafeOrUntestedOrMonitoringSite(e,"Monitoring")},E.getBlockPageString=function(e){var t,n=E.blockPageStrings();switch(e){case a.KNOWNBAD:t=E.knownbadWindowStrings(n);break;case a.SUSPECTEDBAD:t=E.suspectedbadWindowStrings(n);break;case a.MALICIOUS:t=E.maliciousWindowStrings(n);break;case a.MALICIOUSSHOP:t=E.maliciousshopWindowStrings(n);break;case a.IPS:t=E.ipsMaliciousWindowStrings(n)}return t},E._getPopoverWarningMessage=e=>{let t="";switch(e){case a.SUSPECTEDBAD:t=c.getLocalizedString("This is a suspicious webpage.");break;case a.MALICIOUS:case a.MALICIOUSSHOP:t=c.getLocalizedString("This is a known dangerous webpage.");break;case a.IPS:t=c.getLocalizedString("This is a known malicious webpage.");break;case a.FORMJACK:t=c.getLocalizedString("We strongly recommend that you do not share any personal or financial information on this page.");break;default:return""}e=e!==a.FORMJACK?c.getLocalizedString("It is highly recommended that you do NOT visit this page."):"";return t+" "+e},E._getPopoverMessage=(e,t)=>{switch(e){case l.untested:return c.getLocalizedString("This website has not been rated yet.");case l.safe:return c.getLocalizedString("This website is considered safe.");case l.caution:return c.getLocalizedString("This website may have a small number of threats.");case l.warn:var n=r.wpsHelperUtils.blockPageType(t);return _(n)?"":E._getPopoverWarningMessage(n);default:return""}},E.popoverWindowStrings=function(e,t){return{search:c.getLocalizedString("Search the Web Safely"),rating:{nortonRating:c.getLocalizedString("Norton Rating"),popoverDesc:E._getPopoverMessage(e,t),fullReport:c.getLocalizedString("View a full Safe Web report"),reportSite:c.getLocalizedString("Report this site"),nortonSafeWeb:c.getLocalizedString("Norton Safe Web")}}},E.blockPageStrings=function(){return{blockedBy:c.getLocalizedString("BLOCKED BY"),line2:c.getLocalizedString("You attempted to access:"),description2:c.getLocalizedString("It is highly recommended that you do NOT visit this page."),visit_symc1:c.getLocalizedString("Visit"),symantec:c.getLocalizedString("Norton"),visit_symc2:c.getLocalizedString("to learn more about phishing and internet security."),linkToSite:c.getLocalizedString("Continue to the site"),reportSite:c.getLocalizedString("View Full Report"),searchBoxText:c.getLocalizedString("Search for a safer site")}},E.knownbadWindowStrings=function(e){return e.title=c.getLocalizedString("Fraudulent Webpage Blocked"),e.description1=c.getLocalizedString("This webpage is a known fraudulent webpage."),e},E.maliciousWindowStrings=function(e){return e.title=c.getLocalizedString("Dangerous Webpage Blocked"),e.description1=c.getLocalizedString("This is a known dangerous webpage."),e},E.maliciousshopWindowStrings=function(e){return e.title=c.getLocalizedString("Dangerous Webpage Blocked"),e.description1=c.getLocalizedString("This is a known dangerous webpage."),e},E.suspectedbadWindowStrings=function(e){return e.title=c.getLocalizedString("Suspicious Website Blocked"),e.description1=c.getLocalizedString("This site has been blocked, due to piracy or other restrictions in your region. We highly recommend that you do not visit this page."),e.description2="",e.line2=c.getLocalizedString("You attempted to access"),e},E.ipsMaliciousWindowStrings=function(e){return e.title=c.getLocalizedString("Malicious Site Blocked!"),e.description1=c.getLocalizedString("This webpage is a known malicious webpage."),e},E.keepAssistWindowStrings=function(e){var t=!0===e?c.getLocalizedString("Norton Safe Search"):c.getLocalizedString("Norton Home Page"),e=!0===e?c.getLocalizedString("Safe Search"):c.getLocalizedString("Home Page");return{title1:c.getLocalizedString("Welcome to"),title2:c.getLocalizedString("Norton"),title3:e,desc1:c.getLocalizedString("Thank you for choosing Norton. When a Chrome message appears at the top right of the screen, click"),desc2:c.getLocalizedString("Keep changes"),desc3:c.getLocalizedStringWithFormat("to maintain your {0} protection in Chrome.",[t]),btnContinue:c.getLocalizedString("Continue")}},E}(e.SymBfw,e.NSSS)}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).globalSettings=function(t,n){var a={},o=n.constants;const{utils:{isNil:s,isntNil:i,isFunction:e,isString:r,isBoolean:E,isArray:_},settings:l,logger:S}=t;return a.settingsContainer=null,a.initialize=function(i){if(!e(i))throw new Error("callback must be a function");l.loadSettingsContainer(o.NSSS_GLOBAL_SETTINGS_CONTAINER,!0,function(e,t,n){if(!1===e||s(t))return S.error("failed to load NSSS_GLOBAL_SETTINGS_CONTAINER"),void i(!1);a.settingsContainer=t,a.getCGuid(),i(!0)})},a.getValue=function(e){return s(this.settingsContainer)?(S.error("settings not initialized"),null):this.settingsContainer.getObject(e)},a.setValue=function(e,t){s(this.settingsContainer)?S.error("settings not initialized"):this.settingsContainer.setObject(e,t)},a.getDefaultHomepage=function(){return a.getValue(o.DEFAULT_HOMEPAGE)},a.getDefaultSearch=function(){return a.getValue(o.DEFAULT_SEARCH)},a.setDefaultHomepage=function(e){a.setValue(o.DEFAULT_HOMEPAGE,e)},a.setDefaultSearch=function(e){a.setValue(o.DEFAULT_SEARCH,e)},a.setCurrentDateAsDoi=function(){let e=new Date;var t=[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-");a.setInstallDate(t)},a.getInstallDate=function(){var e=a.getValue(o.NSSS_INSTALLDATEKEY);return s(e)&&(a.setCurrentDateAsDoi(),e=a.getValue(o.NSSS_INSTALLDATEKEY)),e},a.setInstallDate=function(e){i(e)&&(a.setValue(o.NSSS_INSTALLDATEKEY,n.helperUtils.convertDateStringToNormalizedDateString(e)),n.uiConstants.EXTENSION_TYPE===n.uiConstants.THREE_IN_ONE&&o.VENDOR===o.YAHOO&&a.setDateOfAssociation(e,e))},a.getDateOfAssociation=function(){var e=a.getValue(o.URL_PARAMS_KEY.DATE_OF_ASSOCIATION);return s(e)?null:e},a._compareDate=(e,t)=>{e=n.helperUtils.getDateParts(e,"-"),t=n.helperUtils.getDateParts(t,"-");return new Date(e[0],e[1]-1,e[2])<new Date(t[0],t[1]-1,t[2])},a.setDateOfAssociation=function(e,t){r(e)&&r(t)&&(a._compareDate(e,t)?a.setValue(o.URL_PARAMS_KEY.DATE_OF_ASSOCIATION,n.helperUtils.convertDateStringToNormalizedDateString(e)):a.setValue(o.URL_PARAMS_KEY.DATE_OF_ASSOCIATION,n.helperUtils.convertDateStringToNormalizedDateString(t)))},a.setPUID=function(e){i(e)&&a.setValue(o.URL_PARAMS_KEY.PARTNER_UNIT_ID,e)},a.setProduct=function(e){i(e)&&a.setValue(o.URL_PARAMS_KEY.PRODUCT_NAME,e)},a.getProduct=function(){var e=a.getValue(o.URL_PARAMS_KEY.PRODUCT_NAME);return e=s(e)?o.PRT:e},a.setVersion=function(e){i(e)&&a.setValue(o.URL_PARAMS_KEY.VERSION,e)},a.getVersion=function(){var e=a.getValue(o.URL_PARAMS_KEY.VERSION);return e=s(e)?o.VERSION:e},a.setLayoutType=function(e){i(e)&&a.setValue(o.URL_PARAMS_KEY.LAYOUT_TYPE,e)},a.getPUID=function(){return a.getValue(o.URL_PARAMS_KEY.PARTNER_UNIT_ID)},a.getLayoutType=function(){return a.getValue(o.URL_PARAMS_KEY.LAYOUT_TYPE)},a.getCGuid=function(){var e=a.getValue(o.CGUIDKEY);return s(e)&&(e=t.utils.createNewGuid(),a.setCGuid(e)),e},a.setCGuid=function(e){i(e)&&a.setValue(o.CGUIDKEY,e)},a.getVendor=function(){var e=a.getValue(o.VENDORKEY);return e=s(e)?o.VENDOR:e},a.setVendor=function(e){i(e)&&a.setValue(o.VENDORKEY,e)},a.getPartnerId=function(){var e=a.getValue(o.PARTNERIDKEY);return e=s(e)?o.DEFAULT_PARTNER_ID:e},a.setPartnerId=function(e){i(e)&&a.setValue(o.PARTNERIDKEY,e)},a.getCampaignMedium=function(){var e=a.getValue(o.CAMPAIGN_MEDIUM);return s(e)?o.DEFAULT_PARTNER_ID:e},a.setCampaignMedium=function(e){s(e)||a.setValue(o.CAMPAIGN_MEDIUM,e)},a.setFlavorized=function(e){var t=a.getValue(o.IS_FLAVORIZED);s(t)&&a.setValue(o.IS_FLAVORIZED,e)},a.getFlavorized=function(){var e=a.getValue(o.IS_FLAVORIZED);return e=!s(e)&&e},a.getParamsString=function(){var e=a.getValue(o.PARAMSTRINGKEY);return s(e)?"":e},a.setParamsString=function(e){i(e)&&0<e.length&&a.setValue(o.PARAMSTRINGKEY,e)},a.getTrackId=function(){return a.getValue(o.URL_PARAMS_KEY.TRACK_ID)||a.getValue(o.URL_PARAMS_KEY.TRACK_ID.toLowerCase())},a.setTrackID=function(e){i(e)&&a.setValue(o.URL_PARAMS_KEY.TRACK_ID,e)},a.getTweetsLastFetchedTimestamp=function(){return a.getValue(o.TWITTER_FEEDS_CDN_FETCH_LAST_TIMESTAMP_KEY)},a.setTweetsLastFetchedTimestamp=function(e){i(e)&&a.setValue(o.TWITTER_FEEDS_CDN_FETCH_LAST_TIMESTAMP_KEY,e)},a.getTwitterFeedsData=function(){let e=a.getValue(o.TWITTER_FEEDS_DATA_KEY);return e=s(e)?n.homePageConstants.TWEETS.data:e},a.setTwitterFeedsData=function(e,t=!1){s(e)||(a.setValue(o.TWITTER_FEEDS_DATA_KEY,e),t||a.setTweetsLastFetchedTimestamp(Date.now()))},a.getShowTwitterSectionValue=function(){let e=a.getValue(o.SHOW_TWITTER_SECTION);return e=s(e)?!0:e},a.setShowTwitterSectionValue=function(e){E(e)&&a.setValue(o.SHOW_TWITTER_SECTION,e)},a.getShowSecurityCenterSectionValue=function(){let e=a.getValue(o.SHOW_SECURITY_CENTER_SECTION);return e=s(e)?!0:e},a.setShowSecurityCenterSectionValue=function(e){E(e)&&a.setValue(o.SHOW_SECURITY_CENTER_SECTION,e)},a.getHomepageTourLastShownTimestamp=function(){return a.getValue(o.HOMEPAGE_TOUR_LAST_SHOWN_TIMESTAMP_KEY)},a.setHomepageTourLastShownTimestamp=function(e){i(e)&&a.setValue(o.HOMEPAGE_TOUR_LAST_SHOWN_TIMESTAMP_KEY,e)},a.getChickletTourLastShownTimestamp=function(){return a.getValue(o.CHICKLET_TOUR_LAST_SHOWN_TIMESTAMP_KEY)},a.setChickletTourLastShownTimestamp=function(e){i(e)&&a.setValue(o.CHICKLET_TOUR_LAST_SHOWN_TIMESTAMP_KEY,e)},a.getGeoLocation=function(){return a.getValue(o.GEO_LOCATION_KEY)},a.setGeoLocation=function(e){i(e)&&a.setValue(o.GEO_LOCATION_KEY,e)},a.setInstallStatus=e=>{r(e)&&a.setValue(o.INSTALL_STATUS_KEY,e)},a.getInstallStatus=()=>{return a.getValue(o.INSTALL_STATUS_KEY)},a.setDynamicQuickLinksData=function(e){i(e)&&a.setValue(o.DYNAMIC_QUICK_LINKS_DATA,e)},a.getDynamicQuickLinksData=function(){return a.getValue(o.DYNAMIC_QUICK_LINKS_DATA)},a.setVendorMigrationDone=e=>{E(e)&&a.setValue(o.IS_VENDOR_MIGRATION_DONE_KEY,e)},a.getVendorMigrationDone=()=>a.getValue(o.IS_VENDOR_MIGRATION_DONE_KEY),a.setCustomChicklets=function(e){_(e)&&a.setValue(o.CUSTOM_CHICKLETS_KEY,e)},a.getCustomChicklets=function(){return a.getValue(o.CUSTOM_CHICKLETS_KEY)},a.setGoogleAppsClickedValue=function(e){E(e)&&a.setValue(o.GOOGLE_APPS_CLICK,e)},a.getGoogleAppsClickedValue=function(){return a.getValue(o.GOOGLE_APPS_CLICK)},a.getExtensionInstallMonthAndYear=function(){return a.getValue(o.EXTENSION_INSTALL_MONTH_YEAR)},a.setExtensionInstallMonthAndYear=function(e){r(e)&&a.setValue(o.EXTENSION_INSTALL_MONTH_YEAR,e)},a.setPrivacyConsentAcceptClicked=function(e){E(e)&&a.setValue(o.PRIVACY_CONSENT_ACCEPT_CLICK,e)},a.getPrivacyConsentAcceptClicked=function(){return a.getValue(o.PRIVACY_CONSENT_ACCEPT_CLICK)},a.setTelemetryNotificationId=function(e){r(e)&&a.setValue(o.TELEMETRY_NOTIFICATION_ID_KEY,e)},a.getTelemetryNotificationId=function(){return a.getValue(o.TELEMETRY_NOTIFICATION_ID_KEY)},a.isFormjackTourDisplayed=function(){return a.getValue(o.FORMJACK_TOUR_DISPLAYED)},a.setFormjackTourDisplayed=function(e){E(e)&&a.setValue(o.FORMJACK_TOUR_DISPLAYED,e)},a}(e.SymBfw,e.NSSS)}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).sessionSettings=function(e,t){const a={};var n=t.constants;const{utils:{isNil:o,isFunction:s},settings:r,logger:E}=e;return a.settingsContainer=null,a.initialize=function(i){if(!s(i))throw new Error("callback must be a function");r.loadSettingsContainer(n.NSSS_SESSION_SETTINGS_CONTAINER,!0,function(e,t,n){if(!1===e||o(t))return E.error("failed to load NSSS_SESSION_SETTINGS_CONTAINER"),void i(!1);a.settingsContainer=t,i(!0)})},a.getValue=function(e){return o(a.settingsContainer)?(E.error("settings not initialized"),null):a.settingsContainer.getObject(e)},a.setValue=function(e,t){o(a.settingsContainer)?E.error("settings not initialized"):a.settingsContainer.setObject(e,t)},a.delete=function(e){o(a.settingsContainer)?E.error("settings not initialized"):a.settingsContainer.removeObject(e)},a.getCollection=function(){if(!o(a.settingsContainer))return a.settingsContainer.collection;E.error("settings not initialized")},a}(e.SymBfw,e.NSSS)}(executionContext),function(e){"use strict";e.NSSS.telemetryWrapper=function(_,s){var l={},S=_.utils.isntNil,c=_.utils.isNil,r=_.utils.isString,T=_.telemetryConstants,E=s.globalSettings,A=s.constants,u=s.uiConstants.BLOCKPAGE.TYPE;s.uiConstants.BLOCKPAGE.parameterKeys;const e=s.uiConstants;return l.blockPage={},l.blockPage.parameters={},l.TELEMETRY_CATEGORY={SEARCH:"search",POPUP_UI:"popupui",KEEP_ASSIST_UI:"keep_assist_ui",WEB_PROTECTION:"web_protection",SCAM_INSIGHT:"Scam_Insight",HOMEPAGE_TOUR:"homepage_tour",FORMJACK_TOUR:"formjack_tour",FORMJACK_BLOCK_PAGE:"formjack_block_page",BLOCKPAGE:{knownbad:"antiphishing",suspectedbad:"regional_block",IPS:"ips",malicious:"shasta",maliciousshop:"shasta",scam:"scamInsight",redirect:"redirect",FORMJACKING:"Formjacking"},YAHOO_SERP:"yahooSERP",EXT_HOME_PAGE:{AUTO_SUGGEST:"autosuggest",SEARCH:"search",QUICKLINK:"quicklink",PAGE_VIEW:"pageview",TWITTER_FEED:"twitterFeed",SECURITY_CENTER_NEWS_FEED:"securityCenterNewsFeed",CUSTOM_QUICK_LINK:"customQuickLink"},EXT_SETTINGS_PAGE:"settings_page",VENDOR_SET_FLOW:"vendorSetFlow",CREDIT_CARD_TELEMETRY:"creditCardTelemetry",FORMJACKING_BLOCK_TYPE:{PAGE:"page",IFRAME:"iframe",SUBMISSION:"submission"},DOWNLOAD_SHASTA:"download_shasta"},l.actionType={CLICK_EVENT:"click",PAGE_LOAD_EVENT:"page_load",KEY_PRESS:"key_press",CONSENT_SELF_REMOVAL:"consent_self_removal",SEARCH:{SEARCH_ENTITLEMENTS:"searchEntitlements",DEFAULT_SEARCH:"ds",DEFAULT_HOMEPAGE:"dhp",HOME_PAGE_LOADED:"homepage_loaded",SEARCH_QUERY:"search_query",UI_SEARCH_QUERY:"ui_search_query",BLOCKEDPAGE_SEARCH_QUERY:"blockedPage_search_query",ACTION_CLICKED:"action_clicked"},UI:{SHOW_POPUP_UI:"show_popup_ui",ENGLISH_HOME_PAGE_SHOWN:"english_hp_shown",KEEP_ASSIST_UI_SHOWN:"keep_assist_shown",KEEP_ASSIST_CONTINUE_BUTTON_CLICKED:"continue_button_clicked",SCAM_INSIGHT_CONTINUE_TO_SITE:"scam_insight_continue_to_site",SCAM_INSIGHT_REPORT_ISSUE:"scam_insight_report_issue",FORMJACKING_CONTINUE_TO_SITE:"Formjacking_continue_to_site",HP_TOUR_KEY_PRESS_CANCEL:"tour_key_press_cancel",HP_TOUR_KEY_PRESS_NEXT:"tour_key_press_next",HP_TOUR_COMPLETED:"tour_completed",HP_TOUR_TRIGGERED_BY_USER:"hp_tour_triggered_by_user",HP_TOUR_TRIGGERED_AUTOMATICALLY:"hp_tour_triggered_automatically",TWITTER_SECTION_SHOWN:"twitter_section_shown",TWITTER_SECTION_HIDDEN:"twitter_section_hidden",SECURITY_CENTER_SECTION_SHOWN:"security_center_section_shown",SECURITY_CENTER_SECTION_HIDDEN:"security_center_section_hidden",PRIVACY_ACCEPT_CLICKED:"privacy-accept-clicked",PRIVACY_DECLINE_CLICKED:"privacy-decline-clicked",EXTENSION_REMOVE_CLICKED:"extension-remove-clicked",CUSTOM_QUICKLINK_USER_EVENT_COMPLETION:"custom-quicklink-user-event-completion",CUSTOM_QUICKLINK_USER_EVENT_FAILURE:"custom-quicklink-user-event-failure",GOOGLE_APPS_ICON:"google-apps-icon",GOOGLE_APPS:"google-apps",MORE_GOOGLE_APPS:"more-google-apps",FORMJACK_TOUR_NEW_USER_UI_SHOWN:"formjack_tour_new_user_ui_shown",FORMJACK_TOUR_EXISTING_USER_UI_SHOWN:"formjack_tour_existing_user_ui_shown",FORMJACK_TOUR_NEW_USER_UI_CLOSED:"formjack_tour_new_user_ui_closed",FORMJACK_TOUR_EXISTING_USER_UI_CLOSED:"formjack_tour_existing_user_ui_closed",FORMJACK_TOUR_UI_LEARN_MORE_CLICKED:"formjack_tour_ui_learn_more_clicked",FORMJACK_BLOCK_PAGE_LEARN_MORE_CLICKED:"formjack_block_page_learn_more_clicked",FORMJACK_BLOCK_PAGE_TECH_DETAILS_CLICKED:"formjack_block_page_tech_details_clicked",FORMJACK_BLOCK_PAGE_EXIT_CLICKED:"formjack_block_page_exit_clicked"},PAGE:{SCAM_INSIGHT_PAGE_DISPLAYED:"scam_insight_page_displayed",FORMJACKING_BLOCK_PAGE_SHOWN:"Formjacking_block_page_shown"},BLOCKPAGE:{CONTINUE_TO_SITE:"continue_to_site_clicked",BLOCK_PAGE_SHOWN:"block_page_shown",IGNORE_BLOCK_PAGE:"ignore_block_page"},CLICK_PREVENTION_FAILURE:"clickPreventionFailure",VENDOR_SET:"vendorSet",TILES_API_FAILURE:"tiles_api_query_failed",VENDOR_MIGRATION:"vendor_migration",CHICKLET_TOUR_SHOWN:"chickletTourShown",CHICKLET_TOUR_COMPLETED:"chickletTourCompleted",CREDIT_CARD_TELEMETRY_NETWORK_REQUEST:"networkRequest",CREDIT_CARD_TELEMETRY_PAGE_DETAILS:"pageDetails"},l.searchFeature={DEFAULT_HOMEPAGE:"hp",DEFAULT_SEARCH_PROVIDER:"dsp"},l.sendExtensionInstall=function(){var e=T.TELEMETRY_CATEGORY.EXTENSION,t=T.actionType.EXTENSION.INSTALL,n=A.PRODUCT_LABEL;l.send(e,t,n)},l.sendExtensionUpdate=function(){var e=T.TELEMETRY_CATEGORY.EXTENSION,t=T.actionType.EXTENSION.UPDATE,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendVendorSetFlow=function(e){var t=l.TELEMETRY_CATEGORY.VENDOR_SET_FLOW,n=l.actionType.VENDOR_SET,i=A.PRODUCT_LABEL;let a=l.getCustomDimensionValues();S(a)&&(a[T.parameters.CUSTOM_DIMENSION9]=e),l.send(t,n,i,a)},l.sendSearchStatus=function(e,t){e=!c(e)&&e,t=!c(t)&&t;var n=l.TELEMETRY_CATEGORY.SEARCH,i=l.actionType.SEARCH.SEARCH_ENTITLEMENTS,e=l.actionType.SEARCH.DEFAULT_SEARCH+"-"+e+"-"+l.actionType.SEARCH.DEFAULT_HOMEPAGE+"-"+t,t=l.getCustomDimensionValues();l.send(n,i,e,t)},l.sendDefaultSearchEvent=function(){var e=l.TELEMETRY_CATEGORY.SEARCH,t=l.actionType.SEARCH.SEARCH_QUERY,n=A.VERSION,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendUISearchEvent=function(){var e=l.TELEMETRY_CATEGORY.SEARCH,t=l.actionType.SEARCH.UI_SEARCH_QUERY,n=A.VERSION;l.send(e,t,n)},l.sendBlockedPageSearchEvent=function(){var e=l.TELEMETRY_CATEGORY.SEARCH,t=l.actionType.SEARCH.BLOCKEDPAGE_SEARCH_QUERY,n=A.VERSION;l.send(e,t,n)},l.sendActionClickEvent=function(){var e=l.TELEMETRY_CATEGORY.SEARCH,t=l.actionType.SEARCH.ACTION_CLICKED,n=A.VERSION,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendShowPopupUIEvent=function(e){if(c(e))throw new Error("Page URL cannot be null");var t=l.TELEMETRY_CATEGORY.POPUP_UI,n=l.actionType.UI.SHOW_POPUP_UI,e=(A.VERSION,new URI(e)),i=e.pathname();e.domain();l.send(t,n,i)},l.sendKeepAssistShownEvent=function(e){if(c(e)||!r(e))throw new Error("extn_name is not valid.");if(e!==l.searchFeature.DEFAULT_HOMEPAGE&&e!==l.searchFeature.DEFAULT_SEARCH_PROVIDER)throw new Error("extn_name should be either '"+l.searchFeature.DEFAULT_HOMEPAGE+"' or '"+l.searchFeature.DEFAULT_SEARCH_PROVIDER+"'. ");var t=l.TELEMETRY_CATEGORY.KEEP_ASSIST_UI,n=l.actionType.UI.KEEP_ASSIST_UI_SHOWN,i=l.getCustomDimensionValues();l.sendWithoutCheckingTelemetryEnabled(t,n,e,i)},l.sendKeepAssistContinueButtonClickedEvent=function(e){if(c(e)||!r(e))throw new Error("extn_name is not valid.");if(e!==l.searchFeature.DEFAULT_HOMEPAGE&&e!==l.searchFeature.DEFAULT_SEARCH_PROVIDER)throw new Error("extn_name should be either '"+l.searchFeature.DEFAULT_HOMEPAGE+"' or '"+l.searchFeature.DEFAULT_SEARCH_PROVIDER+"'. ");var t=l.TELEMETRY_CATEGORY.KEEP_ASSIST_UI,n=l.actionType.UI.KEEP_ASSIST_CONTINUE_BUTTON_CLICKED,i=l.getCustomDimensionValues();l.sendWithoutCheckingTelemetryEnabled(t,n,e,i)},l.sendBlockPageTelemetry=function(e,t,n,i=!1,a=null){if(c(e)||c(t))throw new Error("URL or blockPageType cannot be null");var e=_.utils.urlWithoutQueryParameters(e,!0),o=t===u.KNOWNBAD?"fraudulent":"suspicious",n=!0===n?l.actionType.BLOCKPAGE.CONTINUE_TO_SITE:l.actionType.BLOCKPAGE.BLOCK_PAGE_SHOWN,s=l.TELEMETRY_CATEGORY.BLOCKPAGE[t];let r=s===l.TELEMETRY_CATEGORY.BLOCKPAGE.knownbad?o+"_"+n:s+"_"+n;!0===i&&(r=l.TELEMETRY_CATEGORY.BLOCKPAGE.redirect+"_"+r);o=A.PRODUCT_LABEL;const E={[T.parameters.CUSTOM_DIMENSION17]:e};t===u.IPS&&S(a)&&(E[T.parameters.CUSTOM_DIMENSION16]=a),l.send(s,r,o,E)},l.sendDownloadBlockTelemetry=function(e,t,n){if(c(e))throw new Error("Download block url cannot be null");var e=_.utils.urlWithoutQueryParameters(e,!0),t=(t?l.TELEMETRY_CATEGORY.BLOCKPAGE.redirect+"_"+l.TELEMETRY_CATEGORY.DOWNLOAD_SHASTA:l.TELEMETRY_CATEGORY.DOWNLOAD_SHASTA)+"_"+l.actionType.BLOCKPAGE.BLOCK_PAGE_SHOWN,i=l.TELEMETRY_CATEGORY.DOWNLOAD_SHASTA,a=A.PRODUCT_LABEL;const o={[T.parameters.CUSTOM_DIMENSION17]:e};r(n)&&(e=_.utils.urlWithoutQueryParameters(n,!0),o[T.parameters.CUSTOM_DIMENSION24]=e),l.send(i,t,a,o)},l.sendPreventBlockPageTelementry=function(e,t,n){if(c(n)||c(t))throw new Error("URL or blockPageType cannot be null");var i=l.actionType.BLOCKPAGE.IGNORE_BLOCK_PAGE,e=e+"_"+(t===u.KNOWNBAD?"fraudulent":t===u.suspectedbad?"suspicious":l.TELEMETRY_CATEGORY.BLOCKPAGE[t]),t=_.utils.urlWithoutQueryParameters(n,!0),n=A.PRODUCT_LABEL,t={[T.parameters.CUSTOM_DIMENSION17]:t};l.send(i,e,n,t)},l.checkStringIsValid=function(e){if(!r(e))throw new Error(e+" must be of type string")},l.sendScamBlockPageVisitedEvent=function(t){this.checkStringIsValid(t);let n=null;try{n=_.utils.urlWithoutQueryParameters(t,!0)}catch(e){_.logger.debug("Failed to get URL without params"),n=_.utils.getDomain(t)}if(c(n))return null;var t=l.TELEMETRY_CATEGORY.SCAM_INSIGHT,e=l.actionType.PAGE.SCAM_INSIGHT_PAGE_DISPLAYED,i=A.PRODUCT_LABEL,a={[T.parameters.CUSTOM_DIMENSION17]:n};l.send(t,e,i,a)},l.sendScamContinueToSiteEvent=function(e){this.checkStringIsValid(e);var e=_.utils.urlWithoutQueryParameters(e,!0),t=l.TELEMETRY_CATEGORY.SCAM_INSIGHT,n=l.actionType.UI.SCAM_INSIGHT_CONTINUE_TO_SITE,i=A.PRODUCT_LABEL,e={[T.parameters.CUSTOM_DIMENSION17]:e};l.send(t,n,i,e)},l.sendScamReportIssueEvent=function(){var e=l.TELEMETRY_CATEGORY.SCAM_INSIGHT,t=l.actionType.UI.SCAM_INSIGHT_REPORT_ISSUE,n=A.PRODUCT_LABEL;l.send(e,t,n)},l.sendFormjackBlockPageTelemetry=function(e,n=!1){if(e){var i,a,o=e.originalURL;if(r(o)){let t=null;try{t=_.utils.urlWithoutQueryParameters(o,!0)}catch(e){_.logger.debug("Failed to get URL without params"),t=_.utils.getDomain(o)}r(t)&&(o=l.TELEMETRY_CATEGORY.BLOCKPAGE.FORMJACKING,i=e.blockType||l.TELEMETRY_CATEGORY.FORMJACKING_BLOCK_TYPE.PAGE,n=n?l.actionType.UI.FORMJACKING_CONTINUE_TO_SITE:l.actionType.PAGE.FORMJACKING_BLOCK_PAGE_SHOWN,a=e.blockDelay||0,a={[T.parameters.CUSTOM_DIMENSION4]:a,[T.parameters.CUSTOM_DIMENSION17]:e.blockedDomain,[T.parameters.CUSTOM_DIMENSION7]:t},l.send(o,n,i,a))}}},l.sendFormjackBlockPageTechDetailsClicked=function(){var e=l.TELEMETRY_CATEGORY.FORMJACK_BLOCK_PAGE,t=l.actionType.UI.FORMJACK_BLOCK_PAGE_TECH_DETAILS_CLICKED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendFormjackBlockPageExitClicked=function(){var e=l.TELEMETRY_CATEGORY.FORMJACK_BLOCK_PAGE,t=l.actionType.UI.FORMJACK_BLOCK_PAGE_EXIT_CLICKED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendHomePageChickletClickedEvent=function(e,t){this.checkStringIsValid(e);var e=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.QUICKLINK+"-"+e,n=l.actionType.CLICK_EVENT,i=A.PRODUCT_LABEL;const a=l.getCustomDimensionValues();S(t)&&(a[T.parameters.CUSTOM_DIMENSION1]=t),l.send(e,n,i,a)},l.sendQuickLinkTilesApiFailureEvent=function(e){var t=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.QUICKLINK,n=l.actionType.TILES_API_FAILURE;let i=A.PRODUCT_LABEL;e&&(i+="-"+e);e=l.getCustomDimensionValues();l.send(t,n,i,e)},l.sendHomePageSearchSuggestionClickedEvent=function(){var e=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.AUTO_SUGGEST,t=l.actionType.CLICK_EVENT,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendHomePageSearchButtonClickedEvent=function(){var e=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.SEARCH,t=l.actionType.CLICK_EVENT,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendHomePageLoadEvent=function(e=0,t=0){var n=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.PAGE_VIEW,i=l.actionType.PAGE_LOAD_EVENT,a=A.PRODUCT_LABEL;const o=l.getCustomDimensionValues();o[T.parameters.SCREEN_RESOLUTION]=e+"x"+t,o[T.parameters.CUSTOM_DIMENSION11]=E.getShowTwitterSectionValue(),o[T.parameters.CUSTOM_DIMENSION12]=E.getShowSecurityCenterSectionValue(),l.send(n,i,a,o)},l.sendEnglishOnlyHomePageShownEvent=function(e,t){var n=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.PAGE_VIEW,i=l.actionType.UI.ENGLISH_HOME_PAGE_SHOWN,a=A.PRODUCT_LABEL;let o=l.getCustomDimensionValues();(o=c(o)?{}:o)[T.parameters.CUSTOM_DIMENSION4]=e,o[T.parameters.CUSTOM_DIMENSION10]=t,l.send(n,i,a,o)},l.sendSettingsPageLoadEvent=function(){var e=l.TELEMETRY_CATEGORY.EXT_SETTINGS_PAGE,t=l.actionType.PAGE_LOAD_EVENT,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.getCustomDimensionValues=()=>{return e.EXTENSION_TYPE===e.SAFEWEB_EXTENSION?null:{[T.parameters.CUSTOM_DIMENSION4]:A.VENDOR}},l.sendFormjackTourUIDisplayed=function(e){var t=l.TELEMETRY_CATEGORY.FORMJACK_TOUR,e=e?l.actionType.UI.FORMJACK_TOUR_NEW_USER_UI_SHOWN:l.actionType.UI.FORMJACK_TOUR_EXISTING_USER_UI_SHOWN,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.sendFormjackProtectionLearnMoreClicked=function(e){var t=e===A.FORMJACK_LEARNMORE_LAUNCH_POINT.FORMJACK_TOUR?l.TELEMETRY_CATEGORY.FORMJACK_TOUR:l.TELEMETRY_CATEGORY.FORMJACK_BLOCK_PAGE,e=e===A.FORMJACK_LEARNMORE_LAUNCH_POINT.FORMJACK_TOUR?l.actionType.UI.FORMJACK_TOUR_UI_LEARN_MORE_CLICKED:l.actionType.UI.FORMJACK_BLOCK_PAGE_LEARN_MORE_CLICKED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.sendFormjackTourUIClosed=function(e){var t=l.TELEMETRY_CATEGORY.FORMJACK_TOUR,e=e?l.actionType.UI.FORMJACK_TOUR_NEW_USER_UI_CLOSED:l.actionType.UI.FORMJACK_TOUR_EXISTING_USER_UI_CLOSED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.sendTourKeyPressCancelEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_KEY_PRESS_CANCEL,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendTourTriggeredByUserEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_TRIGGERED_BY_USER,n=A.PRODUCT_LABEL,i={[T.parameters.CUSTOM_DIMENSION4]:A.VENDOR};l.send(e,t,n,i)},l.sendTourTriggeredAutomaticallyEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_TRIGGERED_AUTOMATICALLY,n=A.PRODUCT_LABEL,i={[T.parameters.CUSTOM_DIMENSION4]:A.VENDOR};l.send(e,t,n,i)},l.sendTourKeyPressNextEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_KEY_PRESS_NEXT,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendTourFinishedEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_COMPLETED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendTourTriggeredByUserEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_TRIGGERED_BY_USER,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendTourTriggeredAutomaticallyEvent=function(){var e=l.TELEMETRY_CATEGORY.HOMEPAGE_TOUR,t=l.actionType.UI.HP_TOUR_TRIGGERED_AUTOMATICALLY,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendTwitterSectionToggleEvent=e=>{var t=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.TWITTER_FEED,e=e?l.actionType.UI.TWITTER_SECTION_SHOWN:l.actionType.UI.TWITTER_SECTION_HIDDEN,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.sendSecurityCenterSectionToggleEvent=e=>{var t=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.SECURITY_CENTER_NEWS_FEED,e=e?l.actionType.UI.SECURITY_CENTER_SECTION_SHOWN:l.actionType.UI.SECURITY_CENTER_SECTION_HIDDEN,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.send=function(e,t,n,i){this.checkStringIsValid(e),this.checkStringIsValid(t),this.checkStringIsValid(n);var a={};if(a[T.parameters.CAMPAIGN_SOURCE]=E.getPartnerId(),a[T.parameters.CAMPAIGN_MEDIUM]=E.getCampaignMedium(),a[T.parameters.HIT_TYPE]=T.HIT_TYPE.EVENT,a[T.parameters.CATEGORY]=e,a[T.parameters.ACTION]=t,a[T.parameters.LABEL]=n,S(i))for(var o in i){var s=i[o];a[o]=s}(_.telemetry||_.telemetryProxy).send(a)},l.sendTwitterFeedClickEvent=function(t,n){if(!c(n)){var i=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.TWITTER_FEED,a=l.actionType.CLICK_EVENT,o=A.PRODUCT_LABEL;let e=l.getCustomDimensionValues();(e=c(e)?{}:e)[T.parameters.CUSTOM_DIMENSION7]=t,e[T.parameters.CUSTOM_DIMENSION8]=n,l.send(i,a,o,e)}},l.sendSecurityCenterNewsFeedClickEvent=function(t,n){if(!c(n)){var i=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.SECURITY_CENTER_NEWS_FEED,a=l.actionType.CLICK_EVENT,o=A.PRODUCT_LABEL;let e=l.getCustomDimensionValues();(e=c(e)?{}:e)[T.parameters.CUSTOM_DIMENSION7]=t,e[T.parameters.CUSTOM_DIMENSION8]=n,l.send(i,a,o,e)}},l.sendGoogleAppsPopupShownEvent=function(){var e=l.actionType.UI.GOOGLE_APPS_ICON,t=l.actionType.CLICK_EVENT,n=A.PRODUCT_LABEL;let i=l.getCustomDimensionValues();c(i)&&(i={}),l.send(e,t,n,i)},l.sendMoreGoogleAppsClickEvent=function(){var e=l.actionType.UI.MORE_GOOGLE_APPS,t=l.actionType.CLICK_EVENT,n=A.PRODUCT_LABEL;let i=l.getCustomDimensionValues();c(i)&&(i={}),l.send(e,t,n,i)},l.sendGoogleAppsClickEvent=function(t){if(!c(t)){var n=l.actionType.UI.GOOGLE_APPS,i=l.actionType.CLICK_EVENT,a=A.PRODUCT_LABEL;let e=l.getCustomDimensionValues();(e=c(e)?{}:e)[T.parameters.CUSTOM_DIMENSION18]=t,l.sendWithoutCheckingTelemetryEnabled(n,i,a,e)}},l.sendSelfUninstallTelemetry=function(e){var t=T.TELEMETRY_CATEGORY.EXTENSION,n=l.actionType.CONSENT_SELF_REMOVAL,i=A.PRODUCT_LABEL;l.sendWithoutCheckingTelemetryEnabled(t,n,i,null,e)},l.getBfwTelemetryObject=function(){if(S(this._telemetryObj))return this._telemetryObj;var e,t={APPLICATION_NAME:A.PRODUCT_NAME+"_"+_.extensionAdapter.getExtensionId(),APPLICATION_VERSION:A.VERSION,CLIENT_ID:s.init.getClientID(),DATA_SOURCE:T.dataSource.BROWSER_EXTENSION,TRACKING_ID:A.TELEMETRY_TRACKING_ID,USER_LANGUAGE:navigator.language,ANONYMIZE_IP:1,GOOGLE_ANALYTICS_PROTOCOL_VERSION:1,BROWSER_NAME:_.globals.BROWSER};const n=new _.Telemetry(T.MESSAGES.SEND_TELEMETRY_TO_BGPROXY,!0),i=(n.clientID=t.CLIENT_ID,{});for(e in t){var a=T.defaultParameters[e];c(a)||c(a.key)||(i[a.key]=t[e])}var o=_.telemetry.constructMessageBody(i);return n.defaultParameters=o,n.initialized=!0,this._telemetryObj=n,this._telemetryObj},l.sendWithoutCheckingTelemetryEnabled=function(e,t,n,i,a){this.checkStringIsValid(e),this.checkStringIsValid(t),this.checkStringIsValid(n);const o={};if(o[T.parameters.CAMPAIGN_SOURCE]=E.getPartnerId(),o[T.parameters.CAMPAIGN_MEDIUM]=E.getCampaignMedium(),o[T.parameters.HIT_TYPE]=T.HIT_TYPE.EVENT,o[T.parameters.CATEGORY]=e,o[T.parameters.ACTION]=t,o[T.parameters.LABEL]=n,S(i))for(var s in i){var r=i[s];o[s]=r}l.getBfwTelemetryObject().send(o,a)},l.sendVendorMigrationPing=function(){if(!E.getVendorMigrationDone()){const i={[T.parameters.CAMPAIGN_SOURCE]:E.getPartnerId(),[T.parameters.CAMPAIGN_MEDIUM]:E.getCampaignMedium(),[T.parameters.HIT_TYPE]:T.HIT_TYPE.EVENT,[T.parameters.CATEGORY]:T.TELEMETRY_CATEGORY.EXTENSION,[T.parameters.ACTION]:l.actionType.VENDOR_MIGRATION,[T.parameters.LABEL]:A.PRODUCT_LABEL};var e=l.getCustomDimensionValues();if(S(e))for(var t in e){var n=e[t];i[t]=n}const a=l.getBfwTelemetryObject();a.send(i),E.setVendorMigrationDone(!0)}},l.sendCustomQuickLinkTriggeredEvent=e=>{var t=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.CUSTOM_QUICK_LINK,e=l.actionType.CLICK_EVENT+"-"+e,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(t,e,n,i)},l.sendCustomChickletEventCompletion=(e,t)=>{var n=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.CUSTOM_QUICK_LINK,e=l.actionType.UI.CUSTOM_QUICKLINK_USER_EVENT_COMPLETION+"-"+e,i=A.PRODUCT_LABEL;let a=l.getCustomDimensionValues();(a=c(a)?{}:a)[T.parameters.CUSTOM_DIMENSION1]=t,l.send(n,e,i,a)},l.sendCustomQuickLinkFailureEvent=(e,t)=>{var n=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.CUSTOM_QUICK_LINK,i=l.actionType.UI.CUSTOM_QUICKLINK_USER_EVENT_FAILURE,e=A.PRODUCT_LABEL+"-"+e;let a=l.getCustomDimensionValues();c(a)&&(a={}),S(t)&&(a[T.parameters.CUSTOM_DIMENSION1]=t),l.send(n,i,e,a)},l.sendChickletTourShownTelemetry=function(){var e=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.CUSTOM_QUICK_LINK,t=l.actionType.CHICKLET_TOUR_SHOWN,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendChickletTourFinishedTelemetry=function(){var e=l.TELEMETRY_CATEGORY.EXT_HOME_PAGE.CUSTOM_QUICK_LINK,t=l.actionType.CHICKLET_TOUR_COMPLETED,n=A.PRODUCT_LABEL,i=l.getCustomDimensionValues();l.send(e,t,n,i)},l.sendCreditCardTelemetryNetworkRequests=function(e,t,n,i){var a=l.TELEMETRY_CATEGORY.CREDIT_CARD_TELEMETRY,o=l.actionType.CREDIT_CARD_TELEMETRY_NETWORK_REQUEST;let s=l.getCustomDimensionValues();(s=c(s)?{}:s)[T.parameters.CUSTOM_DIMENSION7]=e,s[T.parameters.CUSTOM_DIMENSION8]=t,s[T.parameters.CUSTOM_DIMENSION9]=n,l.send(a,o,i,s)},l.sendCreditCardTelemetry=function(e,t,n){var i=l.TELEMETRY_CATEGORY.CREDIT_CARD_TELEMETRY,a=l.actionType.CREDIT_CARD_TELEMETRY_PAGE_DETAILS;let o=l.getCustomDimensionValues();(o=c(o)?{}:o)[T.parameters.CUSTOM_DIMENSION7]=e,o[T.parameters.CUSTOM_DIMENSION8]=t,l.send(i,a,n,o)},l}(e.SymBfw,e.NSSS)}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).wpsHelperUtils=function(n,e,i){var a=e.Rating,o=n.utils.isNil,s=(n.localizer,i.uiConstants.BLOCKPAGE),r=i.constants;const E=i.constants.IPS,_=i.constants.FORMJACK_PROTECTION;var l={toolbarStatus:function(e){var t={};switch(e){case a.SITE_RATING.SW_UNTRUSTED_TRANSACTION_STATE:t.statusImage=r.CAUTION_IMAGE,t.statusString="Unsafe to Shop";break;case a.SITE_RATING.SW_KNOWN_PHISHING_STATE:case a.SITE_RATING.SW_SUSPECTED_PHISHING_STATE:case a.SITE_RATING.SW_KNOWN_MALICIOUS_STATE:case a.SITE_RATING.SW_PAGE_BAD_UNTRUSTED_TRANSACTION_STATE:case a.SITE_RATING.SW_ERROR_STATE:case E.SITE_RATING.IPS_STATE:t.statusImage=r.WARNING_IMAGE,t.statusString="Warning";break;case _.SITE_RATING.FORMJACK_STATE:t.statusImage=r.FORMJACK_IMAGE,t.statusString="Warning";break;case a.SITE_RATING.SW_REGIONAL_BLOCK:t.statusImage=r.SUSPICIOUS_IMAGE,t.statusString="Warning";break;case a.SITE_RATING.SW_NEUTRAL_STATE:t.statusImage=r.UNTESTED_IMAGE,t.statusString="Untested";break;case a.SITE_RATING.SW_CAUTION_MALICIOUS_STATE:t.statusImage=r.CAUTION_IMAGE,t.statusString="Caution";break;case a.SITE_RATING.SW_PENDING_STATE:t.statusImage=r.UNTESTED_IMAGE,t.statusString="Monitoring";break;case a.SITE_RATING.SW_TRUSTED_STATE:case a.SITE_RATING.SW_TRUSTED_TRANSACTION_STATE:case a.SITE_RATING.SW_NORTON_CERTIFIED:t.statusImage=r.SAFE_IMAGE,t.statusString="Safe";break;case a.SITE_RATING.SW_DISABLED_STATE:t.statusImage=r.UNTESTED_IMAGE,t.statusString="Safe Web is off";break;default:t.statusImage=r.UNTESTED_IMAGE,t.statusString="Page not analyzed"}return t},createRedirectURL:function(e,t,n,i=null,a){e=l.blockPageType(e);if(!o(e))return i=e===s.TYPE.IPS?"&IpsSignature="+i:"",s.HTML+`?originalURL=${t}${n?"&reportURL="+n:""}&blockPageType=`+e+i+(a?"&continueToSiteURL="+a:"")},blockPageType:function(e){var t;switch(e){case a.SITE_RATING.SW_ERROR_STATE:case a.SITE_RATING.SW_KNOWN_PHISHING_STATE:t=s.TYPE.KNOWNBAD;break;case a.SITE_RATING.SW_SUSPECTED_PHISHING_STATE:case a.SITE_RATING.SW_REGIONAL_BLOCK:t=s.TYPE.SUSPECTEDBAD;break;case a.SITE_RATING.SW_KNOWN_MALICIOUS_STATE:t=s.TYPE.MALICIOUS;break;case a.SITE_RATING.SW_PAGE_BAD_UNTRUSTED_TRANSACTION_STATE:t=s.TYPE.MALICIOUSSHOP;break;case E.SITE_RATING.IPS_STATE:t=s.TYPE.IPS;break;case _.SITE_RATING.FORMJACK_STATE:t=s.TYPE.FORMJACK}return t},getAnnotationStatusImage:function(e){var t;switch(e){case a.SITE_RATING.SW_TRUSTED_STATE:case a.SITE_RATING.SW_TRUSTED_TRANSACTION_STATE:case a.SITE_RATING.SW_NORTON_CERTIFIED:t="sb_safeAnnotation.svg";break;case a.SITE_RATING.SW_KNOWN_MALICIOUS_STATE:case a.SITE_RATING.SW_REGIONAL_BLOCK:t="sb_unsafeAnnotation.svg";break;case a.SITE_RATING.SW_CAUTION_MALICIOUS_STATE:t="sb_webnuisanceAnnotation.svg";break;case a.SITE_RATING.SW_PAGE_BAD_UNTRUSTED_TRANSACTION_STATE:t="sb_unsafeShoppagebadAnnotation.png";break;case a.SITE_RATING.SW_UNTRUSTED_TRANSACTION_STATE:t="sb_unsafeShopAnnotation.png";break;default:t="sb_unknownAnnotation.svg"}return t},getSearchTextForAnnotationURL:function(e){var t;return t=new URI(e).hostname()===n.utils.baseURL(i.constants.SEARCH_URL)?l.getQueryString("q",e):t},getQueryString:function(e,t){t=URI(t).query(!0);return o(t[e])?null:t[e]},flavorizeFullReportUrl:function(e){return o(e)?null:(!1===i.helperUtils.getFeatureFlavorization().showNortonLinks&&(e+="&siteName="+(t=i.globalSettings.getPUID())+"&pid="+t),e);var t}};return l}(e.SymBfw,e.SafeWeb,e.NSSS)}(executionContext),function(r){"use strict";(r.NSSS=r.NSSS||{}).helperUtils=function(o,_,e){var l={},S=_.uiHelper,c=(o.settings,o.logger),T=(_.pingUtils,o.utils.isNil),A=o.utils.isntNil,i=o.utils.isString,u=_.constants,E=_.globalSettings,a=_.sessionSettings,I=(_.nfmEvents,_.telemetryWrapper),R=o.extensionAdapter;let d=o.performanceReporterFactory;var N=_.wpsHelperUtils;const s=_.nsssDynamicRules,n=o.utils.isArray;return l.isVendorInitialized=async()=>{if(_.NSSSHelper.isValidVendor(_.constants.VENDOR))return!0;if(_.vendorSetup)return _.vendorSetup.vendorPromise;throw new Error("vendor setup object is not initialized")},l.getSessionIDObject=function(e){return a.getValue(e)},l.getTabIDObject=function(e){return a.getValue(e)},l.setSessionSetting=function(e,t,n){let i=a.getValue(e);(i=i||{})[t]=n,a.setValue(e,i)},l.getSessionSetting=function(e,t){e=a.getValue(e);return e?e[t]:null},l.getNSSSRating=function(e){var t=_.nfmEvents.PAGE_ANALYZED;let n=_.helperUtils.getSessionSetting(e,t);return n=T(n)?new _.Rating:n.setRating?n:new _.Rating(n)},l.deleteSessionSettings=function(e){a.delete(e)},l.getTabIDForSessionID=function(e){if(T(e))throw new Error("SessionID cannot be null");return l.getSessionSetting(e,u.TABID)},l.getSessionIDForTabID=function(e){var t=null;for(t in a.getCollection())if(l.getSessionSetting(t,u.TABID)===e)return t;return null},l.tabURL=function(e){e=e.url;return e=!T(e)&&""!==e?e:u.ABOUT_BLANK},l.updateButton=function(s,r,E=!1){R.getTab(r,function(e){R.getLastError();T(e)?c.log("No tab exists with tabID: "+r):(e=R.getWindowIDForTab(e),R.getActiveTab(function(e){var t,n,i,a,o=R.getLastError();if(A(o))return c.log("Tab is not available"),void c.log(o);T(e)?c.log("there are no active tabs at the moment"):(o=R.getTabID(e),r===o&&(l.updateActionButton(s,o,e.url),t=R.getExtensionURL(""),E&&e.url.startsWith(t)||(n=S.toolbarStatusForSessionID(s),a=l.getSessionSetting(s,u.PAGE_ANALYZED),A(a)&&a._safeWebResult&&d.reportStopForComponent(u.performanceReporter.NSSS,_.main.pageAnalysisTime),!A(n)||T(n.redirectPage)&&T(n.scamInsightBlockPage)||(a=l.getSessionSetting(s,u.SHOULD_BLOCK_KEY),A(a)&&!1===a||(a=n.blockedModule===_.uiConstants.BLOCKPAGE.TYPE.IPS,i=n.blockedModule===_.uiConstants.BLOCKPAGE.TYPE.FORMJACK,(a||i||e.url===n.finalRedirectedTabUrl||e.url.startsWith(t))&&(a=A(n.redirectPage)?R.getExtensionURL("content/ui/"+n.redirectPage):null,N.blockPageType(n.siteRating),a&&(new URI(a),a!==e.url&&A(n.url)&&(new URI(n.url),R.updateTabUrl(o,a),_.main.tabIdToRedirectUrlsMap[r]&&delete _.main.tabIdToRedirectUrlsMap[r]))))))))},e))})},l.updateActionButton=async function(e,t,n){let i=null;var a=await _.extensionURLValidator.isNortonExtensionURL(n),o=_.NSSSHelper.isBlockPage(n);i=a&&!o?R.getExtensionURL("content/images/")+u.SAFE_IMAGE+".png":(a=S.uiStatusForSessionID(e,n),R.getExtensionURL("content/images/")+a.regularIcon),R.setBrowserIcon({path:i,tabId:t})},l.updatePrivacyConsentActionButton=function(e){let t=R.getExtensionURL("content/images/");t+=e?u.CONSENT_IN_PROGRESS_IMAGE+".png":u.UNTESTED_IMAGE+".png",R.setBrowserIcon({path:t})},l.openSettingsPage=()=>{const t=R.getExtensionURL(u.SETTINGS_PAGE);R.getTabsWithURL(t,e=>{A(R.getLastError())||(A(e[0])?(R.activateTab(R.getTabID(e[0])),R.focusWindow(R.getWindowIDForTab(e[0]))):o.extensionAdapter.createTab(t))})},l.handleUIEvents=function(e,t){e===S.FULL_REPORT_EVENTID?R.getActiveTab(function(e){var t=R.getLastError();if(A(t))return c.log("Tab is not available"),void c.log(t);t=l.getSessionIDForTabID(R.getTabID(e)),e=S.toolbarStatusForSessionID(t);T(e)||R.createTab(e.fullReportURL)}):e===S.SETTINGS_CLICKED_EVENTID?l.openSettingsPage():e===S.REPORTSITE_EVENTID?R.getActiveTab(function(e){var t=R.getLastError();if(A(t))return c.log("Tab is not available"),void c.log(t);var t=l.getSessionIDForTabID(R.getTabID(e)),e=S.uiStatusForSessionID(t,e.url),n=e.siteRating,e=e.uiStatus.sitename;S.setShowReportSiteForSessionID(t,!1),_.webProtection.reportURLToSymantecServer(e,n)}):e!==S.SEARCH_EVENTID||T(t)||(e=l.getSearchURL(_.ocodeMgr.getUISearchOCode(),t),R.createTab(e,function(e){}),_.telemetryWrapper.sendUISearchEvent())},l.isBTLayout=()=>{const e=E.getLayoutType();var t=E.getPartnerId(),n=E.getPUID();if(i(e)&&i(t))return e.toUpperCase()===u.SOS_LAYOUT&&(t===u.BT_LAYOUT_PARTNERID||t===u.BT_EE_PARTNERID&&n===u.BT_EE_PUID)},l.isFireGlassSupported=function(){const e=E.getLayoutType();return!!T(e)||u.FIREGLASS_SUPPORTED_LAYOUTS.includes(e.toUpperCase())},l.getFeatureFlavorization=function(){let e="false"!==u.SEARCHBOX_VISIBLE,t=!0;const n=_.partnerConstants;var i=E.getPartnerId(),a=E.getPUID(),o=E.getLayoutType();let s=n.searchboxExclusionList[i];return A(s)&&-1!==s.puid.indexOf(a)&&(e=!1),A(o)&&-1!==n.excludeNortonLinks.indexOf(o)&&(t=!1),{showSafeWebSearchbox:e,showNortonLinks:t}},l.getQueryTemplate=function(e){const t=l.getQueryParams(e);return A(t)?t.toString():null},l.getQueryParams=e=>{var t,n,i,a,o,s=E.getParamsString(),r=_.URLSearchParams;if(!T(r))return r=new r(s),s=r.get(u.URL_PARAMS_KEY.VENDOR_OFFERED.toLowerCase()),A(s)&&r.delete(u.URL_PARAMS_KEY.VENDOR_OFFERED.toLowerCase()),s=r.get(u.VENDORKEY.toLowerCase()),A(s)&&r.delete(u.VENDORKEY.toLowerCase()),s=u.VENDOR,t=E.getInstallDate(),n=E.getCGuid(),i=E.getPartnerId(),a=E.getProduct(),o=E.getVersion(),s===u.IAC&&r.append(u.URL_PARAMS_KEY.ANNOTATION,!1),r.append(u.URL_PARAMS_KEY.VENDOR_CONFIGURED,s),r.append(u.URL_PARAMS_KEY.OCODE,e),r.append(u.URL_PARAMS_KEY.PRT,a),r.append(u.URL_PARAMS_KEY.VERSION,o),r.append(u.URL_PARAMS_KEY.TPR,u.TPR),r.append(u.PARTNERIDKEY,i),r.append(u.URL_PARAMS_KEY.CGUID,n),r.append(u.URL_PARAMS_KEY.DATE_OF_INSTALL,t),s=E.getDateOfAssociation(),A(s)&&r.append(u.URL_PARAMS_KEY.DATE_OF_ASSOCIATION,s),e=E.getTrackId(),A(e)&&r.append(u.URL_PARAMS_KEY.TRACK_ID,e),r},l.getSearchURLTemplate=function(e){return u.SEARCH_URL+"?q=$$TEMPLATE$$&"+l.getQueryTemplate(e)},l.getWeekNumber=function(e){if(!(e instanceof Date))throw new Error("date must be a instances of Date object");const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},l.getDateParts=function(e,t){return i(e)&&i(t)?e.split(t):null},l.getNormalizedDateString=function(e){return T(e)?null:[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-")},l.convertDateStringToNormalizedDateString=function(e){if(T(e))return null;let t=new Date(e.replace(/-/g,"/"));if(isNaN(t))return null;var e=t.getMonth()+1,n=t.getDate();return[t.getFullYear(),(9<e?"":"0")+e,(9<n?"":"0")+n].join("-")},l.initializeFGSetting=()=>{l.isFireGlassSupported()||T(e)||T(e.extensionSettings)||e.extensionSettings.urlMarkup.set(!1)},l.getSearchURL=function(e,t){let n=l.getSearchURLTemplate(e);return n.replace("$$TEMPLATE$$",encodeURIComponent(t))},l.setFlavor=function(s,r){if(!E.getFlavorized()){let e=r.enableHomePage,t=r.enableSafeSearch,n=(e=!T(e)&&e,t=!T(t)&&t,URI(s.toLowerCase()));r=n._parts.query;let i=_.URLSearchParams,a=new(i="undefined"!=typeof URLSearchParams?URLSearchParams:i)(r);s=a.get(u.URL_PARAMS_KEY.PARTNERID),s=(A(s)&&E.setPartnerId(s),a.delete(u.URL_PARAMS_KEY.PARTNERID),a.get(u.URL_PARAMS_KEY.CGUID)),s=(A(s)&&(E.setCGuid(s),a.delete(u.URL_PARAMS_KEY.CGUID)),a.get(u.URL_PARAMS_KEY.DATE_OF_INSTALL)),s=(A(s)&&(E.setInstallDate(s),a.delete(u.URL_PARAMS_KEY.DATE_OF_INSTALL)),a.get(u.URL_PARAMS_KEY.PARTNER_UNIT_ID)),s=(A(s)&&(E.setPUID(s),a.delete(u.URL_PARAMS_KEY.PARTNER_UNIT_ID)),a.get(u.URL_PARAMS_KEY.PRODUCT_NAME)),s=(A(s)&&(E.setProduct(s),a.delete(u.URL_PARAMS_KEY.PRODUCT_NAME)),a.get(u.URL_PARAMS_KEY.VERSION)),s=(A(s)&&(E.setVersion(s),a.delete(u.URL_PARAMS_KEY.VERSION)),a.get(u.URL_PARAMS_KEY.LAYOUT_TYPE)),s=(A(s)&&(E.setLayoutType(s),a.delete(u.URL_PARAMS_KEY.LAYOUT_TYPE)),l.initializeFGSetting(),A(_.uninstallSurveyHelper)&&_.uninstallSurveyHelper.initializeUninstallSurveyURL(),a.get(u.URL_PARAMS_KEY.TRACK_ID.toLowerCase())||a.get(u.URL_PARAMS_KEY.TRACK_ID)),s=(A(s)&&(E.setTrackID(s),a.delete(u.URL_PARAMS_KEY.TRACK_ID),a.delete(u.URL_PARAMS_KEY.TRACK_ID.toLowerCase())),a.get(u.URL_PARAMS_KEY.MIGRATION_TYPE.toLowerCase())),s=(A(s)&&a.delete(u.URL_PARAMS_KEY.MIGRATION_TYPE.toLowerCase()),a.get(u.URL_PARAMS_KEY.GEO_LOCATION.toLowerCase()));A(s)&&(E.setGeoLocation(s),a.delete(u.URL_PARAMS_KEY.GEO_LOCATION.toLowerCase()));let o=n.subdomain();if(T(o)||0===o.length||"www"===o){let e=n.domain();o=e.substring(0,e.indexOf("."))}!A(o)&&0===o.length||E.setCampaignMedium(o),e&&E.setDefaultHomepage(e),t&&E.setDefaultSearch(t),a.delete(u.URL_PARAMS_KEY.TEST_ELIGIBILITY.toLowerCase()),r=a.toString(),E.setParamsString(r),I.sendSearchStatus(t,e),E.setFlavorized(!0)}},l.removeTestEligibilityParam=()=>{var e=E.getParamsString();const t=_.URLSearchParams;if(!T(t)){const n=new t(e);n.delete(u.URL_PARAMS_KEY.TEST_ELIGIBILITY.toLowerCase()),e=n.toString(),E.setParamsString(e)}},l.getQueryString=function(e,t){t=URI(t.toLowerCase()).query(!0);return T(t[e])?null:t[e]},l.isURLWhitelisted=t=>{if(T(t)||""===t)return!0;for(let e=0;e<u.NATIVE_TAB_PREFIX.length;e++)if(t.startsWith(u.NATIVE_TAB_PREFIX[e]))return!0},l.fetchUserCountryCode=async function(){try{const t=await o.utils.safeFetch(_.constants.GEO_LOCATION_API_URL);var e=(await t.json())["CountryCode"];return e}catch(e){return c.error("unable to fetch the user county code due to "+e),null}},l.isRatingForFinalRedirectedUrl=function(e){return!(!e||e.fullURL!==e.finalRedirectedTabUrl)},l.getLandingPages=async()=>new Promise(t=>{R.getAllTabs(e=>{e=e.filter(e=>_.NSSSHelper.isLandingPageURL(e.url));return t(e)})}),l.getLandingPage=async()=>new Promise(t=>{R.getAllTabs(e=>{e=e.find(e=>{if(T(e.url))return!1;const t=new URI(e.url);return!!(u.ONBOARDING_PORTAL_URL_PATHS_MAP.hasOwnProperty(t.domain())&&u.ONBOARDING_PORTAL_URL_PATHS_MAP[t.domain()].hasOwnProperty(t.subdomain())&&u.ONBOARDING_PORTAL_URL_PATHS_MAP[t.domain()][t.subdomain()].includes(t.path()))});return t(e)})}),l.getPagesToFlavor=e=>{return e.filter(e=>{const t=new URI(e.url);return!!(u.ONBOARDING_PORTAL_URL_PATHS_MAP.hasOwnProperty(t.domain())&&u.ONBOARDING_PORTAL_URL_PATHS_MAP[t.domain()].hasOwnProperty(t.subdomain())&&u.ONBOARDING_PORTAL_URL_PATHS_MAP[t.domain()][t.subdomain()].includes(t.path()))})},l.getGlobalObject=()=>A(_.searchGlobal)?_.searchGlobal:_.chromeGlobal,l.isHomePageTourSupported=()=>_.uiConstants.EXTENSION_TYPE!==_.uiConstants.SAFEWEB_EXTENSION,l.getAllHomePageTabs=async()=>new Promise(t=>{const n=R.getExtensionURL(r.NSSS.constants.HOME_PAGE);R.getAllTabs(e=>{e=e.filter(e=>e.url.startsWith(n));return t(e)})}),l.getExtensionDetails=async e=>{try{return await R.getExtensionDetails(e)}catch(e){return null}},l.getExtensionInstalledAndEnabledStatus=async a=>{if(!o.utils.isArray(a)||0===a.length)throw new Error("extensionIds argument is not valid");var e=a.map(e=>l.getExtensionDetails(e));const t=await Promise.all(e);return t.reduce((e,t,n)=>{const i={...e};return T(t)||!1===t.enabled?i[a[n]]=!1:i[a[n]]=!0,i},{})},l.sendExternalMessageWithPromise=(e,a)=>new Promise((t,n)=>{if(T(e)||T(a))return n("Arguments are not valid");const i=setTimeout(()=>{n("SendMessageExternal timed out")},1e3);o.extensionAdapter.sendMessageExternal(e,a,e=>{if(A(o.extensionAdapter.getLastError())||T(e))return clearTimeout(i),n("Extension not installed");clearTimeout(i),t(e)})}),l.executeContentScriptsToFlavorizeExtn=async(e,n)=>{if(!T(e)&&o.utils.isArray(n))for(let t=0;t<n.length;t++)try{await R.executeContentScript(e,n[t])}catch(e){c.error(`Error in executing ${n[t]} - `+e);break}},l.flavorizeExtension=()=>{R.getAllTabs(function(e){e.forEach(function(e){var t=e.url;!1!==_.NSSSHelper.isLandingPageURL(t)&&(t=R.getTabID(e),A(t)&&l.executeContentScriptsToFlavorizeExtn(t,["content/libs/uri.min.js","ContextInit.js","content/scripts/SymBfwCS.js","content/scripts/flavorParser.js"]))})})},l.constructDynamicRules=(n,i,e)=>{return e.filter((e,t)=>{if(t<i)return e.id=n+t,e})},l._getDsRedirectorRule=(e,t)=>{if(n(e)&&0!==e.length)return e.find(e=>e.condition.urlFilter===t)},l._updateDefaultSearch=async e=>{var t=l._getDSQueryParams();e.action.redirect={transform:{queryTransform:{addOrReplaceParams:t}}};try{await R.updateDynamicRules([e])}catch(e){c.error(e)}},l.handleOmniSearch=async()=>{var e=await R.getDynamicRules(),t=_.constants.SEARCH_URL+"?omnisearch=yes",e=l._getDsRedirectorRule(e,t);if(A(e))l._updateDefaultSearch(e);else{var{id:e,allocated_length:n,error:i}=s.getRuleId(u.DS_REDIRECTOR_RULE_COUNT);if(A(i)&&i===u.ERROR_MESSAGES.MAX_RULES_COUNT_EXHAUSTED)c.error("Cannot set redirect rules for default search");else{var a=l._getDSQueryParams(),e=l.constructDynamicRules(e,n,[{priority:1,action:{type:"redirect",redirect:{transform:{queryTransform:{addOrReplaceParams:a}}}},condition:{urlFilter:t,resourceTypes:["main_frame"]}}]);try{await R.updateDynamicRules(e)}catch(i){c.error(i)}}}},l._getDSQueryParams=()=>{const t=l.getQueryParams(_.ocodeMgr.getDSOCode())["_queryDict"];if(!T(t)&&0!==Object.keys(t).length){const e=Object.keys(t);return e.map(e=>({key:e,value:t[e].toString()}))}},l}(r.SymBfw,r.NSSS,r.FG)}(executionContext),function(e){"use strict";e.NSSS.Rating=function(r,t,a){var E=r.utils.isNil,_=r.utils.isntNil,o=(r.utils.isFunction,a.constants,t.constants.RATING_TYPE),n=a.constants.IPS,s=a.constants.FORMJACK_PROTECTION,l=n.RATING_TYPE,S=a.wpsHelperUtils,c=t.Rating,T=a.helperUtils;const A=a.uiConstants;function e(e){_(e)?this._setNsssRating(e):(this._safeWebResult=null,this._isHeuristicsFalseNegative=!1,this._ipsResult=null,this._formjackResult=null,this._reloadPage=!1,this._isScamInsight=!1)}return e.prototype._setNsssRating=function(e){this._safeWebResult=e._safeWebResult&&new t.Rating(e._safeWebResult),this._isHeuristicsFalseNegative=e._isHeuristicsFalseNegative,this._ipsResult=e._ipsResult,this._formjackResult=e._formjackResult,this._reloadPage=e._reloadPage,this._isScamInsight=e._isScamInsight},e.prototype.getRating=function(){if(E(this._safeWebResult)&&E(this._ipsResult)&&E(this._formjackResult))return null;var e=this._getOverallPageRating(),t=null,n=null,i=null,a=null,o=(_(this._ipsResult)?(t=this._ipsResult.url,i=(this._ipsResult.ipsSignature||[]).join("_")):_(this._formjackResult)?(t=this._formjackResult.url,a=this._formjackResult.url):_(this._safeWebResult)&&(t=this._safeWebResult.fullURL,n=S.flavorizeFullReportUrl(this._safeWebResult.getFullReportURL()),a=this._safeWebResult.finalRedirectedTabUrl),{}),s=S.toolbarStatus(e);return o.siteStatus=s.statusString,o.siteIcon=s.statusImage,o.siteRating=e,o.url=t,o.finalRedirectedTabUrl=a,o.redirectPage=S.createRedirectURL(e,t,n,i,a),o.computerThreatAttributes=0,o.identityThreatAttributes=0,o.annoyanceFactorAttributes=0,o.shoppingRiskAttributes=0,o.phishingThreatAttributes=0,_(this._ipsResult)?(o.computerThreatAttributes=r.utils.isInteger(this._ipsResult.computerThreatAttributes)?this._ipsResult.computerThreatAttributes:0,o.blockedModule=this._ipsResult.blockedModule):_(this._formjackResult)?(o.blockedModule=this._formjackResult.blockedModule,o.redirectPage=A.FORM_JACK_PROTECTION_BLOCK_PAGE.HTML+"?"+this._formjackResult.queryParams):_(this._safeWebResult)&&(o.fullReportURL=n,o.searchText=S.getSearchTextForAnnotationURL(this._safeWebResult.fullURL),o.computerThreatAttributes=this._safeWebResult.computerThreats,o.identityThreatAttributes=this._safeWebResult.identityThreats,o.annoyanceFactorAttributes=this._safeWebResult.annoyanceFactors,o.shoppingRiskAttributes=this._safeWebResult.shoppingRisks,o.phishingThreatAttributes=this._safeWebResult.phishingThreats),E(o.redirectPage)&&!0===this._isScamInsight&&(o.scamInsightBlockPage=r.extensionAdapter.getExtensionURL("/content/ui/scam-insight-block-page.html")),o},e.prototype.reloadPage=function(e){var t;if(this._reloadPage)return this._reloadPage=!1,t=this,void setTimeout(function(){E(t._safeWebResult)||t._getSiteRatingPriority(t._safeWebResult.siteRating)<=t._getSiteRatingPriority(c.SITE_RATING.SW_CAUTION_MALICIOUS_STATE)?e(!0):e(!1)},500);e(!1)},e.prototype._setFullReportForPiracyUrl=function(t){if(!E(t)){let e=T.getSessionIDForTabID(r.extensionAdapter.getTabID(t));E(e)&&(e=a.main.createSessionForTab(t)),a.uiHelper.setShowFullReportForSessionID(e,!1)}},e.prototype._updateSessionForPiracyTab=function(n){r.extensionAdapter.getActiveTab(e=>{_(e)&&e.url.startsWith(n)?this._setFullReportForPiracyUrl(e):r.extensionAdapter.getAllTabs(e=>{let t=e.filter(e=>e.url.startsWith(n));t.forEach(e=>{this._setFullReportForPiracyUrl(e)})})})},e.prototype.setRating=function(e,t){var n,i;switch(t){case l.IPS:if(!1===a.webProtectionPolicy.isEnabled(t))return;this._ipsResult=e;break;case s.RATING_TYPE.FORMJACK_TYPE:if(!1===a.webProtectionPolicy.isEnabled(t))return;this._formjackResult=e;break;case o.SAFEWEB:if(!1===a.webProtectionPolicy.isEnabled(t))return;_(this._safeWebResult)?(n=this._safeWebResult.siteRating,((n=this._getSiteRatingPriority(n))<(i=this._getSiteRatingPriority(e.siteRating))||i==n&&T.isRatingForFinalRedirectedUrl(e))&&(this._safeWebResult=e,this._safeWebResult.siteRating===c.SITE_RATING.SW_REGIONAL_BLOCK&&this._updateSessionForPiracyTab(this._safeWebResult.fullURL))):(this._safeWebResult=e,this._safeWebResult.siteRating===c.SITE_RATING.SW_REGIONAL_BLOCK&&this._updateSessionForPiracyTab(this._safeWebResult.fullURL));break;case o.SCAM_INSIGHT:this._isScamInsight=!0}},e.prototype._getSiteRatingPriority=function(e){var t={},t=(t[c.SITE_RATING.SW_INVALID_STATE]=1,t[c.SITE_RATING.SW_NEUTRAL_STATE]=1,t[c.SITE_RATING.SW_TRUSTED_STATE]=2,t[c.SITE_RATING.SW_TRUSTED_TRANSACTION_STATE]=2,t[c.SITE_RATING.SW_NORTON_CERTIFIED]=2,t[c.SITE_RATING.SW_UNTRUSTED_TRANSACTION_STATE]=3,t[c.SITE_RATING.SW_CAUTION_MALICIOUS_STATE]=4,t[c.SITE_RATING.SW_ERROR_STATE]=5,t[c.SITE_RATING.SW_SUSPECTED_PHISHING_STATE]=6,t[c.SITE_RATING.SW_REGIONAL_BLOCK]=6,t[c.SITE_RATING.SW_PAGE_BAD_UNTRUSTED_TRANSACTION_STATE]=7,t[c.SITE_RATING.SW_KNOWN_MALICIOUS_STATE]=7,t[c.SITE_RATING.SW_KNOWN_PHISHING_STATE]=8,t[s.SITE_RATING.FORMJACK_STATE]=9,t[n.SITE_RATING.IPS_STATE]=10,t[e]);return E(t)?-1:t},e.prototype._getOverallPageRating=function(){var e=null;return _(this._ipsResult)?this._ipsResult.rating:_(this._formjackResult)?this._formjackResult.rating:_(this._safeWebResult)?this._safeWebResult.siteRating:e},e}(e.SymBfw,e.SafeWeb,e.NSSS)}(executionContext),function(e){"use strict";var t,n,i,a,o,s,r;e.NSSS.webProtectionPolicy=(t=e.SymBfw,n=t.settings,i=t.utils.isNil,a=t.logger,o=NSSS.constants.webProtectionPolicy,s=SafeWeb.constants.RATING_TYPE,r={_policyContainer:null,initialize:()=>{r._policyContainer=n.loadSettingsContainer(o.WEB_PROTECTION_POLICY_CONTAINER,!1),r._setDefaultStatus()},_setDefaultStatus:()=>{r._policyContainer.setObject(o.SAFEWEB_STATUS,!0),r._policyContainer.setObject(o.IPS_STATUS,!0),r._policyContainer.setObject(o.FORMJACK_STATUS,!0)},setSafeWebStatus:e=>{if(i(r._policyContainer))throw new Error("Policy Settings not initialized");r._policyContainer.setObject(o.SAFEWEB_STATUS,e)},setIPSStatus:e=>{if(i(r._policyContainer))throw new Error("Policy Settings not initialized");"Safari"!==t.globals.BROWSER&&NSSS.ips&&(e?NSSS.ips.enableIPS():NSSS.ips.disableIPS()),r._policyContainer.setObject(o.IPS_STATUS,e)},isEnabled:e=>{if(i(r._policyContainer))return a.error("Policy Settings not initialized"),!0;switch(e){case s.SAFEWEB:return r._policyContainer.getObject(o.SAFEWEB_STATUS);case s.IPS_STATUS:return r._policyContainer.getObject(o.IPS_STATUS);case o.FORMJACK_STATUS:return r._policyContainer.getObject(o.FORMJACK_STATUS)}return!0}})}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).webProtection=function(i,o,s){var r={},E=s.nfmEvents,_=i.utils.isNil,l=i.utils.isntNil,a=i.utils.isFunction;const e=i.utils.isInteger;var S=i.logger,c=(s.wpsHelperUtils,s.helperUtils),T=s.Rating;i.settings;const A=o.constants;var u=o.constants.RATING_TYPE;const n=i.extensionAdapter,I=(i.utils.isEmptyObject,i.utils);let R=i.performanceReporterFactory;var d=s.constants;return r._registeredEvents={},r.registerEventCallback=function(e,t){if(_(e))throw new Error("EventID cannot be null or undefined");if(!1===a(t))throw new Error("Callback function cannot be null.");this._registeredEvents[e]=t},r.handleScamExitSite=function(e){if(_(e))throw new Error("Invalid tab ID");r._submitSIPIIData(A.PII_FLAGS.EXIT_SITE,e),n.updateTabUrl(e,"about:blank",e=>{})},r.handleScamContinueSite=function(e){if(I.isNil(o))throw new Error("Safeweb is not defined");if(I.isNil(e))throw new Error("Invalid tab ID");var t=r._getSIBlockPageData(e);if(!_(t))return r._submitSIPIIData(A.PII_FLAGS.CONTINUE_TO_SITE,e),t=t.url,o.scamInsightUtility.addToViewAnywayCache(t),n.updateTabUrl(e,t,e=>{}),t},r.handleSIBlockPageInit=function(e,t,n){if(!a(e))throw new Error("sendResponse should be a valid function");if(i.utils.isEmptyObject(t)||_(t.strings))throw new Error("scamInsightBlockPage is not a valid Object");if(_(n))throw new Error("Invalid tab ID");n=r._getSIBlockPageData(n);_(n)||(t.ageScore=n.ageScore,t.prevalenceScore=n.prevalenceScore,t.url=n.url,e(t))},r._submitSIPIIData=function(e,t){if(I.isNil(o)||I.isNil(o.scamInsightMgr))return null;o.scamInsightMgr.sendPIISubmission(e,t)},r._getSIBlockPageData=function(e){return I.isNil(o)||I.isNil(o.scamInsightMgr)?null:o.scamInsightMgr.getBlockPageData(e)},r.handleEvent=function(e,t,n,i=0,a){if(_(e))throw new Error("Session ID cannot be null");if(_(t))throw new Error("Event cannot be null");if(_(n))throw new Error("eventData cannot be null");t!==E.FRAME_BEGIN&&t!==E.DOWNLOAD_EVENT||r.getProtectionRatingForURL(e,n,t)},r.getProtectionRatingForURL=function(n,e,i){const a="SafeWeb lookup time for block page: "+Date.now();if(_(e))throw new Error("URL cannot be null");R.reportStartForComponent(d.performanceReporter.NSSS,a),o.manager.getRatingForURL(e,function(e){var t;R.reportStopForComponent(d.performanceReporter.NSSS,a),_(e)||(r.handleShastaPageStatus(n,e,i),t=s.helperUtils.getSessionSetting(n,E.PAGE_ANALYZED),A.IS_SCAM_INSIGHT_ENABLED&&c.isRatingForFinalRedirectedUrl(t._safeWebResult)&&(t=c.getTabIDForSessionID(n),o.scamInsightMgr.setWrsResponse(t,e)))})},r.handleShastaPageStatus=function(t,n,i){if(!_(n)){let e=s.helperUtils.getSessionSetting(t,E.PAGE_ANALYZED);_(e)&&(e=new T),n.finalRedirectedTabUrl=s.helperUtils.getSessionSetting(t,d.FINAL_REDIRECTED_TAB_URL),e.setRating(n,u.SAFEWEB),s.helperUtils.setSessionSetting(t,E.PAGE_ANALYZED,e),i===E.FRAME_BEGIN?r.handleResponse(t,E.PAGE_ANALYZED,e):i===E.DOWNLOAD_EVENT&&r.handleResponse(t,E.DOWNLOAD_URL_ANALYZED,e)}},r.handleResponse=function(e,t,n){if(_(e))throw new Error("Session ID cannot be null");if(_(n))throw S.log("response cannot be null for eventID:"+t),new Error("response cannot be null");var i=this._registeredEvents[t];_(i)?S.error("Could not find callback method for eventID:"+t):setTimeout(function(){i(e,t,n)},1)},r.handleScamInsightEvent=function(t){if(e(t)){t=s.helperUtils.getSessionIDForTabID(t);if(!_(t)){let e=s.helperUtils.getSessionSetting(t,E.PAGE_ANALYZED);_(e)||(e.setRating({},u.SCAM_INSIGHT),r.handleResponse(t,E.PAGE_ANALYZED,e),s.helperUtils.setSessionSetting(t,E.PAGE_ANALYZED,e))}}},r.handleFormjackProtectionEvent=function(e){var{sessionID:t,nsssRating:n}=s.webProtection._handleFormjackProtectionEvent(e);e.details.isPageBlock||s.webProtection.handleResponse(t,s.nfmEvents.PAGE_ANALYZED,n)},r._handleFormjackProtectionEvent=function(e){var t=s.nfmEvents.PAGE_ANALYZED;let n=s.helperUtils.getSessionIDForTabID(e.details.tabId),i=(_(n)&&(n=s.main.createSessionForTab(e.details.tabId)),s.helperUtils.getSessionSetting(n,t));_(i)&&(i=new T);const a={rating:s.constants.FORMJACK_PROTECTION.SITE_RATING.FORMJACK_STATE,blockedModule:s.uiConstants.BLOCKPAGE.TYPE.FORMJACK,url:e.details.url};return l(e.details.queryParams)&&(a.queryParams=e.details.queryParams),(i=i.setRating?i:new s.Rating(i)).setRating(a,s.constants.FORMJACK_PROTECTION.RATING_TYPE.FORMJACK_TYPE),s.uiHelper.setShowFullReportForSessionID(n,!1),s.uiHelper.setShowReportSiteForSessionID(n,!1),s.helperUtils.setSessionSetting(n,t,i),{sessionID:n,nsssRating:i}},r}(e.SymBfw,e.SafeWeb,e.NSSS)}(executionContext),function(e){"use strict";function t(e){this._queryDict=URI.parseQuery(e)}e.NSSS.URLSearchParams=(e.SymBfw,t.prototype.get=function(e){return this._queryDict[e]},t.prototype.append=function(e,t){this._queryDict[e]=t},t.prototype.delete=function(e){delete this._queryDict[e]},t.prototype.toString=function(){var e,t="";for(e in this._queryDict)t+=e+"="+this._queryDict[e]+"&";return t.replace(/&$/,"")},t)}(executionContext),function(e){"use strict";var t,o,s,i,r;e.NSSS.ocodeMgr=(t=e.SymBfw,o=e.NSSS,s={},i=o.globalSettings,r=t.logger,s._oCodeWriteRestriction={ds:!1,hp:!1},s._lifeLockOCodes={DS:"APN12312",HP:"APN12313",UI_SEARCH:"APN12311"},s._lifeLockTestPartnerID="tiacll",s.getDSOCode=function(){return s._getOCode("DS")},s.updateDefaultOCode=function(e,t,n,i){var a=o.constants.OCODE_KEYS[e];return n===o.constants.OCODE_PROVIDER.AB_TEST?(o.constants[a]=t,s._oCodeWriteRestriction[e]=i,void r.debug(e+` OCode updated ${t}, isWriteRestricted: `+i)):s._oCodeWriteRestriction[e]?void r.debug(e+" write-restricted OCode not updated"):(o.constants[a]=t,void r.debug(e+" OCode updated "+t))},s.getHPOCode=function(){return s._getOCode("HP")},s.getUISearchOCode=function(){return s._getOCode("UI_SEARCH")},s._getOCode=function(e){var t=i.getPartnerId()===s._lifeLockTestPartnerID,n=null;switch(e){case"DS":n=t?s._lifeLockOCodes.DS:o.constants.DS_OCODE;break;case"HP":n=t?s._lifeLockOCodes.HP:o.constants.DHP_OCODE;break;case"UI_SEARCH":n=t?s._lifeLockOCodes.UI_SEARCH:o.constants.SEARCH_OCODE;break;default:throw r.error("Default ocode requested. Likely a bug"),new Error("There is no default OCode. Likely a bug")}return n},s)}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).NSSSHelper=function(s,a){let i={};const{utils:{isBoolean:e,isntNil:o,isNil:r,isString:E,isStorePageURL:_,isNumber:n},extensionAdapter:t}=s,{constants:l,globalSettings:S,URLSearchParams:c}=a;return i.constants={chromeInterstitialSegmentString:"chromeInterstitial"},i.getCurrentWindowLocation=function(){return document.location.href},i.isLandingPageURL=function(e){if(r(e)||!E(e))return!1;const t=new URI(e);return"https"===t.protocol()&&!(!l.ONBOARDING_PORTAL_DOMAIN_MAP.hasOwnProperty(t.domain())||!l.ONBOARDING_PORTAL_DOMAIN_MAP[t.domain()].includes(t.subdomain()))},i.isChromeInterstitialPageURL=e=>{if(r(e))return!1;var t=i.constants.chromeInterstitialSegmentString;const n=new URI(e);if("https"===n.protocol()&&a.constants.ONBOARDING_PORTAL_DOMAIN_MAP.hasOwnProperty(n.domain())&&a.constants.ONBOARDING_PORTAL_DOMAIN_MAP[n.domain()].includes(n.subdomain())){e=n.segment();if(1===e.length&&e[0]===t)return!0}return!1},i.isCurrentExtensionURL=e=>{var t=s.globals.BROWSER;let n=new URI(e);const i=n.path(),a=i.split("/");switch(t){case"Chrome":case"Edge-Chromium":if(a.includes(s.extensionAdapter.getExtensionId()))return!0;break;case"Safari":let e=n.search(!0).id;var o=s.extensionAdapter.getExtensionId().split("-")[0];if(e&&e.startsWith(o))return!0;break;case"Edge":if(a.includes(l.STORE_URL_NAME))return!0}},i.isYahooSERPPage=function(e){const t=[l.yahooVendorConstants.HSPART_VALUE,l.yahooVendorConstants.HSPART_VALUE_LEGACY],n=[l.yahooVendorConstants.HSIMP_VALUE,l.yahooVendorConstants.HSIMP_VALUE_THREE_IN_ONE,l.yahooVendorConstants.HSIMP_VALUE_EDGE_CHROMIUM];if(!E(e))return!1;const i=new URI(e);if("https"!==i.protocol())return!1;if(i.domain()!==l.YAHOO_DOMAIN_NAME)return!1;e=i.search(!0);return!!t.includes(e[l.yahooVendorConstants.HSPART])&&!!n.includes(e[l.yahooVendorConstants.HSIMP])},i.isIACSERPPage=function(e){if(!E(e))return!1;const t=new URI(e);return"https"===t.protocol()&&t.hostname()===l.HOST_NAME[l.IAC]},i.isValidURL=function(e){if(!E(e))return!1;const t=new URI(e);let n=t.protocol();return!r(n)&&0!==n.length&&(n=t.domain(),!r(n)&&0!==n.length)},i.getCurrentExtensionIdentifier=function(){var e=s.extensionAdapter.getExtensionURL("");if(r(e))return"";const t=new URI(e);return t.hostname()},i.isValidVendor=e=>!r(e)&&a.constants.VENDOR_LIST.includes(e),i.findAndSaveUrlParamsFromChromeWebStore=async()=>{if(!S.getFlavorized())return new Promise(a=>{t.getAllTabs(e=>{e=e.filter(e=>_(e.url));if(0===e.length)return a();for(const n of e)if(o(n.url)){var t=URI(n.url.toLowerCase())._parts.query;const i=new c(t);t=i.get(l.URL_PARAMS_KEY.GEO_LOCATION_ALIAS.toLowerCase());o(t)&&S.setGeoLocation(t)}return a()})})},i.getSubdomainForGeoLocation=(t,n)=>{if(!r(t)&&!r(n)){let e="";n=n.split("-")[0];return e=l.GEO_LOCATION_SUBDOMAIN_MAP[t]?l.GEO_LOCATION_SUBDOMAIN_MAP[t][n]||l.GEO_LOCATION_SUBDOMAIN_MAP[t].default:l.GEO_LOCATION_SUBDOMAIN_MAP[l.DEFAULT_COUNTRY.toLowerCase()].default}},i.isVendorMigrationDoneFFEdge=()=>!!e(a.constants.VENDOR_MIGRATION)&&a.constants.VENDOR_MIGRATION,i.isVendorMigrationDone=function(){return!!a.globalSettings.getVendorMigrationDone()},i.saveAndgetExtensionInstallMonthAndYear=function(){let e=a.globalSettings.getExtensionInstallMonthAndYear();if(E(e))return e;const t=a.globalSettings.getInstallDate().split("-");var n=1===t[1].length?t[1].padStart(2,"0"):t[1];const i=t[0];return e=""+n+i.slice(-2),a.globalSettings.setExtensionInstallMonthAndYear(e),e},i.waitForWindowLoadEvent=function(){return new Promise(e=>{window.addEventListener("load",e)})},i.isBlockPage=function(e){if(!E(e))return!1;if(!e)return!1;const t=new URL(e).pathname,n=[a.uiConstants.BLOCKPAGE.HTML,a.uiConstants.FORM_JACK_PROTECTION_BLOCK_PAGE.HTML];return n.some(e=>t===""+l.UI_PATH+e)},i.getTabWithUrl=function(e){if(E(e))return new Promise(t=>{s.extensionAdapter.getTabsWithURL(e,e=>{t(e)})})},i.focusTab=function(t){if(n(t))return new Promise(e=>{s.extensionAdapter.activateTab(t,()=>{e("tab focussed")})})},i}(e.SymBfw,e.NSSS)}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).main=function(u,I){var R={},d=I.uiConstants.BLOCKPAGE.TYPE,s=u.logger,n=u.utils,N=(u.settings,I.helperUtils),O=I.uiHelper,C=I.nfmEvents,g=u.utils.isNil,D=u.utils.isntNil,L=I.constants,o=I.globalSettings,P=I.webProtection,m=I.wpsHelperUtils,r=u.localizer,p=u.extensionAdapter,h=(I.init,I.uiConstants.MESSAGES);const f=I.uiConstants.SCAM_INSIGHT_BLOCK_PAGE.strings;let U=u.performanceReporterFactory,i=I.NSSSHelper;u.utils.isFunction;const a=u.constants.uiConstants;return R.downloadBlockParentUrlMap={},R.popoverWindowStrings=function(e,t){return O.popoverWindowStrings(e,t)},R.handleUIEvents=function(e,t){return N.handleUIEvents(e,t)},R.searchURLsAnalyzedCallback=function(e,t,n){var i,a,o;N.getSessionIDObject(e)?(i=n.annotationResults,a=N.getTabIDForSessionID(e),o={name:"annotate-urls",annotationResults:i,frameId:n.frameId},p.getTab(a,function(e){p.sendMessageToTab(e,o)})):s.log("Tab has been closed by the time search annotation results came back:"+e)},R.flavorizeAndReloadOnBoarding=function(){I.globalSettings.getFlavorized()||p.getAllTabs(function(e){e.forEach(function(e){var t=e.url;g(t)||i.isLandingPageURL(t)&&(p.addMessageListener(I.main._setSearchVendorMessageListener),t=p.getTabID(e),p.updateTabUrl(t,e.url),p.activateTab(t),N.setFlavor(e.url,{}))})})},R.performCollectURLs=function(e){e=N.getTabIDForSessionID(e);p.getTab(e,function(e){var t=p.getLastError();if(D(t))return s.log("Tab is not available"),void s.log(t);g(e)?s.log("Tab is not available so come back when tabReplaced has occurred"):p.sendMessageToTab(e,{name:"collectURLs"})})},R.handleTelemetryOptOut=function(){var t=u.telemetrySettings.isTelemetryEnabled();if(!t){var e=u.telemetrySettings.getLastOfferDate(),n=!1;do{if(g(e)){n=!0;break}if("Firefox"===u.globals.BROWSER)break;if(new Date-e>I.constants.telemetryOptOut.REOFFER_TIME_WINDOW){n=!0;break}}while(0);if(n){let e=I.constants.telemetryOptOut.NOTIFICATION_LEEWAY;t=(e="Firefox"===u.globals.BROWSER&&I.uiConstants.EXTENSION_TYPE!==I.uiConstants.SAFEWEB_EXTENSION?I.constants.telemetryOptOut.NOTIFICATION_LEEWAY_FIREFOX:e)+1e3*Math.random();R._showTelemetryNoitifcation(t)}}},R._showTelemetryNoitifcation=function(e){u.alarmHelper.setAlarm(I.constants.ALARM_NAMES.TELEMETRY_NOTIFICATION,{delayInMinutes:e/I.constants.MS_TO_MIN_CONVERSION_VALUE})},R.setTelemetryNotification=()=>{var e,t,n,i,a;u.telemetrySettings.isTelemetryEnabled()||(a=r.getLocalizedStringWithFormat("Thank you for using {0}! Share usage and error data anonymously with Norton to help make our products even better.",[L.PRODUCT_NAME]),e=r.getLocalizedString("OK"),t=r.getLocalizedString("Learn More"),n=r.getLocalizedString("No, thanks"),i="content/images/"+I.constants.DEFAULT_INFO_ICON,(a=new u.QuestionNotification(a,{},e,R._telemetryNotificationDefaultAction,i)).addSecondaryLink(t,R._telemetryNotificationSecondayLinkAction),a.addThirdButton(n,R._telemetryNotificationThirdButtonAction),a.addCloseButtonAction(R._telemetryNotificationCloseButtonAction),u.telemetrySettings.setLastOfferDate(new Date),u.notificationCenter.addNotification(a),u.extensionAdapter.isManifestV3Extension()&&o.setTelemetryNotificationId(a.getID()),I._telemetryNotificationID=a.getID())},R._handleNotificationEvent=async function(e){await I.init.ready();var e=e.detail,t=o.getTelemetryNotificationId();if(e.notificationID===t)switch(e.eventID){case a.NOTIFICATION.MESSAGES.DEFAULT_BUTTON_PRESSED:R._telemetryNotificationDefaultAction();break;case a.NOTIFICATION.MESSAGES.SECONDARY_LINK_PRESSED:R._telemetryNotificationSecondayLinkAction();break;case a.NOTIFICATION.MESSAGES.THIRD_BUTTON_PRESSED:R._telemetryNotificationThirdButtonAction();break;case a.NOTIFICATION.MESSAGES.NOTIFICATION_CLOSED:R._telemetryNotificationCloseButtonAction();break;default:return}},R._telemetryNotificationDefaultAction=e=>{u.telemetrySettings.setTelemetryEnabled(!0),u.telemetrySettings.setUserRespondedInOptOutPage(!0),"Firefox"===u.globals.BROWSER&&I.uiConstants.EXTENSION_TYPE!==I.uiConstants.SAFEWEB_EXTENSION&&I.init._sendInstallHBPing()},R._telemetryNotificationSecondayLinkAction=e=>{I.settingsManager.openSiteDirector(I.constants.PRIVACY_POLICY_SSDCAT),R._showTelemetryNoitifcation(50)},R._telemetryNotificationThirdButtonAction=e=>{u.telemetrySettings.setTelemetryEnabled(!1),u.telemetrySettings.setUserRespondedInOptOutPage(!0)},R._telemetryNotificationCloseButtonAction=e=>{u.telemetrySettings.setTelemetryEnabled(!1),u.telemetrySettings.setUserRespondedInOptOutPage(!0)},R.handleOnUpdated=async function(e,t,n){s.log("Handle on updated:"+e),await I.init.ready();var i=N.getSessionIDForTabID(e);if(N.isURLWhitelisted(n.url))N.updateActionButton(i,e,n.url);else{var a=await I.extensionURLValidator.isNortonExtensionURL(n.url),o=I.NSSSHelper.isBlockPage(n.url);if(a&&!o)return a=p.getExtensionURL("content/images/")+I.constants.SAFE_IMAGE+".png",void p.setBrowserIcon({path:a,tabId:e});o=O.toolbarStatusForSessionID(i);g(o)||(a=p.getExtensionURL(""),n.url.startsWith(a)&&g(o.redirectPage)&&g(o.scamInsightBlockPage)&&R.deleteSessionForTab(e),N.updateActionButton(i,e,o.url))}},R.tabIdToRedirectUrlsMap={},R.collectRedirectUrls=function(e){let t;t=R.tabIdToRedirectUrlsMap[e.tabId]||new Set;var n=N.getSessionIDForTabID(e.tabId),n=(g(n)&&R.createSessionForTab(e.tabId),p.getExtensionURL(""));e.url.startsWith(n)||(t.add(e.url),R.tabIdToRedirectUrlsMap[e.tabId]=t)},"sw"!==I.uiConstants.EXTENSION_TYPE&&"three-in-one"!==I.uiConstants.EXTENSION_TYPE||chrome.webRequest.onBeforeRequest.addListener(R.collectRedirectUrls,{urls:["<all_urls>"],types:["main_frame"]}),R.handleMessage=function(e,i,a){var o=a,s=p.getTabID(o),r=N.getSessionIDForTabID(s),E=(g(r)&&(r=R.createSessionForTab(s)),e.message),_=e.name,l=null;switch(_){case h.DOMEVENT:if(E.eventID===C.FRAME_BEGIN&&(R.pageAnalysisTime="Overall time taken for page analysis: "+Date.now(),U.reportStartForComponent(L.performanceReporter.NSSS,R.pageAnalysisTime),I.constants.TABID,R._deleteOldSession(r,s,E.url)&&(r=R.createSessionForTab(s)),N.setSessionSetting(r,I.constants.FINAL_REDIRECTED_TAB_URL,E.url),g(I.main.tabIdToRedirectUrlsMap[s])&&(S={url:E.url,tabId:a.id},R.collectRedirectUrls(S))),D(I.main.tabIdToRedirectUrlsMap[s])&&(R.tabIdToRedirectUrlsMap[s].forEach(e=>{P.handleEvent(r,E.eventID,e)}),delete R.tabIdToRedirectUrlsMap[s]),E.isTop){var S=E.hidden;if(D(S)&&N.setSessionSetting(r,"hidden",S),N.setSessionSetting(r,E.eventID,!0),E.eventID===C.NAVIGATE_COMPLETE){if(l=N.getSessionSetting(r,C.PAGE_ANALYZED),g(l))return;D(l.searchText)&&I.main.performCollectURLs(r)}}break;case h.SHOW_ANNOTATION_POPUP:case h.CLOSE_ANNOATION_POPUP:var S={name:_,data:E};p.sendMessageToTab(o,S);break;case"collectURLs":if(l=N.getSessionSetting(r,C.PAGE_ANALYZED),g(l))return;D(l.searchText)&&I.main.performCollectURLs(r);break;case"flavor-retrieved":if(g(o.url))return;N.setFlavor(o.url,E);break;case h.BLOCKEDPAGE_SEARCH:u.utils.isString(E.searchText)&&(R.handleClose(s),S=N.getSearchURL(I.constants.BLOCKEDPAGE_SEARCH_OCODE,E.searchText),p.updateTabUrl(s,S),I.telemetryWrapper.sendBlockedPageSearchEvent());break;case h.HANDLE_UI_EVENTS:R.handleUIEvents(E.eventID,E.eventData);break;case h.UPDATE_POPOVER_UI:return I.telemetryWrapper.sendShowPopupUIEvent(p.getExtensionURL("content/ui/popup.html")),I.chromeGlobal.updatePopoverUI(i),!0;case h.BLOCKEDPAGE_INIT:g(E.pageType)&&(E.pageType=d.MALICIOUS);var S={},c=(S.string=O.getBlockPageString(E.pageType),I.helperUtils.getFeatureFlavorization()),c=(S.showSafeWebSearchbox=E.pageType!==d.IPS&&c.showSafeWebSearchbox,S.showNortonLinks=E.pageType!==d.SUSPECTEDBAD&&c.showNortonLinks,S.pageType=E.pageType,S.canShowFullReport=E.pageType!==d.IPS&&E.pageType!==d.SUSPECTEDBAD,O.uiStatusForSessionID(r,o.url));D(c)&&(S.fullReportURL=c.fullReportURL),S.isFireGlassSupported=N.isFireGlassSupported()&&E.pageType!==d.SUSPECTEDBAD,i(S);{const l=O.toolbarStatusForSessionID(r),d=m.blockPageType(l.siteRating),A=N.getSessionSetting(r,C.PAGE_ANALYZED);let e=!1,t=(D(A)&&D(A._safeWebResult)&&(e=!N.isRatingForFinalRedirectedUrl(A._safeWebResult)),null);l.blockedModule===I.uiConstants.BLOCKPAGE.TYPE.IPS&&D(A._ipsResult)&&D(A._ipsResult.ipsSignature)&&(t=A._ipsResult.ipsSignature.join("_")),I.telemetryWrapper.sendBlockPageTelemetry(l.url,d,!1,e,t)}break;case h.OPEN_DO_NOT_BLOCK_PAGE:var c=E.url,S=E.blockPageType,T=(N.setSessionSetting(r,I.constants.SHOULD_BLOCK_KEY,!1),"Safari"!==u.globals.BROWSER&&S===d.IPS&&I.ips&&I.ips.continueToSite(c,s),p.updateTabUrl(s,c,function(e){}),N.getSessionSetting(r,C.PAGE_ANALYZED));let e=c,t=!1;D(T)&&!0===(t=!N.isRatingForFinalRedirectedUrl(T._safeWebResult))&&(e=T._safeWebResult?T._safeWebResult.fullURL:c),I.telemetryWrapper.sendBlockPageTelemetry(e,S,!0,t);break;case h.SCAM_INSIGHT_BLOCKPAGE_INIT:let n={};n.direction=u.localizer.getCurrentLanguageDirection(),n.strings=u.localizer.getLocalizedStrings(f),P.handleSIBlockPageInit(i,n,s),I.telemetryWrapper.sendScamBlockPageVisitedEvent(n.url);break;case h.SCAM_EXIT_SITE:P.handleScamExitSite(s);break;case h.SCAM_CONTINUE_TO_SITE:T=P.handleScamContinueSite(s);I.helperUtils.setSessionSetting(r,I.constants.SHOULD_BLOCK_KEY,!1),I.telemetryWrapper.sendScamContinueToSiteEvent(T);break;case h.SCAM_REPORT_ISSUE:I.telemetryWrapper.sendScamReportIssueEvent();break;case h.EXTN_SETTINGS_PAGE_LOADED_TELEMETRY:I.telemetryWrapper.sendSettingsPageLoadEvent()}},R.setDSVendorConstants=e=>{var t=I.chromeGlobal.constants.SEARCHHELPER_MAP;g(t)||(I.constants.VENDOR=e,I.constants.DS_OCODE=t.DS_OCODE[e],I.constants.SEARCH_URL=t.SEARCH_URL[e],I.constants.NORTONSAFE_HOSTNAME=t.NORTONSAFE_HOSTNAME[e])},R._deleteOldSession=function(t,e,n){let i=N.getSessionSetting(t,C.PAGE_ANALYZED);if(g(i))return R.deleteSessionForTab(e),!0;var a=(i=i.getRating?i:new I.Rating(i)).getRating();let o=new URI(n);if(!a||!a.finalRedirectedTabUrl)return R.deleteSessionForTab(e),!0;let s=new URI(a.finalRedirectedTabUrl);if(o.hostname()!==s.hostname())return R.deleteSessionForTab(e),!0;if(o.hostname()===L.NORTONSAFE_HOSTNAME&&o.query()!==s.query())return R.deleteSessionForTab(e),!0;n=N.getSessionSetting(t,L.SHOULD_BLOCK_KEY);if(g(n)||!0===n)return!1;a=N.getSessionSetting(t,L.CONTINUE_SITE_LOADED_KEY);return D(a)&&!0===a?(R.deleteSessionForTab(e),!0):("Edge"===u.globals.BROWSER?setTimeout(function(){p.getTab(e,function(e){g(e)||e.url.includes("ms-appx-web")||N.setSessionSetting(t,L.CONTINUE_SITE_LOADED_KEY,!0)})},1e3):N.setSessionSetting(t,L.CONTINUE_SITE_LOADED_KEY,!0),!1)},R.pageAnalyzedCallback=function(e,t,n){var i;N.getSessionIDObject(e)?(s.log("Inside pageAnalyzedCallback"),N.setSessionSetting(e,t,n),i=N.getTabIDForSessionID(e),n.reloadPage(function(e){e&&(e=n.getRating(),p.updateTabUrl(i,e.url))}),N.updateButton(e,i)):s.log("Tab has been closed by the time page annotation results came back:"+e)},R.createSessionForTab=function(e){var t=N.getSessionIDForTabID(e);if(D(t))return t;t=n.createNewGuid();return N.setSessionSetting(t,L.TABID,e),t},R.deleteSessionForTab=function(e){delete R.tabIdToRedirectUrlsMap[e];e=N.getSessionIDForTabID(e);g(e)?s.log("Tab has no sessionID associated with it. Seems like a bug"):N.deleteSessionSettings(e)},R.handleTabReplaced=function(e){var t=e.replacedTabId,e=(R.deleteSessionForTab(t),e.tabId),t=(R.deleteSessionForTab(t),N.getSessionIDForTabID(e));N.updateButton(t,e)},R.handleActivate=function(e,t){var n=e.tabId,i=(s.log("Inside handleActivate"),s.log(n),N.getSessionIDForTabID(n));if(g(i))return D(t)&&u.utils.isString(t.url)?void N.updateActionButton(i,n,t.url):void p.getTab(n,function(e){let t="";D(e)&&u.utils.isString(e.url)&&(t=e.url),N.updateActionButton(i,n,t)});N.updateButton(i,n,!0)},R.analyzeDownloadPage=function(e){"in_progress"===e.state&&(R.downloadBlockParentUrlMap[e.url]=e.referrer,P.handleEvent(e.id,C.DOWNLOAD_EVENT,e.url))},R.getParentUrlForDownloadBlock=function(e){return R.downloadBlockParentUrlMap[e]},R.handleOmniSearchEvent=function(e){if(u.globals.BROWSER===u.constants.BROWSER_TYPE.FIREFOX&&!I.privacyPromptSettings.getPrivacyConsent())return t=p.getExtensionURL(I.uiConstants.PRIVACY_PROMPT_SCREEN.HTML),p.updateTabUrl(e.tabId,t),{cancel:!0};var t=e.url,e=N.getQueryString("q",t),t=N.getSearchURL(I.ocodeMgr.getDSOCode(),e);return I.telemetryWrapper.sendDefaultSearchEvent(),{redirectUrl:t}},R.handleClose=function(e,t){R.deleteSessionForTab(e)},R._executeScripts=async function(e){try{await p.executeContentScript(e,"content/libs/uri.min.js"),await p.executeContentScript(e,"ContextInit.js"),await p.executeContentScript(e,"content/scripts/SymBfwCS.js"),await p.executeContentScript(e,"content/scripts/NSSS_CS.js"),u.globals.BROWSER===u.constants.BROWSER_TYPE.CHROME&&await p.executeContentScript(e,"content/scripts/portalInstallFlowCS.js"),u.globals.BROWSER===u.constants.BROWSER_TYPE.EDGE_CHROMIUM&&(await p.executeContentScript(e,"content/scripts/portalInstallFlowCS.js"),I.uiConstants.EXTENSION_TYPE===I.uiConstants.SAFEWEB_EXTENSION&&await p.executeContentScript(e,"content/scripts/nsssEdgeGuidedFlowsManagerCS.js")),await p.executeContentScript(e,"content/scripts/webCommunication.js")}catch(e){s.error("Error while executing the scripts")}},R.injectWebCommunication=function(){p.getAllTabs(function(e){const t=N.getPagesToFlavor(e);0<t.length&&t.forEach(async e=>{var t=e&&e.id,t=("Chrome"!==u.globals.BROWSER&&"Firefox"!==u.globals.BROWSER&&"Edge-Chromium"!==u.globals.BROWSER||t&&I.main._executeScripts(t),new URI(e.url).query(!0));I.portalCguid=t[I.constants.URL_PARAMS_KEY.CGUID]})})},R.handleInstall=function(e){let t=e.reason,n=u.globals.BROWSER,i=(I.isFreshInstall=!1,"install"===t&&(I.isFreshInstall=!0,I.main.injectWebCommunication()),I.init.ready());i.then(function(){let e=I.telemetryWrapper;switch(t){case"install":"Edge"===n||"Safari"===n?I.main.flavorizeAndReloadOnBoarding():N.flavorizeExtension(),e.sendExtensionInstall(),I.globalSettings.getInstallDate(),I.init.updateAntiTrackerStatus();break;case"update":e.sendExtensionUpdate(),I.NSSSHelper.isVendorMigrationDoneFFEdge()&&e.sendVendorMigrationPing(),I.globalSettings.getInstallDate(),I.init.updateAntiTrackerStatus()}},function(e){s.error(e)})},R._setSearchVendorMessageListener=(e,t,n)=>{var i=e.message;switch(e.name){case h.SET_DS_VENDOR:if(D(o.getValue(I.constants.VENDOR_IS_PRESENT)))return;var a=i.vendor;if(g(a))break;I.globalSettings.setVendor(a),o.setValue(I.constants.VENDOR_IS_PRESENT,!0),R.setDSVendorConstants(a),!0===I.chromeGlobal.TWO_IN_ONE&&a===I.constants.YAHOO&&I.chromeGlobal.setDateOfAssociationForSafari()}},R.checkIfFirstInstall=function(){var e=I.globalSettings.getValue(I.constants.NSSS_INSTALLDATEKEY);u.utils.isntNil(e)||(I.main.handleInstall({reason:"install"}),o.setCurrentDateAsDoi())},R.initVendorConstants=function(){I.NSSSHelper.isValidVendor(L.VENDOR)||(L.VENDOR=I.globalSettings.getVendor()),I.NSSSHelper.isValidVendor(L.VENDOR)&&(I.vendorSetup&&I.vendorSetup.vendorPromiseResolve(!0),I.ocodeMgr.updateDefaultOCode("hp",L.ocodeMap[L.VENDOR].hp),I.ocodeMgr.updateDefaultOCode("ds",L.ocodeMap[L.VENDOR].ds),I.uiConstants.EXTENSION_TYPE===I.uiConstants.THREE_IN_ONE&&(L.NORTONSAFE_HOSTNAME=L.HOST_NAME[L.VENDOR]))},R.handleStartUp=async()=>{await I.init.initializeSessionSettings(),u.settings.deleteSettingsContainer(I.constants.NSSS_SESSION_SETTINGS_CONTAINER,()=>{I.init.initializeSessionSettings()})},R}(e.SymBfw,e.NSSS)}(executionContext),SymBfw.extensionAdapter.addStartupListener(NSSS.main.handleStartUp),window.addEventListener(SymBfw.constants.uiConstants.NOTIFICATION.NOTIFICATION_EVENT,NSSS.main._handleNotificationEvent),function(e){"use strict";const t=e.SymBfw;var n=e.XNE;const i=n.init,a=n.config,s=n.constants;t.settings;const o=n.exclusionManager,r=t.logger,E=t.utils.isNil,_=t.utils.isntNil,l=t.utils.isInteger,S=NSSS.constants;NSSS.Rating;S.IPS.SUPPORTED_BROWSERS.includes(t.globals.BROWSER)&&(e.NSSS.ips=new class{constructor(){this.browserReference=e.browser||e.chrome,this.isValidKey=a.Keys().reduce((e,t)=>(e[t]=!0,e),{}),this.basicConfig={autoRedirect:!1,allowNativeMessaging:!1,autoPageBlock:!0,allowUrlQuery:!1},this.loadConfig={browserObject:this.browserReference,notificationCallback:this._ipsHandler.bind(this),GUID:null,ProductName:S.PRODUCT_NAME+"_"+t.extensionAdapter.getExtensionId(),ProductVersion:S.VERSION}}getConfig(e){if(_(e)&&_(this.isValidKey[e]))return a.Get(e);r.error("cannot set config to a invalid key")}setConfig(e,t){if(_(e)&&_(this.isValidKey[e]))return a.Set(e,t);r.error("cannot set config to a invalid key")}setBasicConfig(){for(var[e,t]of Object.entries(this.basicConfig))a.Set(e,t)}set exclusionTime(e){l(e)&&(s.EXCLUSION_TTL=e)}continueToSite(e,t){if(_(e)&&_(t)){if(o.IsExcluded(e,t))return!1;o.AddExclusion(e,t)}}enableIPS(){i.isEnabled()||i.Enable()}disableIPS(){i.isEnabled()&&i.Disable()}async _handleIpsPage(e,t){await NSSS.init.ready();var n=NSSS.nfmEvents.PAGE_ANALYZED;let i=NSSS.helperUtils.getSessionIDForTabID(t),a=(E(i)&&(i=NSSS.main.createSessionForTab(t)),NSSS.helperUtils.getNSSSRating(i));a.setRating(e,S.IPS.RATING_TYPE.IPS),NSSS.uiHelper.setShowFullReportForSessionID(i,!1),NSSS.uiHelper.setShowReportSiteForSessionID(i,!1),NSSS.helperUtils.setSessionSetting(i,n,a),NSSS.webProtection.handleResponse(i,n,a)}_ipsHandler(e,t=0){var n,i,a=e.optional,o=(e.sigIds||[]).filter(e=>0!==e);e.type==s.msgType.HTTP_HDR_SCANNER&&0<o.length&&0<e.tabId&&!1===a.isExcluded&&(n=e.tabId,i={rating:S.IPS.SITE_RATING.IPS_STATE,url:a.url,blockedModule:NSSS.uiConstants.BLOCKPAGE.TYPE.IPS,computerThreatAttributes:o.length,ipsSignature:o},this._handleIpsPage(i,n),r.log(`
            Action: ${e.recommendation}
            URL: ${a.url}
            AlertId(s): ${o}
            Exclusion Override: ${a.isExcluded}
            evnet: ${e}
          `))}initialize(){return this.loadConfig.GUID=NSSS.globalSettings.getCGuid(),i.initialize(this.loadConfig).then(e=>(r.log("IPS is intialized successfully"),!0)).catch(e=>(r.error("IPS is failed to intialize "+e),!1))}})}(executionContext),function(e){"use strict";e.NSSS.init=function(s,r,n,i,E){var _={};const{logger:a,extensionAdapter:e,darkModeHandler:t,utils:{isNil:o,isntNil:l,isString:S,isBoolean:c}}=s,{constants:T,constants:{MULTIVARIATE_SDK_CONFIG:A},uiConstants:u,NSSSHelper:I,antiTrackerStatusProvider:R,globalSettings:d,ocodeMgr:N}=r;return _.supported_languages={el:!0,en:!0,pt_br:!0,it:!0,ar:!0,cs:!0,es:!0,ru:!0,nl:!0,pt:!0,no:!0,nb:!0,tr:!0,ro:!0,pl:!0,fr:!0,zh_tw:!0,de:!0,hu:!0,fi:!0,da:!0,ja:!0,he:!0,zh_cn:!0,ko:!0,sv:!0},_.initializeLocalizer=function(){return new Promise((n,i)=>{s.localizer.initialize(_.supported_languages,function(e,t){!0===e?n("localizer is ready"):i("localizer initialize failed: "+t)})})},_.getClientID=function(){let e="";return o(r.portalCguid)?e=r.globalSettings.getCGuid():(e=r.portalCguid.toLowerCase(),r.globalSettings.setCGuid(e)),e},_.initializeTelemetry=function(){return new Promise((t,n)=>{var e=s.telemetryConstants,e=(r.globalSettings,{APPLICATION_NAME:T.PRODUCT_NAME+"_"+s.extensionAdapter.getExtensionId(),APPLICATION_VERSION:T.VERSION,CLIENT_ID:_.getClientID(),DATA_SOURCE:e.dataSource.BROWSER_EXTENSION,TRACKING_ID:T.TELEMETRY_TRACKING_ID,USER_LANGUAGE:navigator.language,ANONYMIZE_IP:1,GOOGLE_ANALYTICS_PROTOCOL_VERSION:1,BROWSER_NAME:s.globals.BROWSER});try{s.telemetry.init(e,function(e){!0===e?t("Telemetry initialized"):n("Failed to initialize telemetry")})}catch(e){n("Failed to initialize telemetry. "+e)}})},_._handleTelemetryFF=()=>{var e=r.PrivacyPromptController.getTelemetryOptInStatus();if(c(e))return s.telemetrySettings.setTelemetryEnabled(e),void(e&&r.init._sendInstallHBPing());r.globalSettings.getPrivacyConsentAcceptClicked()&&!s.telemetrySettings.isTelemetryEnabled()||r.init._sendInstallHBPing()},_.initializeGlobalSettings=function(){return new Promise((t,n)=>{r.globalSettings.initialize(function(e){e?t("Global settings initialized"):n("Failed to initialize global settings")})})},_.initializeSessionSettings=function(){return new Promise((t,n)=>{r.sessionSettings.initialize(function(e){e?t("Session settings initialized"):n("Failed to initialize session settings")})})},_._initializeWebProtectionPolicy=()=>new Promise((e,t)=>{try{l(r.webProtectionPolicy)&&r.webProtectionPolicy.initialize(),e("Web Protection Policy initialized")}catch(e){t("Error initializing Web Protection Policy: "+e.message)}}),_._initializeWAX=function(e){var t;return l(n)&&l(n.init)?(t=n.constants,n.init.initializeWaxFormDataLoaderSettings(e,null,{[t.parsePreferences.PARSE_CRITERIAS]:{[t.parseCriterias.ALLOW_PAGE_PORT_VIEW]:!0,[t.parseCriterias.DONT_PERFORM_GROUP_CATEGORIZE]:!0},[t.parsePreferences.REGEX_ENABLED_FIELDS]:[t.fieldType.EMAIL,t.fieldType.PASSWORD,t.fieldType.PIN,t.fieldType.SSN,t.fieldType.CREDIT_CARD_NUMBER]})):Promise.resolve("Wax not needed")},_._registerSI=function(){return new Promise((e,t)=>{try{l(i)&&l(i.scamInsightMgr)&&(r.uiConstants.EXTENSION_TYPE===r.uiConstants.SAFEWEB_EXTENSION||r.uiConstants.EXTENSION_TYPE===r.uiConstants.THREE_IN_ONE)&&(i.scamInsightMgr.registerEventCallback(r.webProtection.handleScamInsightEvent),i.scamInsightMgr.setVersion(r.constants.VERSION)),e("ScamInsight callback registered and extension version is set")}catch(e){t("Error registering ScamInsight callback or setting extension version: "+e.message)}})},_._initializeIPS=async()=>{if("Safari"===s.globals.BROWSER||o(r.ips))return!1;try{return await r.ips.initialize()}catch(e){return!1}},_._initializeFormjackProtection=async()=>{if("Safari"!==s.globals.BROWSER&&!o(r.formjackProtectionManager))try{return await r.formjackProtectionManager.init({onDomainBlocked:function(e){r.webProtection.handleFormjackProtectionEvent(e)}})}catch(e){return void a.error("Error in _initializeFormjackProtection: "+e)}},_._initializeFGUrlParams=function(){const e=new r.URLSearchParams;var t=_.getClientID(),n=s.extensionAdapter.getExtensionId(),i=r.constants.VERSION,a=T.PRODUCT_NAME,o=r.globalSettings.getValue(r.constants.NSSS_INSTALLDATEKEY),t=(e.append(T.FG_URL_PARAMS.MID,t),e.append(T.FG_URL_PARAMS.PRODUCT_ID,n),e.append(T.FG_URL_PARAMS.PRODUCT_VERSION,i),e.append(T.FG_URL_PARAMS.PRODUCT_NAME,a),e.append(T.FG_URL_PARAMS.DOI,o),e.toString());E.background_helpers.setFeedbackUrlParam(t)},_._getHBConfigs=function(){const e=new HeartbeatSDK.HBConfig;return e.prodName=T.PRODUCT_NAME+"_"+s.extensionAdapter.getExtensionId(),e.prodVersion=T.VERSION,e.machineId=_.getClientID(),e.dataSource=T.HEARTBEAT_CONFIG.DATA_SOURCE,e.apiKey=T.TELEMETRY_TRACKING_ID,e.userLanguage=navigator.language,e.heartBeatIntervalInMilliSec=T.HEARTBEAT_CONFIG.HEARTBEAT_SDK_PING_INTERVAL,e},_._initializeHeartBeatSDK=function(){try{const n=_._getHBConfigs();if(n.isInstallPingEnabled=!1,n.isFreshInstall=!1,n.isHeartBeatPingEnabled=!0,u.EXTENSION_TYPE===u.SAFEWEB_EXTENSION&&(n.heartBeatIntervalInMilliSec=T.HEARTBEAT_CONFIG.HEARTBEAT_SDK_PING_INTERVAL_48_HOURS),n.additionalHeartBeatPingParams={[s.telemetryConstants.parameters.CUSTOM_DIMENSION3]:()=>s.telemetrySettings.isTelemetryEnabled(),...u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION4]:()=>T.VENDOR},...[u.HOMEPAGE_EXTENSION,u.DEFAULT_SEARCH_EXTENSION].includes(u.EXTENSION_TYPE)&&s.globals.BROWSER===s.constants.BROWSER_TYPE.CHROME,...r.privacyPromptSettings&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION13]:r.privacyPromptSettings.getPrivacyConsent},...l(r.globalSettings.getCustomChicklets())&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION14]:()=>r.globalSettings.getCustomChicklets().length},...u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION15]:I.isVendorMigrationDone},[s.telemetryConstants.parameters.CUSTOM_DIMENSION19]:()=>I.saveAndgetExtensionInstallMonthAndYear(),...r.abTestingDataProvider&&{...r.abTestingDataProvider.getHeartBeatPingCustomDimesions()}},R){const e=R.getAntiTrackerTelemetryParamsMap();e.forEach((e,t)=>{n.additionalHeartBeatPingParams[t]=e})}HeartbeatSDK.hbManager.init(n)}catch(e){a.error("Heartbeat SDK Failed to intialize for heartbeat Ping",e)}},_._getProductCode=function(){return u.EXTENSION_TYPE},_.onABTestingRulesUpdated=async function(e){const t=_._getProductCode().toLowerCase();let n=null;const i=e.tests.find(e=>r.abTestingAppsRepo.abTestImpls[e.id]);if(i&&i.variant&&i.variant.data&&0<i.variant.data.length&&((e=i.variant.data.find(e=>e.product.toLowerCase()===t&&e.oCode&&0<e.oCode.length))&&(n={oCode:e.oCode})),!n)return e=T.ocodeMap[T.IAC][t],void N.updateDefaultOCode(t,e,T.OCODE_PROVIDER.AB_TEST,!1);N.updateDefaultOCode(t,n.oCode,T.OCODE_PROVIDER.AB_TEST,!0)},_._getMultiVariateSDKConfig=function(){var e=T.PRODUCT_NAME;return{settingsStorage:r.globalSettings,rulesJsonCdnPath:A.CDN_URL,rulesRootCA:A.ROOT_CA,certInfo:T.CERT_INFO,schedulerInterval:A.SCHEDULER_INTERVAL,appName:e,productCode:u.EXTENSION_TYPE,subCategory:T.VENDOR,category:T.PRODUCT_NAME_CATEGORY_MAP[e],installDate:d.getInstallDate(),onRulesUpdated:_.onABTestingRulesUpdated}},_._initializeMultiVariateTestingSDK=async function(){try{var e=_._getMultiVariateSDKConfig();await multiVariateTestingSDK.multiVariateTestManager.init(e)}catch(e){a.error("Failed to initialize MultiVariate Testing SDK",e)}},_.sendInstallPing=function(e,t){try{const n=_._getHBConfigs();n.isInstallPingEnabled=!0,n.isFreshInstall=!0,n.isHeartBeatPingEnabled=!1,n.additionalInstallPingParams={...u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&S(T.VENDOR)&&0!==T.VENDOR.length&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION4]:()=>T.VENDOR},...u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&l(e)&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION7]:()=>e},...u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&l(t)&&{[s.telemetryConstants.parameters.CUSTOM_DIMENSION8]:()=>t},...r.abTestingDataProvider&&{...r.abTestingDataProvider.getInstallPingCustomDimesions()}},HeartbeatSDK.hbManager.init(n)}catch(e){a.error("Heartbeat SDK Failed to intialize for Install Ping",e)}},_.updateAntiTrackerStatus=function(){R&&R.updateAntiTrackerStatus()},_._readPortalCGUID=function(){return new Promise((n,e)=>{var t;if(o(r.isFreshInstall)&&(t=r.globalSettings.getValue(r.constants.NSSS_INSTALLDATEKEY),r.isFreshInstall=o(t)),!r.isFreshInstall||!o(r.portalCguid))return n(!1);s.extensionAdapter.getAllTabs(e=>{const t=r.helperUtils.getPagesToFlavor(e);return 0<t.length&&t.forEach(e=>{l(e)&&(e=e.url,e=new URI(e).query(!0),r.portalCguid=e[r.constants.URL_PARAMS_KEY.CGUID])}),n(!0)})})},_._initializeFireGlass=function(){o(E)||(r.helperUtils.initializeFGSetting(),_._initializeFGUrlParams())},_._initializePrivacyConsentFlow=async function(){if(o(r.PrivacyPromptController))return Promise.resolve();await r.PrivacyPromptController.userPrivacyConsent()},_._checkForLandingPageAndResolve=async function(){await new Promise(t=>{e.getAllTabs(async e=>{e=e.filter(e=>I.isLandingPageURL(e.url));if(0===e.length)return t();r.enableAllFlow.sendEnableAllFlowCommListenerAddedMsgToTab(e),await r.enableAllFlow.handleEnableAllFlow(),t()})})},_._initEnableAllFlowStatus=async function(){return o(r.enableAllFlow)?Promise.resolve():(await r.privacyPromptSettings.initialize(),r.privacyPromptSettings.getPrivacyConsent()?Promise.resolve():void await _._checkForLandingPageAndResolve())},_._initPrivacyPromptSettings=async function(){if(o(r.privacyPromptSettings))return Promise.resolve();await r.privacyPromptSettings.initializeSettingsContainer()},_._updateExtensionIconDarkMode=()=>{u.EXTENSION_TYPE!==u.HOMEPAGE_EXTENSION&&u.EXTENSION_TYPE!==u.DEFAULT_SEARCH_EXTENSION&&u.EXTENSION_TYPE!==u.TWO_IN_ONE||(t.isDarkModeEnabled()?e.setBrowserIcon({path:{32:"Icon-dark-32.png"}}):e.setBrowserIcon({path:{32:"Icon-32.png"}}))},_._sendInstallHBPing=()=>{_.sendInstallPing(),_._initializeHeartBeatSDK()},_._initializeDynamicQuicksLinksData=()=>{r.quickLinksProvider&&u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION&&s.globals.BROWSER!==s.constants.BROWSER_TYPE.FIREFOX&&r.quickLinksProvider.initializeDynamicQuickLinksData()},_._shouldHandleTelemetryForFF=()=>"Firefox"===s.globals.BROWSER&&u.EXTENSION_TYPE!==u.SAFEWEB_EXTENSION,_.ready=function(){return l(_.readyPromise)||(_.readyPromise=async function(){try{s.extensionAdapter.init(),await Promise.all([_.initializeGlobalSettings(),_.initializeSessionSettings(),_.initializeLocalizer()]),await _._readPortalCGUID(),await _._initPrivacyPromptSettings(),await _._initEnableAllFlowStatus(),await _._initializeMultiVariateTestingSDK(),await _._initializePrivacyConsentFlow(),await _._initializeWebProtectionPolicy();var e=s.localizer.getLocale();return _._initializeFireGlass(),await _.initializeTelemetry(),_._shouldHandleTelemetryForFF()&&r.init._handleTelemetryFF(),_._shouldHandleTelemetryForFF()||_._sendInstallHBPing(),await Promise.all([s.notificationSettings.intializeNotificationSettings(),_._initializeWAX(e),_._registerSI(),_._initializeIPS(),_._initializeFormjackProtection()]),r.uiConstants.EXTENSION_TYPE!==r.uiConstants.SAFEWEB_EXTENSION&&r.twitterFeeds&&r.twitterFeeds.initializeTwitterFeeds(),_._initializeDynamicQuicksLinksData(),_._updateExtensionIconDarkMode(),Promise.resolve("NSSS is ready")}catch(e){return Promise.reject("NSSS initialize failed: "+e)}}()),_.readyPromise},_}(e.SymBfw,e.NSSS,e.SymWax,e.SafeWeb,(e.SymO2,e.FG))}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).partnerConstants=(e.NSSS,{searchboxExclusionList:{1001:{puid:["1251","59"]},1013:{puid:["6990","10000001","6498","6251","1339","1314","1312","1308","1301","1270","1113","130","129"]},1005:{puid:["20000002","20000001","6412","1394","1393","1392","1391","1390","1389","1388","1387","1386","1385","1384","1383","1325","1313","1298","1284","1283","1282","1281","1280","1278","1276","1271","1235","1154","1133","1131","1129","1128","1127","1121","1120","1119","1103","126","125","124","123","122","120","115","114","109","107","106","104","101","86","83","79","77"]},1118:{puid:["1193"]}},excludeNortonLinks:["sos","oem","ppo","cto","tt","ttda"]})}(executionContext),function(e){"use strict";(e.NSSS=e.NSSS||{}).settingsManager=function(S,a,o,s){var c={};S.logger;const r=S.utils.isntNil,T=S.utils.isNil,t=S.utils.isBoolean,A=a.constants,i=S.localizer,u=S.extensionAdapter,E=(a.init,a.uiConstants),_=E.MESSAGES,l=E.SETTINGS_UI.strings,I=E.BROWSER_NOTIFICATION.strings,R=S.telemetrySettings,d=a.helperUtils;return c._postSignOut=function(e){var t=i.getLocalizedStrings(I);let n=null;n=e?t["You have successfully logged out of your NortonLifeLock Account"]:t["Sorry, something went wrong. Please try again."];e=new S.TimedNotification(n,E.BROWSER_NOTIFICATION_IMAGE);S.notificationCenter.addNotification(e)},c._setTelemetryStatus=async e=>{t(e)&&(await a.init.ready(),R.setTelemetryEnabled(e),r(a._telemetryNotificationID)&&e&&(S.notificationCenter.removeNotification(a._telemetryNotificationID),a._telemetryNotificationID=null))},c._openPrivacyPolicypage=async()=>{await a.init.ready(),c.openSiteDirector(A.PRIVACY_POLICY_SSDCAT)},c._sendSettingsPagedata=async e=>{await a.init.ready();let n={};n.showHomepageTourButton=d.isHomePageTourSupported(),n.direction=i.getCurrentLanguageDirection(),n.strings=i.getLocalizedStrings(l),n.isTelemetryEnabled=R.isTelemetryEnabled(),r(s)&&r(s.background_helpers)&&(n.isLayoutSupported=d.isFireGlassSupported(),n.isLayoutSupported&&s.background_helpers.get_settings_url_markup(!0,function(e,t){e&&(n.isLinkGuardEnabled=t)})),e(n)},c._handleStartHomePageTourClick=async()=>{await a.init.ready(),a.homePage.didUserTriggerHomePageTour=!0,a.telemetryWrapper.sendTourTriggeredByUserEvent(),u.createTab(u.getExtensionURL(a.constants.HOME_PAGE))},c.handleMessage=function(e,t,n){var i=e.message;switch(e.name){case _.SET_TELEMETRY_ENABLED:c._setTelemetryStatus(i);break;case _.SETTINGS_PRIVACY_POLICY:c._openPrivacyPolicypage();break;case _.OPEN_IPS_LEARN_MORE_URL:c.openSiteDirectorIPS(!0);break;case _.UPDATE_FG_LINK_GUARD:r(s)&&r(s.background_helpers)&&s.background_helpers.set_settings_url_markup(i);break;case _.SETTINGS_PAGE_UI_INIT:return c._sendSettingsPagedata(t),!0;case _.SIGN_OUT:if(r(o)&&r(o.session))return o.session.logout(e=>{t({isLogoutSuccess:e}),c._postSignOut(e)}),!0;break;case _.START_HOME_PAGE_TOUR:c._handleStartHomePageTourClick()}},c.openSiteDirector=function(e,t=A.DEFAULT_ORIGIN_VALUE,n=!1,i=!1,a=A.DEST_PARAM_PRIVACY){let o=A.SITE_DIRECTOR_URL;const s=S.localizer.getNavigatorLanguage();var r=s.split("-");const E=r[0];let _=r[1];T(_)&&(_=A.DEFAULT_COUNTRY);var r=A.ISO2_ISO3_COUNTRY[_.toUpperCase()],l=A.ISO2_ISO3_LANGUAGE[E.toUpperCase()];o=(o=(o=(o=(o=o.replace("ISO3_COUNTRY_CODE",r)).replace("ISO3_LAN_CODE",l)).replace("SSDCAT_VALUE",e)).replace("ORIGIN",t)).replace("DESTINATION",a),n&&(r=c.getAdditionalParams(),o+=r),i&&(o+=i),u.createTab(o)},c.openSiteDirectorIPS=function(e=!1){let t=A.SITE_DIRECTOR_IPS_URL;var n=A.IPS_LEARN_MORE_SSDCAT,i=A.NEWFEATURE_ORIGIN_VALUE,a=S.localizer.getNavigatorLanguage();t=(t=(t=t.replace("SSDCAT_VALUE",n)).replace("ORIGIN",i)).replace("LAN_CODE",a),e&&(n=c.getAdditionalParams(),t+=n),u.createTab(t)},c.getAdditionalParams=()=>{var e=a.globalSettings.getPartnerId(),t=a.globalSettings.getPUID(),n=a.globalSettings.getLayoutType();let i=A.SITE_DIRECTOR_ADDITIONAL_PARAM;return i=T(e)||T(t)||T(n)?A.ISPID:(i=(i=i.replace("LAYOUT_TYPE",n)).replace("PARTNERID",e)).replace("PUID",t)},u.addMessageListener(c.handleMessage),c}(e.SymBfw,e.NSSS,e.SymO2,e.FG)}(executionContext),function(e){const{utils:{isntNil:t,isNil:n},cdnFileDownloader:i,logger:a}=e.SymBfw,{constants:o,globalSettings:s}=e.NSSS;(e.NSSS=e.NSSS||{}).twitterFeeds=new class{async fetchAndSaveTwitterFeeds(){try{var e;this._isTimeElapsedToFetchTweetsJsonFromCDN()&&(e=await i.getPayloadFromCdnFile(o.TWITTER_FEEDS_CDN_URL,o.twitterFeedsJsonRootCA,o.CERT_INFO),t(e)&&3===e.length&&s.setTwitterFeedsData(e))}catch(e){a.error("Fetching twitter feeds from CDN failed.",e)}}async initializeTwitterFeeds(){var e=await SymBfw.extensionAdapter.getAlarm(o.ALARM_NAMES.TWITTER_FEEDS);t(e)||(await this.fetchAndSaveTwitterFeeds(),await this._createAlarmForTwitterFeed())}async _createAlarmForTwitterFeed(){var e={periodInMinutes:o.TWITTER_FEEDS_PERIOD_IN_MINUTES};SymBfw.extensionAdapter.createAlarm(o.ALARM_NAMES.TWITTER_FEEDS,e)}_isTimeElapsedToFetchTweetsJsonFromCDN(){var e=s.getTweetsLastFetchedTimestamp();return!!n(e)||Date.now()-e>=o.TWITTER_FEEDS_CDN_FETCH_DELAY}}}(executionContext),(()=>{const{uiConstants:n,constants:t}=NSSS;class i{static get SUPPORTED_DOMAINS(){return{YAHOO_DOMAIN:/\.?search\.yahoo\.com?\.?/,IAC_DOMAIN:/nortonsafe\.search\.ask\.com/,GOOGLE_DOMAIN:/\.google\./,BING_DOMAIN:/bing\.com/}}static get IAC_NORTON_SERP_PARAMS(){return{[t.URL_PARAMS_KEY.OCODE]:["*"]}}static get YAHOO_NORTON_SERP_PARAMS(){var e=t.yahooVendorConstants;return{[e.HSPART]:[e.HSPART_VALUE],[e.HSIMP]:[e.HSIMP_VALUE,e.HSIMP_VALUE_THREE_IN_ONE,e.HSIMP_VALUE_EDGE_CHROMIUM,e.HSIMP_VALUE_CHROME_TEST_ELIGIBLE]}}static get SUPPORTED_DOMAIN_DETAILS(){return{IAC_NORTON_SERP:{domain:this.SUPPORTED_DOMAINS.IAC_DOMAIN,params:this.IAC_NORTON_SERP_PARAMS},YAHOO_NORTON_SERP:{domain:this.SUPPORTED_DOMAINS.YAHOO_DOMAIN,params:this.YAHOO_NORTON_SERP_PARAMS},GOOGLE_SERP:{domain:this.SUPPORTED_DOMAINS.GOOGLE_DOMAIN},YAHOO_SERP:{domain:this.SUPPORTED_DOMAINS.YAHOO_DOMAIN},BING_SERP:{domain:this.SUPPORTED_DOMAINS.BING_DOMAIN}}}static get VENDOR_TO_SUPPORTED_DOMAINS_MAP(){return{[t.IAC]:this.SUPPORTED_DOMAIN_DETAILS.IAC_NORTON_SERP,[t.YAHOO]:this.SUPPORTED_DOMAIN_DETAILS.YAHOO_NORTON_SERP}}}NSSS.annotationManager=new class{constructor(){this.loadEventHandler=this.loadEventHandler.bind(this)}_getSafeWebSupportedDomains(){var e=SymBfw.utils.getOSType();return SymBfw.globals.BROWSER===SymBfw.constants.BROWSER_TYPE.CHROME&&e===SymBfw.constants.os.WINDOWS?[i.SUPPORTED_DOMAIN_DETAILS.IAC_NORTON_SERP,i.SUPPORTED_DOMAIN_DETAILS.YAHOO_SERP,i.SUPPORTED_DOMAIN_DETAILS.GOOGLE_SERP,i.SUPPORTED_DOMAIN_DETAILS.BING_SERP]:[i.SUPPORTED_DOMAIN_DETAILS.IAC_NORTON_SERP,i.SUPPORTED_DOMAIN_DETAILS.YAHOO_NORTON_SERP]}_getSupportedDomains(){return[i.VENDOR_TO_SUPPORTED_DOMAINS_MAP[t.VENDOR]]}_getAnnotationConfigs(){let e;return{domains:{supportedDomains:e=n.EXTENSION_TYPE===n.SAFEWEB_EXTENSION?this._getSafeWebSupportedDomains():this._getSupportedDomains()},safeWebInitPromise:NSSS.init.ready()}}async loadEventHandler(){var e=this._getAnnotationConfigs();const t=new annotationSDK.AnnotationBG;await t.init(e),await NSSS.init.ready(),n.EXTENSION_TYPE!==n.SAFEWEB_EXTENSION&&await NSSS.helperUtils.isVendorInitialized()}},NSSS.AnnotationSupportedDomains=i,NSSS.annotationManager.loadEventHandler()})(executionContext),function(e){const{utils:{isntNil:t,isString:n},extensionAdapter:i}=e.SymBfw,{constants:a,telemetryWrapper:s,uiConstants:{MESSAGES:o}}=e.NSSS;(e.NSSS=e.NSSS||{}).nsssCCTelemetryBG=new class{constructor(){this._telemetryData=[],this._webRequestListners={},i.addTabRemovedEventListener(this._handleTabRemoved),i.addTabUpdatedEventListener(this._handleTabUpdated)}_handleTabRemoved(e,t){e in NSSS.nsssCCTelemetryBG._webRequestListners&&NSSS.nsssCCTelemetryBG._removeWebRequestListnerForTab(e)}_handleTabUpdated(e,t,n){t.url&&e in NSSS.nsssCCTelemetryBG._webRequestListners&&NSSS.nsssCCTelemetryBG._removeWebRequestListnerForTab(e)}_removeWebRequestListnerForTab(e){var t;e in NSSS.nsssCCTelemetryBG._webRequestListners&&(t=NSSS.nsssCCTelemetryBG._webRequestListners[e],chrome.webRequest.onBeforeRequest.removeListener(t.callback),clearTimeout(t.timer),delete NSSS.nsssCCTelemetryBG._webRequestListners[e])}_storeTelemetryData(e){n(e)&&(NSSS.nsssCCTelemetryBG._telemetryData.length>=a.TELEMETRY_DATA_LIMIT&&NSSS.nsssCCTelemetryBG._telemetryData.shift(),NSSS.nsssCCTelemetryBG._telemetryData.push(e))}_onBeforeRequestCallback(o){i.getTab(o.tabId,function(n){if(t(n)){var n=new URI(n.url),i=new URI(o.url),a=new URI(o.initiator||o.originUrl),n=n._parts.protocol+"://"+n._parts.hostname+n._parts.path,i=i._parts.protocol+"://"+i._parts.hostname+i._parts.path;let e=a._parts.protocol+"://"+a._parts.hostname+a._parts.path,t="iframe";n===e&&(t="embedded",e="");a=n+`, ${e}, ${i}, `+t;NSSS.nsssCCTelemetryBG._telemetryData.includes(a)||(NSSS.nsssCCTelemetryBG._storeTelemetryData(a),s.sendCreditCardTelemetryNetworkRequests(n,e,i,t))}})}_monitorNetworkCallFromThisTab(e){var t,n;e in NSSS.nsssCCTelemetryBG._webRequestListners||(t=this._onBeforeRequestCallback.bind({tabId:e}),chrome.webRequest.onBeforeRequest.addListener(t,{urls:["<all_urls>"],tabId:e,types:["xmlhttprequest"]}),i.isManifestV3Extension()&&SymBfw.serviceWorkerKeepAlive.startKeepAliveConnection(e,18e4),n=setTimeout(e=>{NSSS.nsssCCTelemetryBG._removeWebRequestListnerForTab(e)},18e4,e),NSSS.nsssCCTelemetryBG._webRequestListners[e]={callback:t,timer:n})}messageHanlder(a,e,t){t=i.getTabID(t);a.message;a.name===o.CC_TELEMETRY_CAPTURE_NETWORK_CALLS&&(i.getTab(t,function(e){var e=new URI(e.url),t=new URI(a.frameUrl),e=e._parts.protocol+"://"+e._parts.hostname+e._parts.path;let n=t._parts.protocol+"://"+t._parts.hostname+t._parts.path,i="iframe";e===n&&(n="",i="embedded"),s.sendCreditCardTelemetry(e,n,i)}),NSSS.nsssCCTelemetryBG._monitorNetworkCallFromThisTab(t))}},i.addMessageListener(NSSS.nsssCCTelemetryBG.messageHanlder)}(executionContext),executionContext,NSSS.formjackProtectionConstants=class{static get CDN_URL(){return"https://static.nortoncdn.com/nortonextensionhomepage/formjack-protection.json"}static get APP_NAME(){return"FORMJACK_PROTECTION"}static get SCHEDULER_INTERVAL_IN_MINS(){return 1440}static get RETRY_INTERVAL_IN_MINS(){return 30}static get DNR_RULES_START_INDEX(){return 101}static get SERVICE_WORKER_KEEP_ALIVE_INTERVAL(){return 24e4}static get REGEX_PATTERN_TO_SPLIT(){return"^https?://(www.)?([^=/?&]*.)?"}static get DOMAIN_BLOCK_MONITOR_INTERVAL_IN_MINUTES(){return 1}static get MONITOR_DOMAIN_BLOCK(){return"monitor_domain_block"}static get BLOCK_TYPE(){return{sub_frame:"iframe",network_request:"submission",main_frame:"page"}}static get RESET_CONTINUE_TO_SITE(){return"reset_continue_to_site"}static get RESET_CONTINUE_TO_SITE_INTERVAL_IN_MINUTES(){return 30}},(()=>{const{alarmHelper:n,logger:s,extensionAdapter:r,utils:{isArray:E,isNil:i,isFunction:a,isNumber:o,isString:_}}=SymBfw,{formjackProtectionConstants:l,constants:S}=NSSS;NSSS.formjackProtectionRulesAllocator=new class{constructor(){this._blackListDomains=null,this._onBeforeRequestCallback=null,this._allowedDomains=[]}async getExistingFormjackRuleIds(){var e=(await this._getExistingFormJackRulesAndIds())["existingFormjackRuleIds"];return e}async getExistingFormjackRules(){var e=(await this._getExistingFormJackRulesAndIds())["existingFormjackRules"];return e}async _getExistingFormJackRulesAndIds(){const e=await r.getDynamicRules();if(!E(e))return{existingFormjackRules:[],existingFormjackRuleIds:[]};const t=e.filter(e=>e.id>=l.DNR_RULES_START_INDEX);var n=t.map(e=>e.id);return{existingFormjackRules:t,existingFormjackRuleIds:n}}async getRuleForId(t){if(o(t)){const e=(await this._getExistingFormJackRulesAndIds())["existingFormjackRules"];if(E(e)&&0!==e.length)return e.find(e=>e.id===t)}}async _getRuleforDomain(n){n.startsWith(S.WWW_PATTERN)&&(n=n.replace(S.WWW_PATTERN,""));const e=await this.getExistingFormjackRules();return e.find(e=>{var t=e.condition.regexFilter.split(l.REGEX_PATTERN_TO_SPLIT)[1];if(n.includes(t))return e})}async allowBlockedDomain(e){_(e)&&(await this._allowBlockedDomain(e),this._registerClearContinueToSiteSettings(e))}async _allowBlockedDomain(e){var t;r.isManifestV3Extension()?(t=await this._getRuleforDomain(e),t=this._addAllowActionToRule(t),await r.updateDynamicRules([t])):this._allowBlockedDomainMv2(e)}_allowBlockedDomainMv2(t){var e;a(this._onBeforeRequestCallback)&&E(this._blackListDomains)&&-1<(e=this._blackListDomains.findIndex(e=>this._isDomainMatched(t,e)))&&(this._allowedDomains.push(t),this._blackListDomains.splice(e,1),this._updateWebRequestListener())}_isDomainMatched(e,t){return e===t.domain||!!e.endsWith("."+t.domain)}_registerClearContinueToSiteSettings(e){e=l.RESET_CONTINUE_TO_SITE+"_"+e;n.setAlarm(e,{delayInMinutes:l.RESET_CONTINUE_TO_SITE_INTERVAL_IN_MINUTES})}async resetAllowBlockedDomain(e){var t;_(e)&&(r.isManifestV3Extension()?(t=await this._getRuleforDomain(e),i(t)||(t=this._addRedirectActionToRule(t,e),await r.updateDynamicRules([t]))):this._resetAllowBlockedDomainMv2(e))}_resetAllowBlockedDomainMv2(e){E(this._blackListDomains)&&a(this._onBeforeRequestCallback)&&(this._blackListDomains.push({domain:e}),-1<(e=this._allowedDomains.indexOf(e))&&this._allowedDomains.splice(e,1),this._updateWebRequestListener())}async resetAllAllowedDomain(){const e=await NSSS.formjackProtectionRulesAllocator.getExistingFormjackRules(),t=e.filter(e=>"allow"===e.action.type);var n;E(t)&&0!==t.length&&(n=t.map(e=>{var t=e.condition.regexFilter.split(l.REGEX_PATTERN_TO_SPLIT)[1];return e=NSSS.formjackProtectionRulesAllocator._addRedirectActionToRule(e,t)}),r.updateDynamicRules(n))}async createDynamicRules(i){if(E(i)){var a=l.DNR_RULES_START_INDEX,e=chrome.declarativeNetRequest.MAX_NUMBER_OF_DYNAMIC_RULES-a+1,t=(i.length>e&&s.debug(`Formjack rules exceeded, total size: ${i.length} - domains truncated`),i.length>e?a+e-1:a+i.length-1),e=await this.getExistingFormjackRuleIds();const o=[];for(let n=a;n<=t;n++){let e=i[n-a].domain,t=(e=e.replaceAll(".","."),{id:n,priority:1,condition:{regexFilter:"^https?://(www.)?([^=/?&]*.)?"+e,resourceTypes:["main_frame","script","stylesheet","sub_frame","webbundle","websocket","webtransport","xmlhttprequest"]}});await this.isAllowedDomain(e)?(t=this._addAllowActionToRule(t),o.push(t)):(t=this._addRedirectActionToRule(t,e),o.push(t))}r.updateDynamicRules(o,e)}else s.log("Invalid domains - dynamic rules creation failed")}async isAllowedDomain(t){const e=await this.getExistingFormjackRules();if(!E(e)||0===e.length)return!1;var n=e.find(e=>{if(e.condition.regexFilter.includes(t))return e});return!i(n)&&"allow"===n.action.type}_addAllowActionToRule(e){return e.action={type:"allow"},e}_addRedirectActionToRule(e,t){var n=r.getExtensionURL(S.FORMJACK_PROTECTION_BLOCK_PAGE);return e.action={type:"redirect",redirect:{regexSubstitution:n+"?blockedDomain="+t+"&originalURL=\\0"}},e}_updateWebRequestListener(){chrome.webRequest.onBeforeRequest.removeListener(this._onBeforeRequestCallback);const t=[];this._blackListDomains.forEach(e=>{t.push("*://*."+e.domain+"/*")}),chrome.webRequest.onBeforeRequest.addListener(this._onBeforeRequestCallback,{urls:t},["blocking"])}_getValidDomains(n){return i(this._allowedDomains)||0===this._allowedDomains.length||this._allowedDomains.forEach(t=>{var e=n.findIndex(e=>e.domain===t);-1<e?n.splice(e,1):this._clearContinueToSiteAlarm(t)}),n}async _clearContinueToSiteAlarm(e){var t;!E(this._allowedDomains)||(t=this._allowedDomains.indexOf(e))<0||(this._allowedDomains.splice(t,1),t=l.RESET_CONTINUE_TO_SITE+"_"+e,await n.clearAlarm(t))}async updateWebRequestListener(e,t){E(e)?a(t)?(this._blackListDomains=this._getValidDomains(e),this._onBeforeRequestCallback=t,this._updateWebRequestListener()):s.log("Invalid callback - webrequest listener creation failed"):s.log("Invalid domains - webrequest listener creation failed")}},chrome.runtime.onStartup.addListener(NSSS.formjackProtectionRulesAllocator.resetAllAllowedDomain)})(executionContext),(()=>{const{extensionAdapter:n,logger:a,utils:{isString:o}}=SymBfw,s=NSSS["constants"];NSSS.formjackProtectionUtils=new class{getQueryParamsForBlockPage(e,t,n,i){{if(o(e)&&o(t)&&o(n))return i=(i?Date.now()-i:0)/1e3,`${s.BLOCKED_DOMAIN}=${e}&${s.ORIGINAL_URL}=${t}&${s.BLOCK_TYPE}=${n}&${s.BLOCK_DELAY}=`+i;a.debug("Invalid parameters")}}async handleLearnMoreLinkClicked(e){await NSSS.init.ready();var t=n.getExtensionURL(s.FORMJACK_PROTECTION_LEARN_MORE);n.createTab(t),NSSS.telemetryWrapper.sendFormjackProtectionLearnMoreClicked(e)}}})(executionContext),(()=>{const{extensionAdapter:o,alarmHelper:e,logger:a,localizer:s,utils:{isNil:r,isFunction:n,isArray:i,isString:E}}=SymBfw,{constants:_,uiConstants:{MESSAGES:l},formjackProtectionConstants:{MONITOR_DOMAIN_BLOCK:S,DOMAIN_BLOCK_MONITOR_INTERVAL_IN_MINUTES:t,REGEX_PATTERN_TO_SPLIT:c,SERVICE_WORKER_KEEP_ALIVE_INTERVAL:T,BLOCK_TYPE:A,RESET_CONTINUE_TO_SITE:u},formjackProtectionRulesAllocator:I,formjackProtectionUtils:R,telemetryWrapper:d}=NSSS;NSSS.formjackProtectionMonitor=new class{constructor(){this._monitorBlockedDomains=this._monitorBlockedDomains.bind(this),this.handleAlarm=this.handleAlarm.bind(this),this._sendFormjackProtectionBlockPageDataAndExecuteCallback=this._sendFormjackProtectionBlockPageDataAndExecuteCallback.bind(this),this.handleMessage=this.handleMessage.bind(this)}init(e,t){o.isManifestV3Extension()&&(n(e)&&n(t)?(this._onDomainBlocked=e,this._onBeforeRequestCallback=t,this._onDomainBlocked=this._onDomainBlocked.bind(this),this._onBeforeRequestCallback=this._onBeforeRequestCallback.bind(this),this._registerScheduler()):a.error("Formjack monitor initialize failed, callback is not a function"))}_registerScheduler(){e.setAlarm(S,{periodInMinutes:t})}async _getBlockedDomain(e){e=e.rule;const t=await I.getRuleForId(e.ruleId);{if(!r(t))return t.condition.regexFilter.split(c)[1];a.debug("Rule does not exist for the id")}}async _handleFormJackBlockForTab(n,i){const a=await this._getBlockedDomain(i);E(a)&&!await I.isAllowedDomain(a)&&o.getTab(n,e=>{var t;e.url.startsWith(_.EXTENSION_URL)||(t=R.getQueryParamsForBlockPage(a,e.url,A.sub_frame,i.timeStamp),this._onDomainBlocked({details:{tabId:n,url:e.url,queryParams:t}}))})}async _monitorBlockedDomains(){const e=(await o.getAllMatchedRules())["rulesMatchedInfo"];i(e)&&0!==e.length&&e.forEach(e=>{var t=e["tabId"];-1!==t&&this._handleFormJackBlockForTab(t,e)})}handleAlarm(e){const t=e.name;switch(!0){case t===S:this._monitorBlockedDomains();break;case t.includes(u):var n=t.split(u+"_")[1];I.resetAllowBlockedDomain(n)}}async _getBlackListedUrls(){const e=await I.getExistingFormjackRules();if(i(e)&&0!==e.length){const n=[];return e.forEach(e=>{const t=e.condition.regexFilter;e=t.split(c)[1];n.push(`*://*.${e}/*`)}),n}a.debug("Existing form jack rules are not present")}async _monitorNetworkCalls(e){var t=await this._getBlackListedUrls();i(t)&&0!==t.length?(SymBfw.serviceWorkerKeepAlive.startKeepAliveConnection(e,T),chrome.webRequest.onBeforeRequest.addListener(this._onBeforeRequestCallback,{urls:t,tabId:e,types:["xmlhttprequest","websocket"]})):a.debug("No black list domains found")}async _sendFormjackProtectionBlockPageDataAndExecuteCallback(e,t,n){await NSSS.init.ready();var i=NSSS.uiConstants.FORM_JACK_PROTECTION_BLOCK_PAGE,i={direction:s.getCurrentLanguageDirection(),strings:s.getLocalizedStrings(i.strings),descText:s.getLocalizedString(i.descText)};this._sendFormjackBlockPageTelemetry(t),e(i),this._executeOnDomainBlockCallback(t.telemetryData.url,n)}async _handleContinueToSite(e,t,n,i){await NSSS.init.ready(),E(e)&&(this._sendFormjackBlockPageTelemetry(i),i=NSSS.helperUtils.getSessionIDForTabID(t),NSSS.helperUtils.setSessionSetting(i,NSSS.constants.SHOULD_BLOCK_KEY,!1),await I.allowBlockedDomain(e),o.updateTabUrl(t,n,e=>{}))}async _handleTechnicalDetailsClick(){await NSSS.init.ready(),o.createTab(_.FORMJACK_PROTECTION_LEARN_TECHNICAL_DETAILS),d.sendFormjackBlockPageTechDetailsClicked()}_encodeOriginalUrl(e){if(E(e)){const n=e.split("&"),i=n.find(e=>e.startsWith(_.ORIGINAL_URL));var t=encodeURIComponent(i.split(_.ORIGINAL_URL+"=")[1]);return e.replace(i,_.ORIGINAL_URL+"="+t)}}_sendFormjackBlockPageTelemetry(e){var e=e.telemetryData,t=this._encodeOriginalUrl(e.url),t=new URL(t);const n=new URLSearchParams(t.search);t={originalURL:decodeURIComponent(n.get(_.ORIGINAL_URL)),blockType:n.get(_.BLOCK_TYPE),blockDelay:n.get(_.BLOCK_DELAY),blockedDomain:n.get(_.BLOCKED_DOMAIN)};d.sendFormjackBlockPageTelemetry(t,e.isContinueToSite)}async _sendFormjackProtectionLearnMoreData(e){await NSSS.init.ready();var t=NSSS.uiConstants.FORM_JACK_PROTECTION_BLOCK_PAGE;e({direction:s.getCurrentLanguageDirection(),strings:s.getLocalizedStrings(t.learnMoreStrings)})}_executeOnDomainBlockCallback(e,t){E(e)&&this._isPageBlock(e)&&(e=this._getQueryParamFromUrl(e,_.ORIGINAL_URL),this._onDomainBlocked({details:{url:e,tabId:t,isPageBlock:!0}}))}_getQueryParamFromUrl(e,t){if(E(e)&&!r(t)){e=new URL(e);const n=new URLSearchParams(e.search);return n.get(t)}}_isPageBlock(e){if(E(e))return e=this._getQueryParamFromUrl(e,_.BLOCK_TYPE),!E(e)}async _handleFormjackExitPage(e){await NSSS.init.ready(),o.updateTabUrl(e,_.BLANK_TAB_LINK,e=>{}),d.sendFormjackBlockPageExitClicked()}handleMessage(e,t,n){if(r(e)||r(e.name)||r(n)||r(n.url))a.debug("Request or sender cannot be null");else{var i=n.id;switch(e.name){case l.FORMJACK_PROTECTION_MONITOR_NETWORK_CALLS:NSSS.formjackProtectionMonitor._monitorNetworkCalls(i);break;case l.FORMJACK_BLOCKPAGE_INIT:return this._sendFormjackProtectionBlockPageDataAndExecuteCallback(t,{telemetryData:{url:n.url,isContinueToSite:!1}},n.id),!0;case l.FORMJACK_CONTINUE_TO_SITE:this._handleContinueToSite(e.blockedDomain,i,e.tabUrl,{telemetryData:{url:n.url,isContinueToSite:!0}});break;case l.FORMJACK_LEARN_MORE_LINK_CLICK:R.handleLearnMoreLinkClicked(_.FORMJACK_LEARNMORE_LAUNCH_POINT.FORMJACK_BLOCK_PAGE);break;case l.FORMJACK_LEARN_TECHNICAL_DETAILS_CLICK:this._handleTechnicalDetailsClick();break;case l.FORMJACK_EXIT_PAGE:this._handleFormjackExitPage(i);break;case l.FORMJACK_PROTECTION_LEARN_MORE_UI_INIT:return this._sendFormjackProtectionLearnMoreData(t),!0}}}},SymBfw.extensionAdapter.addMessageListener(NSSS.formjackProtectionMonitor.handleMessage),SymBfw.alarmHelper.registerAlarmListener(NSSS.formjackProtectionMonitor.handleAlarm)})(executionContext),(()=>{const{jsonDownloader:n,logger:t,utils:{isObject:i,isArray:a},extensionAdapter:o}=SymBfw,{constants:s,formjackProtectionConstants:{APP_NAME:e,CDN_URL:r,SCHEDULER_INTERVAL_IN_MINS:E,RETRY_INTERVAL_IN_MINS:_,BLOCK_TYPE:l},formjackProtectionRulesAllocator:S,formjackProtectionMonitor:c,formjackProtectionUtils:T}=NSSS;NSSS.formjackProtectionManager=new class{constructor(){this._onDownloadedCallback=this.onDownloadedCallback.bind(this),this._onBeforeWebRequest=this._onBeforeWebRequestCallback.bind(this)}_getDownloadConfig(){return{appName:e,cdnUrl:r,schedulerIntervalInMins:E,retryIntervalInMins:_}}async init(e){if(!i(e))throw new Error("Invalid formjack protection config, initialization failed");var t=(this._config=e).onDomainBlocked,t=(c.init(t,this._onBeforeWebRequest),{...e,...this._getDownloadConfig(),onDownloadedCallback:this._onDownloadedCallback});try{await n.init(t)}catch(e){throw new Error("Initialization failed: "+e)}}_onBeforeWebRequestCallback(e){var t=new URL(e.url).hostname,n=l[e.type]||l.network_request,i=e.type||null,e={tabId:e.tabId,url:e.url,blockType:n,blockedDomain:t,urlType:i};o.isManifestV3Extension()?this._handleWebRequestMv3(e):this._handleWebRequest(e)}async _handleWebRequestMv3(e){await S.isAllowedDomain(e.blockedDomain)||this._handleWebRequest(e)}_handleWebRequest(n){o.getTab(n.tabId,e=>{let t=e.url;n.urlType===s.MAIN_FRAME&&(t=n.url);e=T.getQueryParamsForBlockPage(n.blockedDomain,t,n.blockType);this._config.onDomainBlocked({details:{tabId:n.tabId,url:t,queryParams:e}})})}onDownloadedCallback(e){i(e)&&a(e.domains)?o.isManifestV3Extension()?S.createDynamicRules(e.domains):S.updateWebRequestListener(e.domains,this._onBeforeWebRequest):t.error("Invalid formjack protection json payload")}}})(executionContext),(()=>{const{extensionAdapter:l,logger:n,utils:{isNil:o,isObject:s,isArray:r}}=SymBfw,{helperUtils:i,constants:a,uiConstants:t,uiConstants:{MESSAGES:E}}=NSSS;class _{static get MONITOR_EXTENSION_INSTALL_TIMEOUT(){return 18e4}static get EDGE_EXTENSIONS_PAGE_PREFIX(){return"edge://extensions/"}static get MONITOR_EXTENSION_ENABLE_TIMEOUT(){return 18e4}static get EXTENSION_STATUS(){return{NOT_INSTALLED:0,INSTALLED_DISABLED:1,INSTALLED_ENABLED:2}}static get EXTENSION_TYPE_TO_NAME_MAP(){return{[t.HOMEPAGE_EXTENSION]:"Norton Home Page",[t.DEFAULT_SEARCH_EXTENSION]:"Norton Safe Search",[t.SAFEWEB_EXTENSION]:"Norton Safe Web"}}}(NSSS=NSSS||{}).GuidedFlowsConstants=_;(NSSS=NSSS||{}).guidedFlowsManager=new class{constructor(){this.handleMessage=this.handleMessage.bind(this),this._monitorInstallation=this._monitorExtensions(l.addExtensionInstalledListener,l.removeExtensionInstalledListener),this._monitorEnable=this._monitorExtensions(l.addExtensionEnabledListener,l.removeExtensionEnabledListener)}async _monitorExtensionInstallation(e,t,n){try{await this._monitorInstallation([e],_.MONITOR_EXTENSION_INSTALL_TIMEOUT,n),t(!0)}catch(e){t(!1)}}_monitorExtensions(E,_){return function(o,s,r){return new Promise((t,e)=>{const n=setTimeout(function(){_(a),e()},s),i=(l.isManifestV3Extension()&&SymBfw.serviceWorkerKeepAlive.startKeepAliveConnection(r,s),new Set),a=e=>{o.includes(e.id)&&(i.add(e.id),i.size===o.length&&(clearTimeout(n),_(a),t()))};E(a)})}}_isHpDsExtensionId(e){const t=[...a.NORTON_HP_EXTENSION_IDS,a.NORTON_DS_EXTENSION_IDS];return e.forEach(e=>{if(!t.includes(e))return!1}),!0}_isExtensionsPageLaunched(e){return 1<e.length&&this._isHpDsExtensionId(e)?this._dsHpExtensionsPageLaunched:a.NORTON_HP_EXTENSION_IDS.includes(e[0])?this._hpExtensionPageLaunched:a.NORTON_DS_EXTENSION_IDS.includes(e[0])?this._dsExtensionPageLaunched:void 0}_setExtensionsPageLaunched(e){1<e.length&&this._isHpDsExtensionId(e)?this._dsHpExtensionsPageLaunched=!0:a.NORTON_HP_EXTENSION_IDS.includes(e[0])?this._hpExtensionPageLaunched=!0:a.NORTON_DS_EXTENSION_IDS.includes(e[0])&&(this._dsExtensionPageLaunched=!0)}_resetExtensionsLaunchedPage(){this._dsHpExtensionsPageLaunched=!1,this._hpExtensionPageLaunched=!1,this._dsExtensionPageLaunched=!1}async _handleExtensionsEnableFlow(e,t){if(!this._isExtensionsPageLaunched(e)){this._setExtensionsPageLaunched(e),await this._openExtensionsPage(e),this._resetExtensionsLaunchedPage();try{await this._monitorEnable(e,_.MONITOR_EXTENSION_ENABLE_TIMEOUT,t),this._switchFocusToPortal()}catch(e){n.debug("Extensions were not enabled before timeout")}}}async _switchFocusToPortal(){var e=await i.getLandingPage();o(e)||l.activateTab(e.id)}_getExtensionsPageQuery(e){if(1<e.length)return"Norton";var[e]=e;return a.NORTON_HP_EXTENSION_IDS.includes(e)?_.EXTENSION_TYPE_TO_NAME_MAP[t.HOMEPAGE_EXTENSION]:a.NORTON_DS_EXTENSION_IDS.includes(e)?_.EXTENSION_TYPE_TO_NAME_MAP[t.DEFAULT_SEARCH_EXTENSION]:"Norton"}async _openExtensionsPage(e){var e=_.EDGE_EXTENSIONS_PAGE_PREFIX+"?q="+this._getExtensionsPageQuery(e),t=encodeURI(e),t=await NSSS.NSSSHelper.getTabWithUrl(t);if(0<t.length)return t=t[0].id,void await NSSS.NSSSHelper.focusTab(t);l.createTab(e)}async _getExtensionsStatus(o,e){var t=o.map(e=>i.getExtensionDetails(e));const n=await Promise.all(t);e(n.reduce((e,t,n)=>{let i=_.EXTENSION_STATUS.INSTALLED_ENABLED;s(t)?t.enabled||(i=_.EXTENSION_STATUS.INSTALLED_DISABLED):i=_.EXTENSION_STATUS.NOT_INSTALLED;const a={...e};return a[o[n]]=i,a},{}))}handleMessage(e,t,n){if(!(o(e)||o(e.name)||o(n))){var i=e.name,a=n.id;switch(i){case E.EXTENSION_INSTALLATION_TRIGGERED:return o(e.extensionId)?void 0:(this._monitorExtensionInstallation(e.extensionId,t,a),!0);case E.EXTENSION_ENABLE_FLOW_TRIGGERED:if(!r(e.extensionIds))return;this._handleExtensionsEnableFlow(e.extensionIds,a);break;case E.GET_EXTENSIONS_STATUS:return r(e.extensionIds)?(this._getExtensionsStatus(e.extensionIds,t),!0):void 0}}}},l.addMessageListener(NSSS.guidedFlowsManager.handleMessage)})();