var executionContext=this;!function(_){"use strict";(_.SafeWeb=_.SafeWeb||{}).constants=(_.SymBfw,{SHASTA_URL:"https://ratings-wrs.norton.com",SHASTA_LOOKUP_PATH:"brief",DEFAULT_FULL_REPORT_URL:"https://safeweb.norton.com/report/show",HTTP_PROTOCOL:"http",HTTPS_PROTOCOL:"https",HTTPS_GET_METHOD:"GET",HTTPS_POST_METHOD:"POST",PII_SUBMISSION_TIMEOUT:2e3,SCAM_INSIGHT_BLOCK_PAGE_PATH:"content/ui/scam-insight-block-page.html",BLOCK_PAGE_PATH:"content/ui/blockedPage.html",SYMC_USER_AGENT:"X-Symc-User-Agent",X_NLOK_COUNTRY:"X-NLOK-COUNTRY",ACCEPT_HEADER:"Accept",APPLICATION_JSON:"application/json",WRS_HEADER_VALUES:{XBP_SAFEWEB:"xBP/SafeWeb",XBP_SAFEWEB_YAHOO:"xBP/SafeWeb_Yahoo",XBP_SAFEWEB_YAHOO_ADVT:"xBP/SafeWeb_Yahoo_Advt"},JAPAN_LOCALE:"ja",ROOT_NODE:{TAG_NAME:"symantec",VERSION_ATTR:"@v",CACHE_POSITIVE_ATTR:"@cacheP",CACHE_NEGATIVE_ATTR:"@cacheN"},PII_FLAGS:{EXIT_SITE:0,CONTINUE_TO_SITE:1,SUPPRESSED_DUE_TO_SILENTMODE:2,SUPPRESSED_DUE_TO_HTTPS:4},PII_SUBMISSION_STATUS:{SUCCESS:"Success",FAILURE:"Fail"},SITE_NODE:{TAG_NAME:"site",CANONICAL_SITE_ID_ATTR:"@id",COMBINED_RATING_ATTR:"@r",SECURITY_RATING_ATTR:"@sr",BUSINESS_RATING_ATTR:"@br",CATEGORY_ATTR:"@category",CACHE_ATTR:"@cache",PII_ENABLE_ATTR:"@piien",PII_POLICY_HTTPS:"@piipolhttps",PII_POLICY_ID:"@piipolid",PII_POLICY_FIELD_TYPE:"@piipolft"},WRS_RATINGS:{UNKNOWN_SITE:"u",BAD_SITE:"b",WARNING_SITE:"w",GOOD_SITE:"g",NORTON_SECURE_SITE:"r",PII_NOT_ENABLED:"n",PII_ENABLED:"y",PII_SILENCE:"s",REGIONAL_BLOCK:"grbl"},ANNOYANCE_FACTORS_KEYS:{PUAPP:!0,HRDUN:!0,JOKE:!0,MLAPP:!0,TRCKW:!0,TPSQT:!0,PPCNA:!0,HACK:!0,SPAM:!0,SWBPL:!0},PII_FACTORS_KEYS:{PIIAGE:"@age",PIIPOP:"@pop"},PII_POLICY_HTTPS_KEYS:{DONTCARE:"dc",HTTPS:"h"},IDENTITY_THREATS_KEYS:{MLWR:!0,MBCHG:!0,RMTA:!0,PHISH:!0,BDOOR:!0,ISTLR:!0,DIAL:!0,DLDR:!0,SPWR:!0},SHOPPING_RISKS_KEYS:{CTFGS:!0,RCGS:!0,REPLC:!0},COMPUTER_THREATS_KEYS:{COHD:!0,ADWR:!0,VIRUS:!0,WORM:!0,SRISK:!0,BREXP:!0,MLWR:!0,MBCHG:!0,HEUR:!0,ELTMS:!0,TRJN:!0},SITE_FACT_NODE:{TAG_NAME:"d",REPORTED_BY_KEY:"reported_by",SRC_KEY:"src",ID_KEY:"id"},SITE_FACT_IDS:{PRIVACY_POLICY_APPROVED:"privacy policy approved",NETWORK_SCANNING_SERVICE:"network scanning service",SSL_CA_NAME:"ssl CA name",AUTHORIZED_RESELLER:"Authorized Reseller",CERTIFIED_BUSINESS:"certified business",VERISIGN_TRUSTED:"VRTRU",VERISIGN_SSL:"VRSSL"},SITE_FACT_SOURCES:{SRC_BUYSAFE:"BUYSAFE",SRC_VERISIGN:"Verisign",SRC_MARK_MONITOR:"MARKMONITOR"},ATTRIBUTE_COUNT:"@cnt",CACHE_LIMIT:1e3,RATING_TYPE:{WCID_HEURISTICS:1,WCID_CHECK_URL:2,SAFEWEB:3,SCAM_INSIGHT:4},MESSAGES:{WAX_FIELDS_FOUND:"45E6BAD1-9F79-4E16-BA3A-1F77AA21EAC9",PROCESS_PAGE_FOR_SCAM_FIELDS:"FEDA41BC-73DC-4F99-A2CF-B5589CF2D0F8",TOP_FRAME_UNLOADED:"E5C199FF-A74B-414F-803C-4C7030C0E573",CAN_ANALYZE_FOR_SCAM:"6E6CDFB7-4CF6-4C73-B998-6CA3432DDC07"},IS_SCAM_INSIGHT_ENABLED:!0,performanceReporter:{COMPONENT:{SCAM_INSIGHT:"scam_insight"},TYPE:{INIT:"init",PII_PROTO_SUBMISSION:"_piiProtoSubmission",CALCULATE_SCAM_RATING:"_calculateScamInsightRating",HANDLE_PII_RATING:"_handlePIIEnabledRating",SET_WRS_RESPONSE:"setWrsResponse",HANDLE_MESSAGE:"_handleMessage",HANDLE_MESSAGE_CALLBACK:"_handleScamPageFoundCallback",HANDLE_CACHE_RESPONSE:"_handleCacheResponse",SEND_PII_SUBMISSION:"sendPIISubmission",COLLECT_PII_FIELDS:"_collectPIIFields",TOP_FRAME_UNLOADED:"topFrameUnloaded",ADD_MUTATION_OBSERVER:"_addBodyMutationObserver",FIELD_FOUND_CALLBACK:"handleFieldsFoundCallback",WAX_CONTROLLER_INITIALIZE:"scamInsightWaxControllerInitialize",CAN_ANALYZE_HANDLER_RESPONSE:"canAnalyzeForScamHandlerResponse",RUN_WAX_ANALYSIS:"_runWaxAnalysis"}},SCAM_INSIGHT_RESULT:{UNTESTED:0,SUSPICIOUS_PAGE:1,SUSPICIOUS_NO_BLOCK_PAGE:2,NOT_SUSPICIOUS_PAGE:3},SCAM_INSIGHT_RATING_KEY:"scamRating",SCAM_ANALYSIS_STATE:{PENDING:0,ANALYZE:1},YAHOO_DOMAIN:"yahoo.com",HSPART_KEY:"hspart",HSPART_VALUE:["symantec","norton"],SAFEWEB_STORAGE_CONTAINER:"safeweb_storage_container",NORMALIZED_URL_RATING_MAP:"normalized_url_rating_map",CACHED_URLS_COUNT:"cached_urls_count",VIEW_ANYWAY_CACHE:"view_anyway_cache",URLS_TO_BE_REMOVED:"urls_to_be_removed",SW_REMOVE_CACHE_ITEM_ALARM:"sw_remove_cache_item_alarm",SW_REMOVE_VIEW_ANYWAY_ALARM:"sw_remove_view_anyway_alarm",ALARM_URL_SEPARATOR:"alarm_",MINIMUM_ALARM_INTERVAL:"60000",MS_TO_MIN_CONVERSION_VALUE:6e4})}(executionContext),function(_){"use strict";(_.SafeWeb=_.SafeWeb||{}).scamInsightWaxController=function(e){const S=SymWax.main,r=e.extensionAdapter,a=SafeWeb.constants,t=SymWax.constants,N=e.utils.isntNil,E=e.utils.isNil,_=e.utils.isArray,n=e.logger,C=e.performanceReporterFactoryProxy;let R={_runWaxAnalysis:function(){var _=a.performanceReporter.TYPE.RUN_WAX_ANALYSIS+":"+Date.now();C.reportStart(a.performanceReporter.COMPONENT.SCAM_INSIGHT,_),R.arrPIIFields=[],R._bodyObserver=null,S.registerFieldsFoundCallback(R.handleFieldsFoundCallback,t.fieldFilter.type.CATEGORIZED_INPUT_FIELDS),S.registerFormsFound(()=>{});S.initWithThreshold(function(_){!0===_&&n.debug("Current frame has been accepted for Wax Analysis")}),e.utils.isTopLevelWindow()&&window.addEventListener("beforeunload",()=>{r.sendMessage({id:a.MESSAGES.TOP_FRAME_UNLOADED})},!0),C.reportEnd(a.performanceReporter.COMPONENT.SCAM_INSIGHT,_)},handleFieldsFoundCallback:function(S){if(_(S)&&!(S.length<=0)){var A,E=a.performanceReporter.TYPE.FIELD_FOUND_CALLBACK+":"+Date.now();C.reportStart(a.performanceReporter.COMPONENT.SCAM_INSIGHT,E);let _=[],e=!0;for(A in S){var I=t.fieldTypeToPIIIdentifiers[S[A].getFieldType()],T=t.fieldTypeToPIIIdentifiers[S[A].getPreGroupFieldType()];N(I)&&!_.includes(I)&&(_.push(I),R.arrPIIFields.includes(I)||(e=!1)),N(I)&&N(T)&&I!==T&&!_.includes(T)&&(_.push(T),R.arrPIIFields.includes(T)||(e=!1))}!1===e&&(R.arrPIIFields=[...new Set([...R.arrPIIFields,..._])],n.debug(R.arrPIIFields),r.sendMessage({id:a.MESSAGES.WAX_FIELDS_FOUND,data:R.arrPIIFields})),C.reportEnd(a.performanceReporter.COMPONENT.SCAM_INSIGHT,E)}},handleMessage:function(_,e,S){var A;E(_)||E(_.id)||(A=a.performanceReporter.TYPE.HANDLE_MESSAGE_CALLBACK+":"+Date.now(),C.reportStart(a.performanceReporter.COMPONENT.SCAM_INSIGHT,A),_.id===a.MESSAGES.PROCESS_PAGE_FOR_SCAM_FIELDS&&_.state===a.SCAM_ANALYSIS_STATE.ANALYZE&&R._analysisState===a.SCAM_ANALYSIS_STATE.PENDING&&(R._runWaxAnalysis(),R._analysisState=a.SCAM_ANALYSIS_STATE.ANALYZE),C.reportEnd(a.performanceReporter.COMPONENT.SCAM_INSIGHT,A))},initialize:function(){var _;SafeWeb.constants.IS_SCAM_INSIGHT_ENABLED&&(_=a.performanceReporter.TYPE.WAX_CONTROLLER_INITIALIZE+":"+Date.now(),C.reportStart(a.performanceReporter.COMPONENT.SCAM_INSIGHT,_),R._analysisState=a.SCAM_ANALYSIS_STATE.PENDING,r.addContentScriptMessageListener(R.handleMessage),r.sendMessage({id:a.MESSAGES.CAN_ANALYZE_FOR_SCAM},function(_){var e=a.performanceReporter.TYPE.CAN_ANALYZE_HANDLER_RESPONSE+":"+Date.now();C.reportStart(a.performanceReporter.COMPONENT.SCAM_INSIGHT,e),E(_)||-1===Object.values(a.SCAM_ANALYSIS_STATE).indexOf(_)||(R._analysisState=_,R._analysisState===a.SCAM_ANALYSIS_STATE.ANALYZE&&R._runWaxAnalysis(),C.reportEnd(a.performanceReporter.COMPONENT.SCAM_INSIGHT,e))}),C.reportEnd(a.performanceReporter.COMPONENT.SCAM_INSIGHT,_))}};return window.addEventListener("load",R.initialize,!0),R}(_.SymBfw)}(executionContext);