var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,a){b!=Array.prototype&&b!=Object.prototype&&(b[d]=a.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var d=0;return $jscomp.iteratorPrototype(function(){return d<b.length?{done:!1,value:b[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=b[Symbol.iterator];return d?d.call(b):$jscomp.arrayIterator(b)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(b){var d=function(){};d.prototype=b;return new d};
$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},d={};try{return d.__proto__=b,d.a}catch(a){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,d){b.__proto__=d;if(b.__proto__!==d)throw new TypeError(b+" is not extensible");return b}:null;
$jscomp.inherits=function(b,d){b.prototype=$jscomp.objectCreate(d.prototype);b.prototype.constructor=b;if($jscomp.setPrototypeOf){var a=$jscomp.setPrototypeOf;a(b,d)}else for(a in d)if("prototype"!=a)if(Object.defineProperties){var c=Object.getOwnPropertyDescriptor(d,a);c&&Object.defineProperty(b,a,c)}else b[a]=d[a];b.superClass_=d.prototype};$jscomp.arrayFromIterator=function(b){for(var d,a=[];!(d=b.next()).done;)a.push(d.value);return a};
$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.polyfill=function(b,d,a,c){if(d){a=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var e=b[c];e in a||(a[e]={});a=a[e]}b=b[b.length-1];c=a[b];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:d})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function d(){this.batch_=null}function a(a){return a instanceof e?a:new e(function(c,b){c(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var c=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(a){c(a,
0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var c=0;c<a.length;++c){var b=a[c];a[c]=null;try{b()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{a(c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){b||(b=!0,a.call(c,d))}}var c=this,b=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var c=
void 0;try{c=a.then}catch(l){this.reject_(l);return}"function"==typeof c?this.settleSameAsThenable_(c,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,c){if(0!=this.state_)throw Error("Cannot settle("+a+", "+c+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=c;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var g=new d;e.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};e.prototype.settleSameAsThenable_=function(a,c){var b=this.createResolveAndReject_();try{a.call(c,b.resolve,b.reject)}catch(n){b.reject(n)}};e.prototype.then=function(a,c){function b(a,c){return"function"==typeof a?function(c){try{d(a(c))}catch(w){k(w)}}:
c}var d,k,f=new e(function(a,c){d=a;k=c});this.callWhenSettled_(b(a,d),b(c,k));return f};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,c){function b(){switch(d.state_){case 1:a(d.result_);break;case 2:c(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?g.asyncExecute(b):this.onSettledCallbacks_.push(b)};e.resolve=a;e.reject=function(a){return new e(function(c,b){b(a)})};e.race=function(c){return new e(function(b,
d){for(var e=$jscomp.makeIterator(c),k=e.next();!k.done;k=e.next())a(k.value).callWhenSettled_(b,d)})};e.all=function(c){var b=$jscomp.makeIterator(c),d=b.next();return d.done?a([]):new e(function(c,e){function k(a){return function(b){l[a]=b;t--;0==t&&c(l)}}var l=[],t=0;do l.push(void 0),t++,a(d.value).callWhenSettled_(k(l.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(a){return Promise.resolve(b()).then(function(){return a})},function(a){return Promise.resolve(b()).then(function(){throw a;})})}},"es8","es3");
$jscomp.iteratorFromArray=function(b,d){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var a=0,c={next:function(){if(a<b.length){var e=a++;return{value:d(e,b[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.owns=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,d){for(var a=1;a<arguments.length;a++){var c=arguments[a];if(c)for(var e in c)$jscomp.owns(c,e)&&(b[e]=c[e])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");
$jscomp.polyfill("Math.imul",function(b){return b?b:function(b,a){b=Number(b);a=Number(a);var c=b&65535,d=a&65535;return c*d+((b>>>16&65535)*d+c*(a>>>16&65535)<<16>>>0)|0}},"es6","es3");$jscomp.polyfill("Math.clz32",function(b){return b?b:function(b){b=Number(b)>>>0;if(0===b)return 32;var a=0;0===(b&4294901760)&&(b<<=16,a+=16);0===(b&4278190080)&&(b<<=8,a+=8);0===(b&4026531840)&&(b<<=4,a+=4);0===(b&3221225472)&&(b<<=2,a+=2);0===(b&2147483648)&&a++;return a}},"es6","es3");
$jscomp.polyfill("Math.trunc",function(b){return b?b:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var a=Math.floor(Math.abs(b));return 0>b?-a:a}},"es6","es3");$jscomp.checkStringArgs=function(b,d,a){if(null==b)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(b,a){var c=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var d=c.length,g=b.length;a=Math.max(0,Math.min(a|0,c.length));for(var f=0;f<g&&a<d;)if(c[a++]!=b[f++])return!1;return f>=g}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},d=Object.create(new $jscomp.global.Proxy(b,{get:function(a,c,e){return a==b&&"q"==c&&e==d}}));return!0===d.q}catch(a){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(b){function d(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),d=new b([[a,2],[c,3]]);if(2!=d.get(a)||3!=d.get(c))return!1;d.delete(a);d.set(c,4);return!d.has(a)&&4==d.get(c)}catch(k){return!1}}function a(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function c(c){var b=Object[c];b&&(Object[c]=function(c){a(c);return b(c)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;
var e="$jscomp_hidden_"+Math.random();c("freeze");c("preventExtensions");c("seal");var g=0,f=function(a){this.id_=(g+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};f.prototype.set=function(c,b){a(c);if(!$jscomp.owns(c,e))throw Error("WeakMap key fail: "+c);c[e][this.id_]=b;return this};f.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};f.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};f.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return f},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function d(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=a||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=new WeakMap,c=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};c.prototype.set=function(a,c){var b=e(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=c:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:c},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};c.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};c.prototype.has=function(a){return!!e(this,a).entry};
c.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};c.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};c.prototype.keys=function(){return g(this,function(a){return a.key})};c.prototype.values=function(){return g(this,function(a){return a.value})};c.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(c,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var e=function(c,b){var d=b&&typeof b;"object"==
d||"function"==d?a.has(b)?d=a.get(b):(d=""+ ++h,a.set(b,d)):d="p_"+b;var e=c.data_[d];if(e&&$jscomp.owns(c.data_,d))for(c=0;c<e.length;c++){var f=e[c];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:c,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},g=function(a,c){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return c},"es6","es3");
$jscomp.polyfill("Set",function(b){function d(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new b($jscomp.makeIterator([a]));if(!d.has(a)||1!=d.size||d.add(a)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var g=d.entries(),f=g.next();if(f.done||f.value[0]!=a||f.value[1]!=a)return!1;f=g.next();return f.done||f.value[0]==a||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:g.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(d())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)this.add(c.value)}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();
this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return a},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,a){return[b,a]})}},"es6","es3");$jscomp.polyfill("Object.entries",function(b){return b?b:function(b){var a=[],c;for(c in b)$jscomp.owns(b,c)&&a.push([c,b[c]]);return a}},"es8","es3");$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,a){return a})}},"es8","es3");
$jscomp.findInternal=function(b,d,a){b instanceof String&&(b=String(b));for(var c=b.length,e=0;e<c;e++){var g=b[e];if(d.call(a,g,e,b))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).i}},"es6","es3");$jscomp.polyfill("Object.values",function(b){return b?b:function(b){var a=[],c;for(c in b)$jscomp.owns(b,c)&&a.push(b[c]);return a}},"es8","es3");
$jscomp.polyfill("Object.is",function(b){return b?b:function(b,a){return b===a?0!==b||1/b===1/a:b!==b&&a!==a}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(b,a){var c=this;c instanceof String&&(c=String(c));var d=c.length;a=a||0;for(0>a&&(a=Math.max(a+d,0));a<d;a++){var g=c[a];if(g===b||Object.is(g,b))return!0}return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(b,a){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,a||0)}},"es6","es3");
(function(b){b=b.XNE=b.XNE||{};var d={WASM_BINARY:"ndcxapi.wasm"};d.NATIVE_APP_IDS=Object.freeze(["com.symantec.xndc_oob"]);d.CONTENTDB="xndcweb.db";d.CONTENT_STORE_NAME="content";d.WEBPULSE_URL="https://shasta-ors.norton.com/webpulse";d.MAX_HEAP=65536;d.MAX_EVENTS_PER_ALERT=32;d.CONTRACT_EXPIRY=1E3;d.WEBCONF_RESPONSE_TIMEOUT=5E3;d.CACHE_LIMIT=1E3;d.CACHE_TTL=86400;d.EXCLUSION_TTL=1800;d.EXCLUSION_LIMIT=540;d.POLL_FREQUENCY=Object.freeze({MIN:600,MAX:86400});d.TRUSTED_DOMAINS=Object.freeze(["google-analytics.com",
"norton.com","symantec.com","nortoncdn.com"]);d.reputation=Object.freeze({URL_HIGH_RISK:7,URL_MED_RISK:5,URL_LOW_RISK:1});d.msgType=Object.freeze({URL_REPUTATION:1,HTTP_HDR_SCANNER:2,DOWNLOAD_EVENT:3,OTHER:4});d.recommendation=Object.freeze({BLOCK_PAGE:"Block",ALERT_AND_LOG:"AlertAndLog",SILENT_NO_LOG:"SilentNoLog",SILENT_AND_LOG:"SilentAndLog",REDIRECT_PAGE:"Redirect",APPLY_CSP:"ApplyCSP",CANCEL:"Cancel",ALLOW:"Allow"});d.CLOUDLOOKUP_SIG_ID=60501;d.buildVersion="1.0.0";d.engineVersion="8.3.0";d.engineSigVersion=
"20180316.1";d.engineName="xNDC.Web";d.telemetry={CATEGORY:{URLREPUTATION:"xNDC.Web.URLReputation",SCANNER:"xNDC.Web.Scanner",FEATURES:"xNDC.Web.Feature",REMOTECONF:"xNDC.Web.RemoteConfigs"},ACTIONTYPE:{SCANNER:{SIGID:"SigId"},URLREPUTATION:{INVALIDURL:"InvalidURL",REPUTATION:"Reputation",REDIRECTION:"SafePageRedirection"},PERFORMANCE:"Performance",ALERT:"Alert",LOGGER:"Logger"},LABEL:{FEATURES:{TELEMETRY:"Telemetry",NDCSCANNER:"Scanning",AUTOPAGEBLOCK:"AutoPageBlock",AUTOREDIRECT:"AutoRedirect",
AUTOJSBLOCK:"AutoJSBlock",URLQUERY:"UrlQuery",NATIVEMESSAGING:"NativeMessaging",GOOGANALYTICS:"GoogleAnalyticsTelemetry",ASYNCSCAN:"AsyncScan",NATIVEAPP:"NativeApp",CFGSRVR:"ConfigSyncControl"},EXCEPTIONS:{INVALIDURL:"InvalidURL",URLLOOKUPFAILURE:"URLLookupFailure",WASMCOMMFAILURE:"WasmCommunicationFailure",UPDATE:"ExtensionUpdateFailure",INVALIDBROWSEROBJ:"InvalidBrowserObj",INVALIDEXTCALLBACK:"InvalidExtensionCallback"},EXCLUSION:"Exclusion"}};d.status=Object.freeze({STATUS_OK:0,scanner:{ERR_WASM_NOT_INIT:-90042,
ERR_NULL_PARAM:-90043,ERR_INVALID_PARAM:-90044,ERR_PARAM_EMPTY:-90045,ERR_CONTENT_UPDATE_FAILURE:-90046}});d.URL_EXCLUSION_STORE_NAME="urlexclusions";b.constants=d})(this);(function(b){b.XNE.constants.ENGINE_VERSION="1.4.0.50"})(this);(function(b){b.XNE.constants.configServerPKU="\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwnkLjDQGM8MSyG7swN8V\non9QPcNHDwXTlsSgQ5eSQ2ZqY0yjgKYIM8yoKSKb9uIajKZCp4atflZXtY5u168B\nGWRfcJnOWBRv/wO0t9Gk4dj+tNng18T1bYNBoJt3a1YTcDM+yPEXnlinJu4vqU9r\nDBmCyUMTR9/fm5tqSL4cLL0PH5hxExEPMWuRg0Ra7xFKrrgOdA59qxIPOqGcOcdd\nOJrzNiSlBcNgnbKaBs3X7zuLnb0bOhkXhfq+gzIhuBX5XffC1wzhgQwAjhTQSBo1\nA9VfRRsR/JDRWl2nKYck6hDvm8e1/gHnKKupTW5qG2KEFNxFMlCzexfQrJH2BwKn\nvwIDAQAB\n-----END PUBLIC KEY-----\n"})(this);(function(b){(b.XNE=b.XNE||{}).common=function(b){var a=b.logger,c=b.utils.isNil,d=b.utils.isntNil,g=XNE.constants,f={JSScope:function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if("JSScope"===this.constructor.name)throw Error("Cannot instantiate this class");if(a&&"function"!=typeof a)throw Error("executor must be callable");this.args=c;a=a||function(){};d=$jscomp.makeIterator([(this[this.constructor.name]||function(){}).bind(this),(this["~"+this.constructor.name]||function(){}).bind(this)]);
c=d.next().value;d=d.next().value;c();try{a.bind(this)()}catch(v){f.logging.GetLogger("COMMON").debug("JSScopeExecuteException: "+v)}finally{d()}},hash:{SHA256:function(a){return a?forge.md.sha256.create().update(a).digest().toHex():null}}},h=function(a,b,c){function e(a){for(var b=0;b<arguments.length;++b);r=!0;b=$jscomp.makeIterator(g);for(var c=b.next();!c.done;c=b.next())c=c.value,c(this._options)}var k=this;this._options=b=void 0===b?{}:b;var f=null,g=[],r=!1,u=null;e=e.bind(this);if(a instanceof
Promise)u=a,c.push(e);else if("function"===typeof a)u=new Promise(function(b,c){try{a(b,c)}catch(A){c(A)}finally{k._options.hasOwnProperty("expiry")&&0<k._options.expiry&&(f=setTimeout(function(a){c(Error("Contract expired"));e(a)},k._options.expiry,k._options))}}),u.then(function(){d(f)&&clearTimeout(f)},function(){d(f)&&clearTimeout(f)});else throw Error("Contract must be constructed with a Promise object or an executor function");this.then=function(a,b){return new h(u.then(void 0===a?null:a,void 0===
b?null:b),this._options,g)};this.catch=function(a){return new h(u.catch(void 0===a?null:a),this._options,g)};this.finally=function(a){return new h(u.finally(void 0===a?null:a),this._options,g)};this.expires=function(a){var b=this;"function"===typeof a&&this.then(function(){r&&a(b._options)},function(){r&&a(b._options)});return this}};h.resolve=function(a){return new h(Promise.resolve(a),{},[])};h.reject=function(a){return new h(Promise.reject(a),{},[])};h.all=function(a){return new h(Promise.all(a),
{},[])};h.race=function(a){return new h(Promise.race(a),{},[])};var l=function(a,b,c){c=void 0===c?{}:c;this.status=a;this.tabId=void 0===b?null:b;this.optional=c;this.recommendation=this.type=null};l.prototype.Set=function(a,b){b=void 0===b?null:b;d(b)&&(this.recommendation=b);"number"==typeof a?(this.type=g.msgType.URL_REPUTATION,b="reputation"):Array.isArray(a)||a instanceof Uint32Array?(this.type=g.msgType.HTTP_HDR_SCANNER,b="sigIds"):(this.type=g.msgType.OTHER,b="payload");Object.defineProperty(this,
b,{value:a,enumerable:!0});return this};l.prototype.SetOptional=function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),c=b.next();!c.done;c=b.next())c=c.value,this.optional[c]=a[c];return this};l.prototype.SetTabId=function(a){this.tabId=a;return this};l.prototype.SetRecommendation=function(a){this.recommendation=a;return this};var n=function(b,c){b=void 0===b?g.CACHE_LIMIT:b;c=void 0===c?g.CACHE_TTL:c;if(!n.instance){if("number"!==typeof b||"number"!==typeof c)throw"Paramter is not a number";
this.maxEntries=b;this.ttl=c;var d=function(b){var c={length:0};return{Insert:function(d,e,t){t=void 0===t?null:t;if(!d)return a.error("[xNDC.Web Error]: _cache::Insert: Null key"),!1;if(!(d in c)){if(c.length>=b.maxEntries)return a.error("[xNDC.Web Error]: Cache capacity maxed out at "+b.maxEntries+" entries"),!1;c.length++}c[d]=e;a.debug("Cache insert: "+d+" => "+e);e=t?t:b.ttl?b.ttl:0;0<b.ttl&&setTimeout(function(){d in c&&(delete c[d],c.length--)},1E3*e);return!0},Remove:function(b){if(b&&b in
c)return a.debug("Cache remove: "+b),delete c[b],c.length--,!0;a.debug("Cache remove: Entry not found: "+b);return!1},Size:function(){return c.length},Clear:function(){c={length:0}},Get:function(a){return a in c?c[a]:null}}}(this);this.InsertVolatile=this.Insert=d.Insert;this.Remove=d.Remove;this.Clear=d.Clear;this.GetEx=d.Get;this.Get=function(a){a=d.Get(a);return a instanceof Promise||a instanceof h?null:a};this.Size=d.Size;Object.defineProperty(n,"instance",{value:this,writable:!1})}return n.instance};
f.Contract=h;f.GenericResult=l;f.Cache=n;f.ParsedUrl=function(a){var b=new URL(a);b.directory=b.protocol+"//"+b.host+b.pathname.substr(0,b.pathname.lastIndexOf("/"));b.path=b.protocol+"//"+b.host+b.pathname;b.HostHash=function(){return f.hash.SHA256(b.host)};b.DirectoryHash=function(){return f.hash.SHA256(b.directory)};b.PathHash=function(){return f.hash.SHA256(b.path)};return b};f.Poller=function(a,b,c,d){d=void 0===d?{}:d;if("function"!==typeof a)throw Error("Argument must be callable");if("function"!==
typeof b&&"number"!==typeof b)throw Error("Invalid frequency type <"+typeof b+"> while creating PollingSchedule: "+b);if(c&&!Array.isArray(c))throw Error("Parameters must be Array or undefined");var e=b,t=!1,k=null,f=null;Object.defineProperty(this,"frequency",{get:function(){return"function"==typeof e?e():e},set:function(a){e="function"==typeof a||"number"==typeof a?a:e}});Object.defineProperty(this,"scheduled",{get:function(){return t},set:function(a){}});Object.defineProperty(this,"lastRunAt",
{get:function(){return f},set:function(a){}});Object.defineProperty(this,"poller",{value:a,writable:!1});Object.defineProperty(this,"params",{value:c,writable:!1});d.hasOwnProperty("name")&&Object.defineProperty(this,"name",{value:d.name,writable:!1});d.hasOwnProperty("description")&&Object.defineProperty(this,"description",{value:d.description,writable:!1});d.hasOwnProperty("delayedStart")&&Object.defineProperty(this,"delayedStart",{value:d.delayedStart,writable:!1});this.Run=function(){var a=this;
if(!this.scheduled){var b=function(){function c(a){a<g.POLL_FREQUENCY.MIN||a>g.POLL_FREQUENCY.MAX||(k=setTimeout(b,1E3*a),t=!0)}t=!1;k=null;try{var d=a.poller.apply(null,a.params);f=Date.now();d instanceof Promise||d instanceof h?d.then(function(){c(a.frequency)}):c(a.frequency)}catch(z){}};1==this.delayedStart?setTimeout(b,1E3*this.frequency):b()}};this.Stop=function(){t&&k&&(clearTimeout(k),t=!1)}};f.InitResult=function(a,b,c){if((c=void 0===c?null:c)&&"function"!==typeof c)throw Error("Receiver must be callable");
Object.assign(this,a);this.SetupPrivilegeAccess=function(a){this.SetupPrivilegeAccess=function(){};c&&(a instanceof Promise?a.then(c):c(a));return b}};f.FlatPromise=function(){var a=this;this.promise=new Promise(function(b,c){a.resolve=b;a.reject=c})};f.JWTVerify=function(a,b){if(!a.hasOwnProperty("JWT"))throw XNE.common.logging.GetLogger("COMMON").error("[xNDC.Web Error]: JWT::Invalid payload"),Error("JWT::invalid payload");if(!0!==KJUR.jws.JWS.verify(a.JWT,KEYUTIL.getKey(b),["RS256"]))throw XNE.common.logging.GetLogger("COMMON").error("[xNDC.Web Error]: JWT verification failure"),
Error("JWT::verification failure");if(KJUR.jws.JWS.readSafeJSONString(b64utoutf8(a.JWT.split(".")[1])).hash!==forge.md.sha256.create().update(JSON.stringify(a.payload)).digest().toHex())throw XNE.common.logging.GetLogger("COMMON").error("[xNDC.Web Error]: Payload hash mismatch"),Error("JWT::payload hash mismatch");};f.notify=function(a){setTimeout(function(a){try{XNE.config.Get("notificationCallback")(a)}catch(m){XNE.common.logging.GetLogger("COMMON").debug("Exception while notification : "+m)}},
0,a)};f.logging={GetLogger:function(){return b.logger},SuppressModules:function(){},YieldModules:function(){},GetModules:function(){},Status:function(){}};f.perf={Start:function(){},End:function(){}};f.url={isValid:function(a,b){b=void 0===b?null:b;if(c(a))return!1;try{var d=new URL(a);if(0===d.hostname.length||0===d.protocol.length)return!1;if("function"===typeof b)return b(d)}catch(t){return!1}return!0},isValidHttp:function(a){return f.url.isValid(a,function(a){return"http:"===a.protocol||"https:"===
a.protocol})},PIIClean:function(a){if(f.url.isValidHttp(a)){var b=a.indexOf("?");return a.substring(0,-1!=b?b:a.length)}return null}};return f}(b.SymBfw)})(this);var Module;Module||(Module="undefined"!==typeof Module?Module:{});var moduleOverrides={},key;for(key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);Module.arguments=[];Module.thisProgram="./this.program";Module.quit=function(b,d){throw d;};Module.preRun=[];Module.postRun=[];var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1;
if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else if("SHELL"===Module.ENVIRONMENT)ENVIRONMENT_IS_SHELL=!0;else throw Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");else ENVIRONMENT_IS_WEB="object"===typeof window,ENVIRONMENT_IS_WORKER="function"===typeof importScripts,ENVIRONMENT_IS_NODE="object"===typeof process&&
"function"===typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;
if(ENVIRONMENT_IS_NODE){var nodeFS,nodePath;Module.read=function(b,d){nodeFS||(nodeFS=require("fs"));nodePath||(nodePath=require("path"));b=nodePath.normalize(b);b=nodeFS.readFileSync(b);return d?b:b.toString()};Module.readBinary=function(b){b=Module.read(b,!0);b.buffer||(b=new Uint8Array(b));assert(b.buffer);return b};1<process.argv.length&&(Module.thisProgram=process.argv[1].replace(/\\/g,"/"));Module.arguments=process.argv.slice(2);"undefined"!==typeof module&&(module.exports=Module);process.on("uncaughtException",
function(b){if(!(b instanceof ExitStatus))throw b;});process.on("unhandledRejection",function(b,d){process.exit(1)});Module.inspect=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL)"undefined"!=typeof read&&(Module.read=function(b){return read(b)}),Module.readBinary=function(b){if("function"===typeof readbuffer)return new Uint8Array(readbuffer(b));b=read(b,"binary");assert("object"===typeof b);return b},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:"undefined"!=
typeof arguments&&(Module.arguments=arguments),"function"===typeof quit&&(Module.quit=function(b,d){quit(b)});else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)Module.read=function(b){var d=new XMLHttpRequest;d.open("GET",b,!1);d.send(null);return d.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(b){var d=new XMLHttpRequest;d.open("GET",b,!1);d.responseType="arraybuffer";d.send(null);return new Uint8Array(d.response)}),Module.readAsync=function(b,d,a){var c=new XMLHttpRequest;c.open("GET",
b,!0);c.responseType="arraybuffer";c.onload=function(){200==c.status||0==c.status&&c.response?d(c.response):a()};c.onerror=a;c.send(null)},"undefined"!=typeof arguments&&(Module.arguments=arguments),Module.setWindowTitle=function(b){document.title=b};Module.print="undefined"!==typeof console?console.log:"undefined"!==typeof print?print:null;Module.printErr="undefined"!==typeof printErr?printErr:"undefined"!==typeof console&&console.warn||Module.print;Module.print=Module.print;Module.printErr=Module.printErr;
for(key in moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var STACK_ALIGN=16;function staticAlloc(b){assert(!staticSealed);var d=STATICTOP;STATICTOP=STATICTOP+b+15&-16;return d}function dynamicAlloc(b){assert(DYNAMICTOP_PTR);var d=HEAP32[DYNAMICTOP_PTR>>2];b=d+b+15&-16;HEAP32[DYNAMICTOP_PTR>>2]=b;return b>=TOTAL_MEMORY&&!enlargeMemory()?(HEAP32[DYNAMICTOP_PTR>>2]=d,0):d}
function alignMemory(b,d){d||(d=STACK_ALIGN);return Math.ceil(b/d)*d}function getNativeTypeSize(b){switch(b){case "i1":case "i8":return 1;case "i16":return 2;case "i32":return 4;case "i64":return 8;case "float":return 4;case "double":return 8;default:return"*"===b[b.length-1]?4:"i"===b[0]?(b=parseInt(b.substr(1)),assert(0===b%8),b/8):0}}var functionPointers=Array(20);
function addFunction(b){for(var d=0;d<functionPointers.length;d++)if(!functionPointers[d])return functionPointers[d]=b,1+d;throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS.";}var GLOBAL_BASE=1024,ABORT=0,EXITSTATUS=0;function assert(b,d){b||abort("Assertion failed: "+d)}
function setValue(b,d,a,c){a=a||"i8";"*"===a.charAt(a.length-1)&&(a="i32");switch(a){case "i1":HEAP8[b>>0]=d;break;case "i8":HEAP8[b>>0]=d;break;case "i16":HEAP16[b>>1]=d;break;case "i32":HEAP32[b>>2]=d;break;case "i64":tempI64=[d>>>0,(tempDouble=d,1<=+Math_abs(tempDouble)?0<tempDouble?(Math_min(+Math_floor(tempDouble/4294967296),4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[b>>2]=tempI64[0];HEAP32[b+4>>2]=tempI64[1];break;case "float":HEAPF32[b>>2]=d;
break;case "double":HEAPF64[b>>3]=d;break;default:abort("invalid type for setValue: "+a)}}var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;
function allocate(b,d,a,c){if("number"===typeof b){var e=!0;var g=b}else e=!1,g=b.length;var f="string"===typeof d?d:null;a=a==ALLOC_NONE?c:["function"===typeof _malloc?_malloc:staticAlloc,stackAlloc,staticAlloc,dynamicAlloc][void 0===a?ALLOC_STATIC:a](Math.max(g,f?1:d.length));if(e){c=a;assert(0==(a&3));for(b=a+(g&-4);c<b;c+=4)HEAP32[c>>2]=0;for(b=a+g;c<b;)HEAP8[c++>>0]=0;return a}if("i8"===f)return b.subarray||b.slice?HEAPU8.set(b,a):HEAPU8.set(new Uint8Array(b),a),a;c=0;for(var h,l;c<g;){var n=
b[c];e=f||d[c];0===e?c++:("i64"==e&&(e="i32"),setValue(a+c,n,e),l!==e&&(h=getNativeTypeSize(e),l=e),c+=h)}return a}function Pointer_stringify(b,d){if(0===d||!b)return"";for(var a=0,c,e=0;;){c=HEAPU8[b+e>>0];a|=c;if(0==c&&!d)break;e++;if(d&&e==d)break}d||(d=e);c="";if(128>a){for(;0<d;)a=String.fromCharCode.apply(String,HEAPU8.subarray(b,b+Math.min(d,1024))),c=c?c+a:a,b+=1024,d-=1024;return c}return UTF8ToString(b)}var UTF8Decoder="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;
function UTF8ArrayToString(b,d){for(var a=d;b[a];)++a;if(16<a-d&&b.subarray&&UTF8Decoder)return UTF8Decoder.decode(b.subarray(d,a));for(a="";;){var c=b[d++];if(!c)return a;if(c&128){var e=b[d++]&63;if(192==(c&224))a+=String.fromCharCode((c&31)<<6|e);else{var g=b[d++]&63;if(224==(c&240))c=(c&15)<<12|e<<6|g;else{var f=b[d++]&63;if(240==(c&248))c=(c&7)<<18|e<<12|g<<6|f;else{var h=b[d++]&63;if(248==(c&252))c=(c&3)<<24|e<<18|g<<12|f<<6|h;else{var l=b[d++]&63;c=(c&1)<<30|e<<24|g<<18|f<<12|h<<6|l}}}65536>
c?a+=String.fromCharCode(c):(c-=65536,a+=String.fromCharCode(55296|c>>10,56320|c&1023))}}else a+=String.fromCharCode(c)}}function UTF8ToString(b){return UTF8ArrayToString(HEAPU8,b)}
function stringToUTF8Array(b,d,a,c){if(!(0<c))return 0;var e=a;c=a+c-1;for(var g=0;g<b.length;++g){var f=b.charCodeAt(g);55296<=f&&57343>=f&&(f=65536+((f&1023)<<10)|b.charCodeAt(++g)&1023);if(127>=f){if(a>=c)break;d[a++]=f}else{if(2047>=f){if(a+1>=c)break;d[a++]=192|f>>6}else{if(65535>=f){if(a+2>=c)break;d[a++]=224|f>>12}else{if(2097151>=f){if(a+3>=c)break;d[a++]=240|f>>18}else{if(67108863>=f){if(a+4>=c)break;d[a++]=248|f>>24}else{if(a+5>=c)break;d[a++]=252|f>>30;d[a++]=128|f>>24&63}d[a++]=128|f>>
18&63}d[a++]=128|f>>12&63}d[a++]=128|f>>6&63}d[a++]=128|f&63}}d[a]=0;return a-e}function stringToUTF8(b,d,a){return stringToUTF8Array(b,HEAPU8,d,a)}function lengthBytesUTF8(b){for(var d=0,a=0;a<b.length;++a){var c=b.charCodeAt(a);55296<=c&&57343>=c&&(c=65536+((c&1023)<<10)|b.charCodeAt(++a)&1023);127>=c?++d:d=2047>=c?d+2:65535>=c?d+3:2097151>=c?d+4:67108863>=c?d+5:d+6}return d}var UTF16Decoder="undefined"!==typeof TextDecoder?new TextDecoder("utf-16le"):void 0;
function allocateUTF8(b){var d=lengthBytesUTF8(b)+1,a=_malloc(d);a&&stringToUTF8Array(b,HEAP8,a,d);return a}var WASM_PAGE_SIZE=65536,ASMJS_PAGE_SIZE=16777216;function alignUp(b,d){0<b%d&&(b+=d-b%d);return b}var buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateGlobalBuffer(b){Module.buffer=buffer=b}
function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer);Module.HEAP16=HEAP16=new Int16Array(buffer);Module.HEAP32=HEAP32=new Int32Array(buffer);Module.HEAPU8=HEAPU8=new Uint8Array(buffer);Module.HEAPU16=HEAPU16=new Uint16Array(buffer);Module.HEAPU32=HEAPU32=new Uint32Array(buffer);Module.HEAPF32=HEAPF32=new Float32Array(buffer);Module.HEAPF64=HEAPF64=new Float64Array(buffer)}var STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR;
STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0;staticSealed=!1;function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}
function enlargeMemory(){abortOnCannotGrowMemory()}var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||67108864;TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")");
Module.buffer?buffer=Module.buffer:("object"===typeof WebAssembly&&"function"===typeof WebAssembly.Memory?(Module.wasmMemory=new WebAssembly.Memory({initial:TOTAL_MEMORY/WASM_PAGE_SIZE,maximum:TOTAL_MEMORY/WASM_PAGE_SIZE}),buffer=Module.wasmMemory.buffer):buffer=new ArrayBuffer(TOTAL_MEMORY),Module.buffer=buffer);updateGlobalBufferViews();function getTotalMemory(){return TOTAL_MEMORY}HEAP32[0]=1668509029;HEAP16[1]=25459;
if(115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(b){for(;0<b.length;){var d=b.shift();if("function"==typeof d)d();else{var a=d.func;"number"===typeof a?void 0===d.arg?Module.dynCall_v(a):Module.dynCall_vi(a,d.arg):a(void 0===d.arg?null:d.arg)}}}var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;
function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__);runtimeExited=!0}
function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(b){__ATPRERUN__.unshift(b)}function addOnPostRun(b){__ATPOSTRUN__.unshift(b)}function writeArrayToMemory(b,d){HEAP8.set(b,d)}function writeAsciiToMemory(b,d,a){for(var c=0;c<b.length;++c)HEAP8[d++>>0]=b.charCodeAt(c);a||(HEAP8[d>>0]=0)}
var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_max=Math.max,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;
function addRunDependency(b){runDependencies++;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(b){runDependencies--;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies);0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled&&(b=dependenciesFulfilled,dependenciesFulfilled=null,b()))}Module.preloadedImages={};Module.preloadedAudios={};
var dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(b){return String.prototype.startsWith?b.startsWith(dataURIPrefix):0===b.indexOf(dataURIPrefix)}
function integrateWasmJS(){function b(){try{if(Module.wasmBinary)return new Uint8Array(Module.wasmBinary);if(Module.readBinary)return Module.readBinary(e);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)";}catch(k){abort(k)}}function d(){return Module.wasmBinary||!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER||"function"!==typeof fetch?new Promise(function(a,c){a(b())}):fetch(e,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+
e+"'";return a.arrayBuffer()}).catch(function(){return b()})}function a(a,b,c){function t(a,b){h=a.exports;h.memory&&(a=h.memory,b=Module.buffer,a.byteLength<b.byteLength&&Module.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),b=new Int8Array(b),(new Int8Array(a)).set(b),updateGlobalBuffer(a),updateGlobalBufferViews());Module.asm=h;Module.usingWasm=!0;removeRunDependency("wasm-instantiate")}function k(a){t(a.instance,a.module)}
function g(a){d().then(function(a){return WebAssembly.instantiate(a,f)}).then(a).catch(function(a){Module.printErr("failed to asynchronously prepare wasm: "+a);abort(a)})}if("object"!==typeof WebAssembly)return Module.printErr("no native wasm support detected"),!1;if(!(Module.wasmMemory instanceof WebAssembly.Memory))return Module.printErr("no native wasm Memory in use"),!1;b.memory=Module.wasmMemory;f.global={NaN:NaN,Infinity:Infinity};f["global.Math"]=Math;f.env=b;addRunDependency("wasm-instantiate");
if(Module.instantiateWasm)try{return Module.instantiateWasm(f,t)}catch(y){return Module.printErr("Module.instantiateWasm callback failed with error: "+y),!1}Module.wasmBinary||"function"!==typeof WebAssembly.instantiateStreaming||isDataURI(e)||"function"!==typeof fetch?g(k):WebAssembly.instantiateStreaming(fetch(e,{credentials:"same-origin"}),f).then(k).catch(function(a){Module.printErr("wasm streaming compile failed: "+a);Module.printErr("falling back to ArrayBuffer instantiation");g(k)});return{}}
var c="ndcxapi.wast",e="ndcxapi.wasm",g="ndcxapi.temp.asm.js";"function"===typeof Module.locateFile&&(isDataURI(c)||(c=Module.locateFile(c)),isDataURI(e)||(e=Module.locateFile(e)),isDataURI(g)||(g=Module.locateFile(g)));var f={global:null,env:null,asm2wasm:{"f64-rem":function(a,b){return a%b},"debugger":function(){debugger}},parent:Module},h=null;Module.asmPreload=Module.asm;var l=Module.reallocBuffer;Module.reallocBuffer=function(a){if("asmjs"===n)var b=l(a);else a:{a=alignUp(a,Module.usingWasm?
WASM_PAGE_SIZE:ASMJS_PAGE_SIZE);var c=Module.buffer.byteLength;if(Module.usingWasm)try{b=-1!==Module.wasmMemory.grow((a-c)/65536)?Module.buffer=Module.wasmMemory.buffer:null;break a}catch(t){b=null;break a}b=void 0}return b};var n="";Module.asm=function(b,c,d){if(!c.table){var e=Module.wasmTableSize;void 0===e&&(e=1024);var k=Module.wasmMaxTableSize;c.table="object"===typeof WebAssembly&&"function"===typeof WebAssembly.Table?void 0!==k?new WebAssembly.Table({initial:e,maximum:k,element:"anyfunc"}):
new WebAssembly.Table({initial:e,element:"anyfunc"}):Array(e);Module.wasmTable=c.table}c.memoryBase||(c.memoryBase=Module.STATIC_BASE);c.tableBase||(c.tableBase=0);(b=a(b,c,d))||abort("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods");return b}}integrateWasmJS();STATIC_BASE=GLOBAL_BASE;STATICTOP=STATIC_BASE+1009360;
__ATINIT__.push({func:function(){__GLOBAL__I_000101()}},{func:function(){__GLOBAL__sub_I_ndcxapi_cpp()}},{func:function(){__GLOBAL__sub_I_iostream_cpp()}});var STATIC_BUMP=1009360;Module.STATIC_BASE=STATIC_BASE;Module.STATIC_BUMP=STATIC_BUMP;STATICTOP+=16;function ___cxa_allocate_exception(b){return _malloc(b)}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}
var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(b){if(!b||EXCEPTIONS.infos[b])return b;for(var d in EXCEPTIONS.infos)if(EXCEPTIONS.infos[d].adjusted===b)return d;return b},addRef:function(b){b&&EXCEPTIONS.infos[b].refcount++},decRef:function(b){if(b){var d=EXCEPTIONS.infos[b];assert(0<d.refcount);d.refcount--;0!==d.refcount||d.rethrown||(d.destructor&&Module.dynCall_vi(d.destructor,b),delete EXCEPTIONS.infos[b],___cxa_free_exception(b))}},clearRef:function(b){b&&(EXCEPTIONS.infos[b].refcount=
0)}};function ___cxa_throw(b,d,a){EXCEPTIONS.infos[b]={ptr:b,adjusted:b,type:d,destructor:a,refcount:0,caught:!1,rethrown:!1};EXCEPTIONS.last=b;"uncaught_exception"in __ZSt18uncaught_exceptionv?__ZSt18uncaught_exceptionv.uncaught_exception++:__ZSt18uncaught_exceptionv.uncaught_exception=1;throw b+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch.";}function ___lock(){}
var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,
ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,
ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};
function ___setErrNo(b){Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=b);return b}function ___map_file(b,d){___setErrNo(ERRNO_CODES.EPERM);return-1}var SYSCALLS={varargs:0,get:function(b){SYSCALLS.varargs+=4;return HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var b=SYSCALLS.get(),d=SYSCALLS.get();0<=b?assert(0===d):assert(-1===d);return b},getZero:function(){assert(0===SYSCALLS.get())}};
function ___syscall140(b,d){SYSCALLS.varargs=d;try{var a=SYSCALLS.getStreamFromFD();SYSCALLS.get();var c=SYSCALLS.get(),e=SYSCALLS.get(),g=SYSCALLS.get();FS.llseek(a,c,g);HEAP32[e>>2]=a.position;a.getdents&&0===c&&0===g&&(a.getdents=null);return 0}catch(f){return"undefined"!==typeof FS&&f instanceof FS.ErrnoError||abort(f),-f.errno}}
function ___syscall145(b,d){SYSCALLS.varargs=d;try{var a=SYSCALLS.getStreamFromFD(),c=SYSCALLS.get(),e=SYSCALLS.get();return SYSCALLS.doReadv(a,c,e)}catch(g){return"undefined"!==typeof FS&&g instanceof FS.ErrnoError||abort(g),-g.errno}}
function ___syscall146(b,d){SYSCALLS.varargs=d;try{var a=SYSCALLS.get(),c=SYSCALLS.get(),e=SYSCALLS.get();b=0;___syscall146.buffers||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(a,b){var c=___syscall146.buffers[a];assert(c);0===b||10===b?((1===a?Module.print:Module.printErr)(UTF8ArrayToString(c,0)),c.length=0):c.push(b)});for(d=0;d<e;d++){for(var g=HEAP32[c+8*d>>2],f=HEAP32[c+(8*d+4)>>2],h=0;h<f;h++)___syscall146.printChar(a,HEAPU8[g+h]);b+=f}return b}catch(l){return"undefined"!==
typeof FS&&l instanceof FS.ErrnoError||abort(l),-l.errno}}function ___syscall54(b,d){SYSCALLS.varargs=d;return 0}function ___syscall6(b,d){SYSCALLS.varargs=d;try{var a=SYSCALLS.getStreamFromFD();FS.close(a);return 0}catch(c){return"undefined"!==typeof FS&&c instanceof FS.ErrnoError||abort(c),-c.errno}}
function ___syscall91(b,d){SYSCALLS.varargs=d;try{var a=SYSCALLS.get(),c=SYSCALLS.get(),e=SYSCALLS.mappings[a];if(!e)return 0;if(c===e.len){var g=FS.getStream(e.fd);SYSCALLS.doMsync(a,g,c,e.flags);FS.munmap(g);SYSCALLS.mappings[a]=null;e.allocated&&_free(e.malloc)}return 0}catch(f){return"undefined"!==typeof FS&&f instanceof FS.ErrnoError||abort(f),-f.errno}}function ___unlock(){}function _abort(){Module.abort()}var _environ=STATICTOP;STATICTOP+=16;
function ___buildEnvironment(b){if(___buildEnvironment.called){var d=HEAP32[_environ>>2];var a=HEAP32[d>>2]}else ___buildEnvironment.called=!0,ENV.USER=ENV.LOGNAME="web_user",ENV.PATH="/",ENV.PWD="/",ENV.HOME="/home/web_user",ENV.LANG="C.UTF-8",ENV._=Module.thisProgram,a=staticAlloc(1024),d=staticAlloc(256),HEAP32[d>>2]=a,HEAP32[_environ>>2]=d;var c=[],e=0,g;for(g in b)if("string"===typeof b[g]){var f=g+"="+b[g];c.push(f);e+=f.length}if(1024<e)throw Error("Environment size exceeded TOTAL_ENV_SIZE!");
for(b=0;b<c.length;b++)f=c[b],writeAsciiToMemory(f,a),HEAP32[d+4*b>>2]=a,a+=f.length+1;HEAP32[d+4*c.length>>2]=0}var ENV={};function _getenv(b){if(0===b)return 0;b=Pointer_stringify(b);if(!ENV.hasOwnProperty(b))return 0;_getenv.ret&&_free(_getenv.ret);_getenv.ret=allocateUTF8(ENV[b]);return _getenv.ret}function _llvm_bswap_i64(b,d){d=_llvm_bswap_i32(d)>>>0;b=_llvm_bswap_i32(b)>>>0;return(setTempRet0(b),d)|0}function _emscripten_memcpy_big(b,d,a){HEAPU8.set(HEAPU8.subarray(d,d+a),b);return b}
function _usleep(b){b/=1E3;if((ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&self.performance&&self.performance.now)for(var d=self.performance.now();self.performance.now()-d<b;);else for(d=Date.now();Date.now()-d<b;);return 0}Module._usleep=_usleep;function _nanosleep(b,d){var a=HEAP32[b>>2];b=HEAP32[b+4>>2];0!==d&&(HEAP32[d>>2]=0,HEAP32[d+4>>2]=0);return _usleep(1E6*a+b/1E3)}function _pthread_cond_wait(){return 0}var PTHREAD_SPECIFIC={};
function _pthread_getspecific(b){return PTHREAD_SPECIFIC[b]||0}var PTHREAD_SPECIFIC_NEXT_KEY=1;function _pthread_key_create(b,d){if(0==b)return ERRNO_CODES.EINVAL;HEAP32[b>>2]=PTHREAD_SPECIFIC_NEXT_KEY;PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0;PTHREAD_SPECIFIC_NEXT_KEY++;return 0}function _pthread_mutex_destroy(){}function _pthread_mutex_init(){}function _pthread_once(b,d){_pthread_once.seen||(_pthread_once.seen={});b in _pthread_once.seen||(Module.dynCall_v(d),_pthread_once.seen[b]=1)}
function _pthread_setspecific(b,d){if(!(b in PTHREAD_SPECIFIC))return ERRNO_CODES.EINVAL;PTHREAD_SPECIFIC[b]=d;return 0}function __isLeapYear(b){return 0===b%4&&(0!==b%100||0===b%400)}function __arraySum(b,d){for(var a=0,c=0;c<=d;a+=b[c++]);return a}var __MONTH_DAYS_LEAP=[31,29,31,30,31,30,31,31,30,31,30,31],__MONTH_DAYS_REGULAR=[31,28,31,30,31,30,31,31,30,31,30,31];
function __addDays(b,d){for(b=new Date(b.getTime());0<d;){var a=__isLeapYear(b.getFullYear()),c=b.getMonth();a=(a?__MONTH_DAYS_LEAP:__MONTH_DAYS_REGULAR)[c];if(d>a-b.getDate())d-=a-b.getDate()+1,b.setDate(1),11>c?b.setMonth(c+1):(b.setMonth(0),b.setFullYear(b.getFullYear()+1));else{b.setDate(b.getDate()+d);break}}return b}
function _strftime(b,d,a,c){function e(a,b,c){for(a="number"===typeof a?a.toString():a||"";a.length<b;)a=c[0]+a;return a}function g(a,b){return e(a,b,"0")}function f(a,b){function c(a){return 0>a?-1:0<a?1:0}var d;0===(d=c(a.getFullYear()-b.getFullYear()))&&0===(d=c(a.getMonth()-b.getMonth()))&&(d=c(a.getDate()-b.getDate()));return d}function h(a){switch(a.getDay()){case 0:return new Date(a.getFullYear()-1,11,29);case 1:return a;case 2:return new Date(a.getFullYear(),0,3);case 3:return new Date(a.getFullYear(),
0,2);case 4:return new Date(a.getFullYear(),0,1);case 5:return new Date(a.getFullYear()-1,11,31);case 6:return new Date(a.getFullYear()-1,11,30)}}function l(a){a=__addDays(new Date(a.tm_year+1900,0,1),a.tm_yday);var b=new Date(a.getFullYear(),0,4),c=new Date(a.getFullYear()+1,0,4);b=h(b);c=h(c);return 0>=f(b,a)?0>=f(c,a)?a.getFullYear()+1:a.getFullYear():a.getFullYear()-1}var n=HEAP32[c+40>>2];c={tm_sec:HEAP32[c>>2],tm_min:HEAP32[c+4>>2],tm_hour:HEAP32[c+8>>2],tm_mday:HEAP32[c+12>>2],tm_mon:HEAP32[c+
16>>2],tm_year:HEAP32[c+20>>2],tm_wday:HEAP32[c+24>>2],tm_yday:HEAP32[c+28>>2],tm_isdst:HEAP32[c+32>>2],tm_gmtoff:HEAP32[c+36>>2],tm_zone:n?Pointer_stringify(n):""};a=Pointer_stringify(a);n={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S"};for(var k in n)a=a.replace(new RegExp(k,"g"),n[k]);var r="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),m="January February March April May June July August September October November December".split(" ");
n={"%a":function(a){return r[a.tm_wday].substring(0,3)},"%A":function(a){return r[a.tm_wday]},"%b":function(a){return m[a.tm_mon].substring(0,3)},"%B":function(a){return m[a.tm_mon]},"%C":function(a){return g((a.tm_year+1900)/100|0,2)},"%d":function(a){return g(a.tm_mday,2)},"%e":function(a){return e(a.tm_mday,2," ")},"%g":function(a){return l(a).toString().substring(2)},"%G":function(a){return l(a)},"%H":function(a){return g(a.tm_hour,2)},"%I":function(a){a=a.tm_hour;0==a?a=12:12<a&&(a-=12);return g(a,
2)},"%j":function(a){return g(a.tm_mday+__arraySum(__isLeapYear(a.tm_year+1900)?__MONTH_DAYS_LEAP:__MONTH_DAYS_REGULAR,a.tm_mon-1),3)},"%m":function(a){return g(a.tm_mon+1,2)},"%M":function(a){return g(a.tm_min,2)},"%n":function(){return"\n"},"%p":function(a){return 0<=a.tm_hour&&12>a.tm_hour?"AM":"PM"},"%S":function(a){return g(a.tm_sec,2)},"%t":function(){return"\t"},"%u":function(a){return(new Date(a.tm_year+1900,a.tm_mon+1,a.tm_mday,0,0,0,0)).getDay()||7},"%U":function(a){var b=new Date(a.tm_year+
1900,0,1),c=0===b.getDay()?b:__addDays(b,7-b.getDay());a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);return 0>f(c,a)?(b=__arraySum(__isLeapYear(a.getFullYear())?__MONTH_DAYS_LEAP:__MONTH_DAYS_REGULAR,a.getMonth()-1)-31,c=31-c.getDate()+b+a.getDate(),g(Math.ceil(c/7),2)):0===f(c,b)?"01":"00"},"%V":function(a){var b=new Date(a.tm_year+1901,0,4),c=h(new Date(a.tm_year+1900,0,4));b=h(b);var d=__addDays(new Date(a.tm_year+1900,0,1),a.tm_yday);if(0>f(d,c))return"53";if(0>=f(b,d))return"01";a=c.getFullYear()<
a.tm_year+1900?a.tm_yday+32-c.getDate():a.tm_yday+1-c.getDate();return g(Math.ceil(a/7),2)},"%w":function(a){return(new Date(a.tm_year+1900,a.tm_mon+1,a.tm_mday,0,0,0,0)).getDay()},"%W":function(a){var b=new Date(a.tm_year,0,1),c=1===b.getDay()?b:__addDays(b,0===b.getDay()?1:7-b.getDay()+1);a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);return 0>f(c,a)?(b=__arraySum(__isLeapYear(a.getFullYear())?__MONTH_DAYS_LEAP:__MONTH_DAYS_REGULAR,a.getMonth()-1)-31,c=31-c.getDate()+b+a.getDate(),g(Math.ceil(c/
7),2)):0===f(c,b)?"01":"00"},"%y":function(a){return(a.tm_year+1900).toString().substring(2)},"%Y":function(a){return a.tm_year+1900},"%z":function(a){a=a.tm_gmtoff;var b=0<=a;a=Math.abs(a)/60;return(b?"+":"-")+String("0000"+(a/60*100+a%60)).slice(-4)},"%Z":function(a){return a.tm_zone},"%%":function(){return"%"}};for(k in n)0<=a.indexOf(k)&&(a=a.replace(new RegExp(k,"g"),n[k](c)));k=intArrayFromString(a,!1);if(k.length>d)return 0;writeArrayToMemory(k,b);return k.length-1}
function _strftime_l(b,d,a,c){return _strftime(b,d,a,c)}function _time(b){var d=Date.now()/1E3|0;b&&(HEAP32[b>>2]=d);return d}___buildEnvironment(ENV);DYNAMICTOP_PTR=staticAlloc(4);STACK_BASE=STACKTOP=alignMemory(STATICTOP);STACK_MAX=STACK_BASE+TOTAL_STACK;DYNAMIC_BASE=alignMemory(STACK_MAX);HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE;staticSealed=!0;function intArrayFromString(b,d,a){a=0<a?a:lengthBytesUTF8(b)+1;a=Array(a);b=stringToUTF8Array(b,a,0,a.length);d&&(a.length=b);return a}
Module.wasmTableSize=1152;Module.wasmMaxTableSize=1152;function jsCall_ii(b,d){return functionPointers[b](d)}function jsCall_iii(b,d,a){return functionPointers[b](d,a)}function jsCall_iiii(b,d,a,c){return functionPointers[b](d,a,c)}function jsCall_iiiii(b,d,a,c,e){return functionPointers[b](d,a,c,e)}function jsCall_iiiiid(b,d,a,c,e,g){return functionPointers[b](d,a,c,e,g)}function jsCall_iiiiii(b,d,a,c,e,g){return functionPointers[b](d,a,c,e,g)}
function jsCall_iiiiiid(b,d,a,c,e,g,f){return functionPointers[b](d,a,c,e,g,f)}function jsCall_iiiiiii(b,d,a,c,e,g,f){return functionPointers[b](d,a,c,e,g,f)}function jsCall_iiiiiiii(b,d,a,c,e,g,f,h){return functionPointers[b](d,a,c,e,g,f,h)}function jsCall_iiiiiiiii(b,d,a,c,e,g,f,h,l){return functionPointers[b](d,a,c,e,g,f,h,l)}function jsCall_iiiiij(b,d,a,c,e,g){return functionPointers[b](d,a,c,e,g)}function jsCall_v(b){functionPointers[b]()}function jsCall_vi(b,d){functionPointers[b](d)}
function jsCall_vii(b,d,a){functionPointers[b](d,a)}function jsCall_viii(b,d,a,c){functionPointers[b](d,a,c)}function jsCall_viiii(b,d,a,c,e){functionPointers[b](d,a,c,e)}function jsCall_viiiii(b,d,a,c,e,g){functionPointers[b](d,a,c,e,g)}function jsCall_viiiiii(b,d,a,c,e,g,f){functionPointers[b](d,a,c,e,g,f)}function jsCall_viijii(b,d,a,c,e,g){functionPointers[b](d,a,c,e,g)}Module.asmGlobalArg={};
Module.asmLibraryArg={abort:abort,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,jsCall_ii:jsCall_ii,jsCall_iii:jsCall_iii,jsCall_iiii:jsCall_iiii,jsCall_iiiii:jsCall_iiiii,jsCall_iiiiid:jsCall_iiiiid,jsCall_iiiiii:jsCall_iiiiii,jsCall_iiiiiid:jsCall_iiiiiid,jsCall_iiiiiii:jsCall_iiiiiii,jsCall_iiiiiiii:jsCall_iiiiiiii,jsCall_iiiiiiiii:jsCall_iiiiiiiii,jsCall_iiiiij:jsCall_iiiiij,jsCall_v:jsCall_v,jsCall_vi:jsCall_vi,jsCall_vii:jsCall_vii,
jsCall_viii:jsCall_viii,jsCall_viiii:jsCall_viiii,jsCall_viiiii:jsCall_viiiii,jsCall_viiiiii:jsCall_viiiiii,jsCall_viijii:jsCall_viijii,___cxa_allocate_exception:___cxa_allocate_exception,___cxa_throw:___cxa_throw,___lock:___lock,___map_file:___map_file,___setErrNo:___setErrNo,___syscall140:___syscall140,___syscall145:___syscall145,___syscall146:___syscall146,___syscall54:___syscall54,___syscall6:___syscall6,___syscall91:___syscall91,___unlock:___unlock,_abort:_abort,_emscripten_memcpy_big:_emscripten_memcpy_big,
_getenv:_getenv,_llvm_bswap_i64:_llvm_bswap_i64,_nanosleep:_nanosleep,_pthread_cond_wait:_pthread_cond_wait,_pthread_getspecific:_pthread_getspecific,_pthread_key_create:_pthread_key_create,_pthread_mutex_destroy:_pthread_mutex_destroy,_pthread_mutex_init:_pthread_mutex_init,_pthread_once:_pthread_once,_pthread_setspecific:_pthread_setspecific,_strftime_l:_strftime_l,_time:_time,DYNAMICTOP_PTR:DYNAMICTOP_PTR,STACKTOP:STACKTOP};var asm=Module.asm(Module.asmGlobalArg,Module.asmLibraryArg,buffer);
Module.asm=asm;
var __GLOBAL__I_000101=Module.__GLOBAL__I_000101=function(){return Module.asm.__GLOBAL__I_000101.apply(null,arguments)},__GLOBAL__sub_I_iostream_cpp=Module.__GLOBAL__sub_I_iostream_cpp=function(){return Module.asm.__GLOBAL__sub_I_iostream_cpp.apply(null,arguments)},__GLOBAL__sub_I_ndcxapi_cpp=Module.__GLOBAL__sub_I_ndcxapi_cpp=function(){return Module.asm.__GLOBAL__sub_I_ndcxapi_cpp.apply(null,arguments)},_free=Module._free=function(){return Module.asm._free.apply(null,arguments)},_llvm_bswap_i32=
Module._llvm_bswap_i32=function(){return Module.asm._llvm_bswap_i32.apply(null,arguments)},_malloc=Module._malloc=function(){return Module.asm._malloc.apply(null,arguments)},_xapiAddSignatureExclusions=Module._xapiAddSignatureExclusions=function(){return Module.asm._xapiAddSignatureExclusions.apply(null,arguments)},_xapiEndSession=Module._xapiEndSession=function(){return Module.asm._xapiEndSession.apply(null,arguments)},_xapiGetMMD=Module._xapiGetMMD=function(){return Module.asm._xapiGetMMD.apply(null,
arguments)},_xapiGetSignatureExclusions=Module._xapiGetSignatureExclusions=function(){return Module.asm._xapiGetSignatureExclusions.apply(null,arguments)},_xapiOnScanComplete=Module._xapiOnScanComplete=function(){return Module.asm._xapiOnScanComplete.apply(null,arguments)},_xapiRemoveSignatureExclusions=Module._xapiRemoveSignatureExclusions=function(){return Module.asm._xapiRemoveSignatureExclusions.apply(null,arguments)},_xapiRemoveTab=Module._xapiRemoveTab=function(){return Module.asm._xapiRemoveTab.apply(null,
arguments)},_xapiSetLogLevel=Module._xapiSetLogLevel=function(){return Module.asm._xapiSetLogLevel.apply(null,arguments)},_xapiSubmitBuffer=Module._xapiSubmitBuffer=function(){return Module.asm._xapiSubmitBuffer.apply(null,arguments)},_xapiSubmitSingletonBuffer=Module._xapiSubmitSingletonBuffer=function(){return Module.asm._xapiSubmitSingletonBuffer.apply(null,arguments)},_xapiUnregisterOnScanComplete=Module._xapiUnregisterOnScanComplete=function(){return Module.asm._xapiUnregisterOnScanComplete.apply(null,
arguments)},_xapiUpdateContent=Module._xapiUpdateContent=function(){return Module.asm._xapiUpdateContent.apply(null,arguments)},setTempRet0=Module.setTempRet0=function(){return Module.asm.setTempRet0.apply(null,arguments)},stackAlloc=Module.stackAlloc=function(){return Module.asm.stackAlloc.apply(null,arguments)},dynCall_v=Module.dynCall_v=function(){return Module.asm.dynCall_v.apply(null,arguments)},dynCall_vi=Module.dynCall_vi=function(){return Module.asm.dynCall_vi.apply(null,arguments)};
Module.asm=asm;Module.intArrayFromString=intArrayFromString;Module.allocate=allocate;Module.stringToUTF8=stringToUTF8;Module.addFunction=addFunction;Module.ALLOC_NORMAL=ALLOC_NORMAL;Module.ALLOC_STACK=ALLOC_STACK;Module.ALLOC_STATIC=ALLOC_STATIC;Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC;Module.ALLOC_NONE=ALLOC_NONE;function ExitStatus(b){this.name="ExitStatus";this.message="Program terminated with exit("+b+")";this.status=b}ExitStatus.prototype=Error();ExitStatus.prototype.constructor=ExitStatus;var initialStackTop;
dependenciesFulfilled=function runCaller(){Module.calledRun||run();Module.calledRun||(dependenciesFulfilled=runCaller)};
function run(b){function d(){if(!Module.calledRun&&(Module.calledRun=!0,!ABORT)){ensureInitRuntime();preMain();if(Module.onRuntimeInitialized)Module.onRuntimeInitialized();postRun()}}0<runDependencies||(preRun(),0<runDependencies||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1);d()},1)):d()))}Module.run=run;
function exit(b,d){if(!d||!Module.noExitRuntime||0!==b){if(!Module.noExitRuntime&&(ABORT=!0,EXITSTATUS=b,STACKTOP=initialStackTop,exitRuntime(),Module.onExit))Module.onExit(b);ENVIRONMENT_IS_NODE&&process.exit(b);Module.quit(b,new ExitStatus(b))}}Module.exit=exit;function abort(b){if(Module.onAbort)Module.onAbort(b);void 0!==b?(Module.print(b),Module.printErr(b),b=JSON.stringify(b)):b="";ABORT=!0;EXITSTATUS=1;throw"abort("+b+"). Build with -s ASSERTIONS=1 for more info.";}Module.abort=abort;
if(Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();Module.noExitRuntime=!0;run();(function(b){b.XNE.db=function(b,a){var c=a.common,d=c.logging.GetLogger("DB"),g={},f=function(a){this._fp=new c.FlatPromise;this._db=a;this._fp.result=[]};f.prototype.Select=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d={};0==b.length?d=null:1!=b.length||b[0].startsWith("/")?b.forEach(function(a){var b=$jscomp.makeIterator([d,null]),c=b.next().value;b=b.next().value;if(!a.startsWith("/"))throw Error("Invalid path <"+a+'>. Must start with a "/"');a=a.split("/");a.shift();
a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next()){var k=e.value;c.hasOwnProperty(k)||(c[k]={});b=c;c=c[k]}b[k]=-1}):d=b[0];Object.defineProperty(this,"keyOrValue",{value:d,writable:!1});Object.defineProperty(this,"mode",{value:"readonly",writable:!1});return this};f.prototype.Insert=function(a){Object.defineProperties(this,{keyOrValue:{value:a,writable:!1},mode:{value:"readwrite",writable:!1},isUpdate:{value:!1,writable:!1}});return this};f.prototype.Update=function(a){Object.defineProperties(this,
{keyOrValue:{value:a,writable:!1},mode:{value:"readwrite",writable:!1},isUpdate:{value:!0,writable:!1}});return this};f.prototype.Clear=function(a){Object.defineProperties(this,{stores:{value:a,writable:!1},mode:{value:"delete",writable:!1},clear:{value:!0,writable:!1}});return this};f.prototype.Delete=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];0<b.length&&Object.defineProperty(this,"keyMatcher",{value:new Set(b),writable:!1});Object.defineProperty(this,"mode",{value:"delete",
writable:!1});return this};f.prototype.As=function(a){Object.defineProperty(this,"keyName",{value:a,writable:!1});return this};f.prototype.From=function(a){Object.defineProperty(this,"stores",{value:a,writable:!1});return this};f.prototype.Into=function(a){Object.defineProperty(this,"stores",{value:a,writable:!1});return this};f.prototype.Where=function(a){Object.defineProperty(this,"index",{value:a,writable:!1});return this};f.prototype.WherePrimaryKey=function(){Object.defineProperty(this,"index",
{value:null,writable:!1});return this};f.prototype.Equals=function(a){Object.defineProperty(this,"keyRange",{value:IDBKeyRange.only(a),writable:!1});return this};f.prototype.Between=function(a,b,c,d){Object.defineProperty(this,"keyRange",{value:IDBKeyRange.bound(a,b,c,d),writable:!1});return this};f.prototype.Are=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];Object.defineProperty(this,"keyMatcher",{value:new Set(b),writable:!1});return this};f.prototype.LessThan=function(a,
b){Object.defineProperty(this,"keyRange",{value:IDBKeyRange.upperBound(a,b),writable:!1});return this};f.prototype.GreaterThan=function(a,b){Object.defineProperty(this,"keyRange",{value:IDBKeyRange.lowerBound(a,b),writable:!1});return this};f.prototype.Matches=function(a){Object.defineProperty(this,"keyMatcher",{value:new RegExp(a),writable:!1});return this};f.prototype.Run=function(){function a(b,c,d){d=void 0===d?[]:d;for(var e=$jscomp.makeIterator(Object.keys(c)),f=e.next();!f.done;f=e.next())f=
f.value,"object"==typeof c[f]?d=a(b?b[f]:void 0,c[f],d):d.push(b?b[f]:void 0);return d}function b(a,b){return!a||(a instanceof RegExp?a.test(b.key):a.has(b.key))}var c=this;this.transactionId=(new Date).getTime();d.debug("[TrxId: "+this.transactionId+"] Query: <"+this.mode+"> operation on <"+this.stores+"> "+("key: <"+this.keyName+"> index: <'"+this.index+"'> filters: <"+this.keyRange+"> ")+("keyOrValue: <'"+this.keyOrValue+"'>"));if(!this.mode)throw Error("Invalid query: mode is undefined");this.stores||
d.debug("WARN: No stores are selected");var e=this.stores?Array.isArray(this.stores)?this.stores:[this.stores]:this._db.objectStoreNames,f=this._db.transaction(e,"readonly"==this.mode?"readonly":"readwrite");f.oncomplete=function(a){d.debug("Transaction complete: "+c.transactionId+" "+JSON.stringify(a));c._fp.resolve(c._fp.result)};f.onabort=function(a){d.debug("Transaction <"+c.transactionId+"> aborted: "+a.target.error);c._fp.reject(a)};f.onerror=function(a){d.debug("Transaction error on Id <"+
c.transactionId+">: "+a.target.error);c._fp.reject(a)};try{for(var g={},v=0;v<e.length;g={objectStore:g.objectStore},v++)if(g.objectStore=f.objectStore(e[v]),"readwrite"==this.mode)this.isUpdate?"function"==typeof this.keyOrValue&&this.keyName?g.objectStore.get(this.keyName).onsuccess=function(a){return function(b){a.objectStore.put(c.keyOrValue(b.target.result),c.keyName)}}(g):g.objectStore.put(this.keyOrValue,this.keyName):g.objectStore.add(this.keyOrValue,this.keyName);else if("readonly"==this.mode)if(this.keyOrValue&&
"string"==typeof this.keyOrValue&&!this.keyOrValue.startsWith("/"))g.objectStore.get(this.keyOrValue).onsuccess=function(a){c._fp.result.push(a.target.result)};else{var h=this.index?g.objectStore.index(this.index):g.objectStore;h.openCursor(this.keyRange).onsuccess=function(d){if(d=d.target.result)b(c.keyMatcher,d)&&c._fp.result.push(c.keyOrValue?a(d.value,c.keyOrValue):d.value),d.continue()}}else if("delete"==this.mode)this.clear?g.objectStore.clear():(h=this.index?g.objectStore.index(this.index):
g.objectStore,h.openCursor(this.keyRange).onsuccess=function(a){if(a=a.target.result)b(c.keyMatcher,a)&&a.delete(),a.continue()});else throw Error("Invalid query mode: <"+this.mode+">");}catch(y){this._fp.reject("TrxId "+this.transactionId+": "+y),f.abort()}return this._fp.promise};var h=function(a){if(!window.indexedDB)throw Error("IndexedDB not supported");if(!a)throw Error("Must specify a database name");this.name=a;this.database=null};h.prototype.Open=function(a){var b=this;a=void 0===a?{}:a;
var e=new c.FlatPromise,f=a.version?window.indexedDB.open(this.name,a.version):window.indexedDB.open(this.name);f.onsuccess=function(a){b.database=a.target.result;e.resolve();d.debug("Connected to "+b.name+" version: "+b.database.version)};f.onerror=function(a){d.debug("Error while opening "+b.name+": "+a.target.error);e.reject(a.target.error)};f.onversionchange=function(a){d.debug("Version change requested. Closing DB");b.database.close()};f.onupgradeneeded=function(b){var c=b.target.result,e=c.objectStoreNames,
g={create:function(a){if(a.hasOwnProperty("name")&&!e.contains(a.name)){d.debug("Creating store: "+a.name);var b=c.createObjectStore(a.name,a.options);a.hasOwnProperty("indices")&&a.indices.hasOwnProperty("create")&&Array.isArray(a.indices.create)&&a.indices.create.forEach(function(a){b.createIndex(a.name,a.keyPath,a.params)})}},delete:function(a){e.contains(a)&&c.deleteObjectStore(a)},modify:function(a){var b={create:function(a,b){a.createIndex(b.name,b.keyPath,b.params)},delete:function(a,b){a.deleteIndex(b)}};
a.hasOwnProperty("name")&&e.contains(a.name)&&a.hasOwnProperty("indices")&&["create","delete"].forEach(function(c){if(Array.isArray(a.indices[c])){var d=f.transaction.objectStore(a.name);a.indices[c].forEach(function(a){b[c](d,a)})}})}};["delete","create","modify"].forEach(function(b){Array.isArray(a[b])&&a[b].forEach(function(a){return g[b](a)})})};return e.promise};h.prototype.Close=function(){if(!this.database)throw Error("Database not ready");this.database.close()};h.prototype.Upgrade=function(a){if(!this.database)throw Error("Database not ready");
this.Close();return this.Open(a)};h.prototype.Query=function(){if(!this.database)throw Error("Database not ready");return new f(this.database)};h.prototype.Delete=function(){if(!this.database)throw Error("Database not ready");d.debug("DB:Delete "+this.database.name);return window.indexedDB.deleteDatabase(this.database.name)};h.prototype.Version=function(){if(!this.database)throw Error("Database not ready");return this.database.version};g._initFuture=(new Promise(function(a,b){g.initialize=function(c){g.initialize=
function(){return g._initFuture};try{g.xdb=new h("xndcweb.db"),g.xdb.Open({create:[{name:"content"}]}).then(a).catch(b)}catch(r){d.debug("DB init failure: "+r),b(r)}return g._initFuture}})).then(function(){return new c.InitResult({self:g})}).catch(function(a){return new c.InitResult({self:null,error:a})});g.OnInitComplete=function(){return this._initFuture};g.DB=h;return g}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.storage=function(b){var a=XNE.common,c=a.logging.GetLogger("STORAGE"),d={local:null,managed:null,sync:null},g={browser:null,CreateFlatPromise:function(){var a={};a.promise=new Promise(function(b,c){a.resolve=b;a.reject=c});return a},Fulfill:function(a,b){var c=g.browser?g.browser.runtime.lastError:"StorageIO.browser not initlaized";c?a.reject(c):a.resolve(b)}},f=function(a){var d=this;if(!a)throw Error("Invalid storage object");Object.defineProperty(this,"browser",{value:b.globals.BROWSER,
writable:!1});Object.defineProperty(this,"storage",{value:a,writable:!1});Object.defineProperty(this,"isChrome",{get:function(){return"Chrome"==this.browser}});Object.defineProperty(this,"isEdge",{get:function(){return"Edge"==this.browser}});Object.defineProperty(this,"isFirefox",{get:function(){return"Firefox"==this.browser}});try{if(this.isChrome||this.isEdge)this.storage.getBytesInUse(null,function(a){c.debug(d.browser+".StorageIO ready. Bytes in use: "+a)});else if(this.isFirefox)c.debug("firefox.StorageIO ready.");
else throw Error("xneStorage::ManagedStorage Error: Browser '"+this.browser+"' is not supported.");}catch(k){throw Error("Exception while querying storage: "+k);}};f.prototype.SafeInvoke=function(a,b){b=void 0===b?[]:b;try{if(this.isChrome||this.isEdge){var d=g.CreateFlatPromise();b.push(function(a){g.Fulfill(d,void 0===a?null:a)});a.bind(this.storage).apply(null,$jscomp.arrayFromIterable(b));return d.promise}return a.bind(this.storage).apply(null,$jscomp.arrayFromIterable(b))}catch(r){throw c.debug("Exeception while calling storage delegate <"+
a.name+">: "+r),r;}};f.prototype.get=function(a){return this.SafeInvoke(this.storage.get,[void 0===a?null:a])};var h=function(a){return f.call(this,a)||this};$jscomp.inherits(h,f);h.prototype.set=function(a){return this.SafeInvoke(this.storage.set,[a])};h.prototype.clear=function(){return this.SafeInvoke(this.storage.clear)};h.prototype.remove=function(a){return this.SafeInvoke(this.storage.remove,[a])};h.prototype.getBytesInUse=function(a){return this.isFirefox?Promise.reject("getBytesInUse is not supported on Firefox"):
this.SafeInvoke(this.storage.getBytesInUse,[a])};d._initFuture=(new Promise(function(a,e){d.initialize=function(k){d.initialize=function(){return d._initFuture};try{k||e(Error("Invalid params to init Storage")),g.browser=k.browserObject,"Edge"!==b.globals.BROWSER&&(d.managed=new f(g.browser.storage.managed)),d.local=new h(g.browser.storage.local),d.sync=new h(g.browser.storage.sync),!1===k.storage?e(Error("Storage disabled")):a()}catch(r){c.debug("Error while initializing storage: "+r),e(r)}return d._initFuture}})).then(function(){return new a.InitResult({self:d})}).catch(function(b){return new a.InitResult({self:null,
error:b})});d.OnInitComplete=function(){return this._initFuture};return d}(b.SymBfw)})(this);(function(b){b.XNE.cacheImpl=function(b,a){var c=a.storage,d=a.common.logging.GetLogger("CACHEIMPL");a.common.logging.SuppressModules("CACHEIMPL");var g=function(){var a=this;if(!g.instance){var b=function(){g.prototype.Get=f;g.prototype.Has=e;g.prototype.Set=q;g.prototype.Remove=l;g.prototype.Clear=h;g.prototype.SetVolatile=function(a,b){return q(a,b,!0)};g.prototype.Flush=function(a){return v(a)};g.prototype.Stage=function(a,b){try{return this.staged[a]=u(b,2),q(a,b,!0)}catch(H){return{cache:!1,
error:H}}}},e=function(a){return x(this.map.has,[a])},f=function(a){a=x(this.map.get,[a]);a.return&&a.return.hasOwnProperty("_0")&&(a.return=a.return._0);return a},v=function(a){var b=this;a=void 0===a?"":a;if(!this.storage)return{return:0,storage:Promise.reject("storage undefined")};for(var c={storage:Promise.resolve(null)},d={},e=$jscomp.makeIterator(Object.keys(this.staged).filter(function(b){return b.startsWith(a)})),f=e.next();!f.done;f=e.next())f=f.value,d[f]=this.staged[f],delete this.staged[f];
c.return=Object.keys(d).length;0<c.return&&(c.storage=this.storage.set(d).then(function(){Object.keys(d).forEach(function(a){z(b.map.get(a),2)})}));return c},h=function(){var a=x(this.map.clear);this.staged={};a.storage=this.storage?p(this.storage.clear):Promise.reject("storage undefined");return a},l=function(a){var b;if(b=this.map.has(a))b=(b=this.map.get(a))?2==(b._f&2):!1;var c=x(this.map.delete,[a]);c.storage=this.storage?p(this.storage.remove,[a]):Promise.reject("storage undefined");this.staged.hasOwnProperty(a)&&
(delete this.staged[a],c.staged=!0);c.return=b;return c},q=function(a,b,c,d){var e=this;c=void 0===c?!1:c;d=void 0===d?{}:d;var f=this.map.has(a),g=(f?this.map.get(a)._f:0)|(c?0:8);b=u(b,g);c?z(b,1):A(b,1);d.set&&z(b,d.set);d.unset&&A(b,d.unset);f=!f||2!=(g&2);d=!c&&f;c&&f||z(b,2);g=this.map.size;f=x(this.map.set,[a,b]);A(b,8);f.return=c?1==this.map.size-g?!0:!1:d;d={};f.storage=c?Promise.resolve(null):this.storage?p(this.storage.set,[(d[a]=b,d)]):Promise.reject("storage undefined");f.storage.then(function(){e.map.has(a)&&
A(e.map.get(a),8)}).catch(function(){e.map.has(a)&&z(e.map.get(a),4)});return f},u=function(a,b){return{_0:a,_f:0|(void 0===b?0:b)}},p=function(a,b){var c=this;b=void 0===b?[]:b;try{if(!this.storage)throw Error("storage is undefined");var e=a.bind(this.storage).apply(null,$jscomp.arrayFromIterable(b));e.then(function(c){d.debug("Storage::"+a.name+"("+JSON.stringify(b)+")")}).catch(function(e){var f="Store failure: "+a.name+"("+JSON.stringify(b)+"). ("+e.message+")";d.debug(f);D.push(f);E.bind(c)(e)});
return e}catch(F){return E.bind(this)(F),Promise.reject(F)}},x=function(a,b){b=void 0===b?[]:b;var c={cache:!0};try{c.return=a.bind(this.map).apply(null,$jscomp.arrayFromIterable(b))}catch(B){d.debug("Error while Map::"+a.name+"("+b+") ("+B+")"),c.cache=!1,c.error=B}d.debug("Map::"+a.name+"("+JSON.stringify(b)+") <-> "+JSON.stringify(c));return c},A=function(a,b){"object"==typeof a?a._f&=~b:d.debug("Cannot UnsetFlag on <"+a+"> of type <"+typeof a+">")},z=function(a,b){"object"==typeof a?a._f|=b:d.debug("Cannot SetFlag on <"+
a+"> of type <"+typeof a+">")},E=function(a){var b=this;setTimeout(function(a){try{for(var c=$jscomp.makeIterator(b.onError.entries()),d=c.next();!d.done;d=c.next())d.value[0](a)}catch(J){}},0,a)},D=[];this.onSuccess=new Set;this.onError=new Set;this.staged={};this.quotaExceeded=!1;Object.defineProperty(this,"syncErrors",{get:function(){return D},set:function(a){}});q=q.bind(this);l=l.bind(this);h=h.bind(this);f=f.bind(this);e=e.bind(this);v=v.bind(this);x=x.bind(this);p=p.bind(this);this._initFuture=
c.OnInitComplete().then(function(c){if(!c.self)throw c.error?c.error:Error("null storage");a.storage=c.self.local;return a.storage.get().then(function(c){a.map=new Map(a._process(c));b.bind(a)();g.prototype.Set.bind(a)("__SyncManagerInit0__",(new Date).getTime());g.prototype.Remove.bind(a)("__SyncManagerInit0__");d.debug("Ready to Sync");return{self:a}})}).catch(function(c){d.debug("Storage Init failed ("+c+"). Falling back to 'volatile storage only' mode.");a.map=new Map;b.bind(a)();return{self:null}});
g.prototype.Get=function(a){return this._initFuture.then(function(){return f(a)})};g.prototype.Has=function(a){return this._initFuture.then(function(){return e(a)})};g.prototype.Set=function(a,b){return this._initFuture.then(function(){return q(a,b)})};g.prototype.SetVolatile=function(a,b){return this._initFuture.then(function(){return q(a,b,!0)})};g.prototype.Remove=function(a){return this._initFuture.then(function(){return l(a)})};g.prototype.Clear=function(){return this._initFuture.then(function(){return h()})};
g.prototype.Flush=function(a){return this._initFuture.then(function(b){return v(a)})};g.prototype.Stage=function(a,b){var c=this._initFuture.then(function(){return q(a,b,!0)});this.staged[a]=u(b);return c};Object.defineProperty(g,"instance",{value:this,writable:!1});d.debug("SyncManager incarnated")}return g.instance};g.prototype.OnInitComplete=function(){return this._initFuture};g.prototype.SyncErrors=function(){return this.syncErrors};g.prototype.AddStorageNotifiers=function(a,b){"function"===typeof a&&
this.onSuccess.add(a);"function"===typeof b&&this.onError.add(b)};g.prototype.RemoveStorageNotifiers=function(a,b){a&&this.onSuccess.delete(a);b&&this.onError.delete(b)};g.prototype._process=function(a){return Object.entries(a)};var f=function(a,b,c){if(!a||!c||!b)throw Error("Invalid params to NamespacedSyncManager constructor");var e=g.call(this)||this;if(!f._initFuture){f.properties={};var k=g.prototype.OnInitComplete.call(e).then(function(){var b=e.map.keys();b=$jscomp.makeIterator(b);for(var c=
b.next();!c.done;c=b.next()){var g=$jscomp.makeIterator(c.value.split(".",4)),k=g.next().value;c=g.next().value;var x=g.next().value;g=g.next().value;k===a&&c&&x&&g&&(k=f.properties,k.hasOwnProperty(c)||(k[c]={}),k[c].hasOwnProperty(x)||(k[c][x]={size:0,staged:0,__size:0}),k[c][x].size++,k[c][x].__size++)}d.debug("Namespaces processed. Ready to cache");return{self:e}});f.Clear=function(){var a=g.prototype.Clear.call(e);Object.keys(f.properties).forEach(function(a){Object.keys(f.properties[a]).forEach(function(b){f.properties[a][b].size=
0;f.properties[a][b].__size=0;f.properties[a][b].staged=0})});return a};f.Flush=function(){function a(a){var b=f.properties;if(a.return&&0<a.return){a=$jscomp.makeIterator(Object.keys(b));for(var c=a.next();!c.done;c=a.next()){c=c.value;for(var d=$jscomp.makeIterator(Object.keys(b[c])),e=d.next();!e.done;e=d.next())e=e.value,0<b[c][e].staged&&(b[c][e].size+=b[c][e].staged,b[c][e].staged=0)}}}var b=g.prototype.Flush.call(e);b instanceof Promise?b.then(function(b){a(b)}):a(b);return b};Object.defineProperty(f,
"_initFuture",{value:k,writable:!1});d.debug("NamespacedSyncManager incarnated")}f.properties.hasOwnProperty(b)||(f.properties[b]={});f.properties[b].hasOwnProperty(c)||(f.properties[b][c]={size:0,staged:0,__size:0});var h=Object.create(e);h.prefix=a+"."+b+"."+c+".";h.basename=a;h.storetype=b;h.storename=c;g.prototype.OnInitComplete.call(e).then(function(){var a=e.map.entries();Object.defineProperty(h,"NextByInsertionOrder",{value:function(b){b=void 0===b?h.prefix:b;var c;if(0<this.Size())for(var d=
0;d<this.map.size;d++)if((c=a.next()).done&&(c=(a=this.map.entries()).next()),c.value&&c.value[0].startsWith(b))return c.value[0].replace(this.prefix,"");return null}});Object.defineProperty(h,"BuildOrderedList",{value:function(a){var b=this;return 0<this.Size()?[].concat($jscomp.arrayFromIterable(this.map.entries())).filter(function(a){return a[0].startsWith(h.prefix)}).sort(function(c,d){return a([c[0].replace(b.prefix,""),c[1]._0._1],[d[0].replace(b.prefix,""),d[1]._0._1])}).map(function(a){return a[0].replace(b.prefix,
"")}):[]}})});return h};$jscomp.inherits(f,g);f.prototype.GetCurrentStore=function(){return f.properties[this.storetype][this.storename]};f.prototype.Has=function(a){return g.prototype.Has.call(this,this.prefix+a)};f.prototype.Get=function(a){function b(a){a.return&&a.return.hasOwnProperty("_1")&&(a.return=a.return._1);return a}a=g.prototype.Get.call(this,this.prefix+a);return a instanceof Promise?a.then(function(a){return b(a)}):b(a)};f.prototype.SetVolatile=function(a,b){b={_1:b,_t:(new Date).getTime()};
return g.prototype.SetVolatile.call(this,this.prefix+a,b)};f.prototype.Flush=function(){function a(a){a.storage.catch(function(){});var b=f.properties[this.storetype][this.storename];a.return&&0<a.return&&(a.storage.then(function(){b.__size+=a.return}).catch(function(){}),b.staged!=a.return&&d.debug("Staged count inconsistencies on: "+this.storetype+"::"+this.storename),b.size+=b.staged,b.staged=0)}var b=this,c=g.prototype.Flush.call(this,this.prefix);c instanceof Promise?c.then(function(c){a.bind(b)(c)}):
a.bind(this)(c);return c};f.prototype.Set=function(a,b){function c(a){var b=f.properties[this.storetype][this.storename];a.storage.catch(function(a){});!0===a.cache&&!0===a.return&&(b.size++,a.storage.then(function(){b.__size++}).catch(function(){}))}var d=this;b={_1:b,_t:(new Date).getTime()};a=g.prototype.Set.call(this,this.prefix+a,b);a instanceof Promise?a.then(function(a){c.bind(d)(a)}):c.bind(this)(a);return a};f.prototype.Stage=function(a,b){function c(a){a.storage.then(function(){});!0===
a.cache&&!0===a.return&&e[this.storetype][this.storename].staged++}var d=this,e=f.properties;b={_1:b,_t:(new Date).getTime()};a=g.prototype.Stage.call(this,this.prefix+a,b);a instanceof Promise?a.then(function(a){c.bind(d)(a)}):c.bind(this)(a);return a};f.prototype.Remove=function(a){function b(a){var b=this.GetCurrentStore();a.storage.catch(function(){});!0===a.cache&&(!0===a.return&&(b.size--,a.storage.then(function(){b.__size--})),!0===a.staged&&b.staged--)}var c=this;a=g.prototype.Remove.call(this,
this.prefix+a);a instanceof Promise?a.then(function(a){b.bind(c)(a)}):b.bind(this)(a);return a};f.prototype.Clear=function(){if(this.map){for(var a=this.GetCurrentStore(),b=$jscomp.makeIterator(this.map.keys()),c=b.next();!c.done;c=b.next())c=c.value,c.startsWith(this.prefix)&&(c=g.prototype.Remove.call(this,c),1==c.cache&&(!0===c.return&&(a.size--,c.storage.then(function(){a.__size--})),!0===c.staged&&a.staged--),c.storage.catch(function(){}));return!0}return!1};f.prototype.Size=function(){var a=
f.properties;return a.hasOwnProperty(this.storetype)&&a[this.storetype].hasOwnProperty(this.storename)?a[this.storetype][this.storename].size:null};f.OnInitComplete=function(){return f._initFuture};f.prototype._process=function(a){return Object.keys(a).sort(function(b,c){return a[b].hasOwnProperty("_0")&&a[c].hasOwnProperty("_0")?a[b]._0._t-a[c]._0._t:-1}).map(function(b){return[b,a[b]]})};var h=function(a,b,c){if("function"!==typeof b)throw Error("comparator must be callable");Object.defineProperty(this,
"name",{value:a,writable:!1});Object.defineProperty(this,"comparator",{value:b,writable:!1})};h.prototype.rebuild=function(){this.__iterable=this.store.BuildOrderedList(this.comparator);$jscomp.initSymbol();$jscomp.initSymbolIterator();this.__iterator=this.__iterable[Symbol.iterator]();console.log(JSON.stringify(this.__iterable));return this.__iterator};h.prototype.bind=function(a){if(!(a instanceof f))throw Error("Must be a NamespacedSyncManager object to bind");this.close();this.store=a;return this};
h.prototype.next=function(){this.__iterator||this.rebuild();var a=this.__iterator.next();a.done&&($jscomp.initSymbol(),$jscomp.initSymbolIterator(),a=(rebuildOnWrap?this.rebuild():this.__iterator=this.__iterable[Symbol.iterator]()).next());return a.value};h.prototype.close=function(){this.store=this.__iterable=this.__iterator=null};var l=function(a){Object.defineProperty(this,"Create",{value:a,writable:!1})},n=function(a,b,c){var d=this;c=void 0===c?"cache":c;this.store=new f("xNDCWeb",c,a);this.storeName=
a;this.storeType=c;this.maxEntries=b;var e=null;Object.defineProperty(this,"policy",{get:function(){return e},set:function(a){if(null!==a&&!(a instanceof l))throw Error("Invalid policy <"+typeof a+">");e&&e.close();e=a?a.Create(this.store):null}});this._initFuture=f.OnInitComplete().then(function(){return{self:d}})};n.prototype.__NotifyPolicy=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(this.policy&&this.policy.onActivity)try{this.policy.onActivity.apply(this.policy,
[a].concat($jscomp.arrayFromIterable(c)))}catch(v){d.debug("Policy("+this.policy.name+") error while notifying: "+v)}};n.prototype.OnInitComplete=function(){return this._initFuture};n.prototype.Size=function(){return this.store.Size()};n.prototype.Insert=function(a,b,c){function e(){try{var a=this.policy.next();d.debug("Enforcing: "+this.policy.name+". key: "+a);return void 0==a?(d.debug("Policy("+this.policy.name+"): undefined key returned"),!1):0==n.prototype.Remove.bind(this)(a)?(d.debug("Policy("+
this.policy.name+") Error: Cleanup failure [Key: "+a+"]"),!1):!0}catch(y){return d.debug("Policy("+this.policy.name+") Error: "+y),!1}}c=void 0===c?null:c;if(!this.store.Has(a).return){var f=n.prototype.Size.bind(this)();if(this.maxEntries&&f==this.maxEntries&&this.policy){if(!e.bind(this)())return!1}else if(this.store.quotaExceeded){if(!this.policy)return d.debug(this.storeType+":"+this.storeName+" insert failure. Storage quota exceeded"),!1;e.bind(this)()}else if(f>=this.maxEntries)return d.debug(this.storeType+
":"+this.storeName+" capacity full. "+this.Size()+" items."),!1}b=this.store.Set(a,{_v:b,_x:c?(new Date).getTime()+1E3*c:null});n.prototype.__NotifyPolicy.bind(this)("insert",a,null);return b instanceof Promise?null:b.cache};n.prototype.InsertVolatile=function(a,b,c){c=void 0===c?null:c;a=this.store.SetVolatile(a,{_v:b,_x:c?(new Date).getTime()+1E3*c:null});return a instanceof Promise?null:a.cache};n.prototype.Remove=function(a){var b=this.store.Remove(a);n.prototype.__NotifyPolicy.bind(this)("remove",
a);return b instanceof Promise?null:b.cache?b.return:!1};n.prototype.Get=function(a){a=n.prototype.GetEx.bind(this)(a);return a instanceof Promise?null:a};n.prototype.GetEx=function(a){function b(b){return!0===b.cache&&b.return?b.return._x&&b.return._x<(new Date).getTime()?(n.prototype.Remove.bind(this)(a),null):b.return._v:null}var c=this,d=this.store.Get(a);n.prototype.__NotifyPolicy.bind(this)("get",a);return d instanceof Promise?d.then(function(a){return b.bind(c)(a)}):b.bind(this)(d)};n.prototype.Clear=
function(){n.prototype.__NotifyPolicy.bind(this)("clear");return this.store.Clear()};n.prototype.Has=function(a){return null==n.prototype.Get.bind(this)(a)?!1:!0};b={None:new l(function(){return null}),FIFO:new l(function(a){var b=new h("FIFO",function(){});b.next=function(){return this.store.NextByInsertionOrder()};return a?b.bind(a):b}),ImminentExpiry:new l(function(a){var b=new h("OIE",function(a,b){return a[1].hasOwnProperty("_x")&&b[1].hasOwnProperty("_x")?a[1]._x-b[1]._x:-1});return a?b.bind(a):
b}),LeastRecentlyUsed:new l(function(a){var b=new h("LRU",function(){return 0});b.rebuild=function(){this.__iterable=new Set(this.store.BuildOrderedList(this.comparator))};b.next=function(){this.__iterable||this.rebuild();return this.__iterable.values().next().value};b.onActivity=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(this.__iterable)switch(a){case "get":case "insert":this.__iterable.delete(c[0]);this.__iterable.add(c[0]);break;case "remove":this.__iterable.delete(c[0]);
break;case "clear":this.__iterable=null}};a&&(b=b.bind(a),b.rebuild());return b}),LeastFrequentlyUsed:new l(function(){d.debug("Policy not implemented: LFU");return null})};n.Policy=Object.freeze(b);b={};b.Cache=n;b.NamespacedSyncManager=f;b.SyncManager=g;return b}(b.SymBfw,XNE)})(this);(function(b){b.XNE.telemetry=function(b,a){var c=b.utils.isString,d=a.common.logging.GetLogger("TELEMETRY"),g={checkStringIsValid:function(a){if(!c(a))throw Error(a+" must be of type string");},sendWrapper:function(d,e,g){if(a.config&&!0===a.config.Get("allowTelemetry")){this.checkStringIsValid(d);this.checkStringIsValid(e);if(!c(g)){if(!(g instanceof Error))throw Error("payload should be an instanceof Error other than a string");g=g.toString()}var f={},h=b.telemetryWrapper;f[h.parameters.EVENT]=
h.TELEMETRY_TYPE;f[h.parameters.CATEGORY]=d;f[h.parameters.ACTION]=e;f[h.parameters.PAYLOAD]=g;b.telemetry.send(f)}},doTelemetry:function(a,b,c){setTimeout(function(a,b,c){try{g.sendWrapper(a,b,c)}catch(m){d.debug("Exception while telemetry: "+m)}},0,a,b,c)}};return g}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.config=function(b,a){var c=b.utils.isntNil,d=b.utils.isNil,g=a.common,f=a.constants,h=g.logging.GetLogger("CONFIG"),l=new a.cacheImpl.Cache("Config"),n=new a.cacheImpl.Cache("Blocked"),k=function(a){return g.JSScope.apply(this,arguments)||this};$jscomp.inherits(k,g.JSScope);k.prototype.OverrideLock=function(){(this.isLockedSetting=this.args[0]._locked)&&this.args[0].Unlock()};k.prototype["~OverrideLock"]=function(){this.isLockedSetting&&this.args[0].Lock()};var r={OverrideLock:k},
m=function(){var e=function(a,b,f,g){b=void 0===b?null:b;g=void 0===g?{}:g;if(d(a))throw Error("Cannot create a PropertyValue with null value");if(f&&!Array.isArray(f))throw Error("Invalid accessor type <"+typeof accessor+">. Must be an array");var u=a,x=typeof u;this._accessors=f?f:[];this._locked=g.hasOwnProperty("locked")?g.locked:!1;this._hidden=g.hasOwnProperty("hidden")?g.hidden:!1;this._notify=g.hasOwnProperty("notify")?g.notify:!1;Object.defineProperty(this,"label",{value:b,writable:!1});
Object.defineProperty(this,"type",{get:function(){return x},set:function(){}});Object.defineProperty(this,"value",{get:function(){var a=this,d=u;try{return this._accessors.forEach(function(c){d=c.get.bind(a)(d,b)}),c(d)?d:u}catch(B){return B instanceof e.StopIteration?c(B.value)?B.value:u:u}},set:function(a){var d=this;if(this._locked)throw Error("Cannot modify a locked PropertyValue <"+this.label+">");var f=a;try{this._accessors.forEach(function(a){f=a.set.bind(d)(f,b)}),c(f)&&(u=f)}catch(F){F instanceof
e.StopIteration&&c(F.value)&&(u=F.value)}}})};e.prototype.AddAccessor=function(a,b,c){c=void 0===c?[]:c;return this._accessors&&e.Accessors.hasOwnProperty(a)?(a=e.Accessors[a],this._accessors.splice(b,0,"function"==typeof a?a.apply(null,$jscomp.arrayFromIterable(c)):a),!0):!1};e.prototype.DropAccessor=function(a){if(this._accessors){var b=this._accessors.findIndex(function(b){return b.__id__===a});if(0<=b)return this._accessors.splice(b,1),!0}return!1};e.prototype.Lock=function(){return this._locked=
!0};e.prototype.Unlock=function(){this._locked=!1;return!this._locked};e.prototype.Hide=function(){return this._hidden=!0};e.prototype.Unhide=function(){this._hidden=!1;return!this._hidden};e.prototype.SetNotify=function(a){this._notify="boolean"==typeof a&&1==a?!0:!1;return this._notify===a};e.CreateAccessor=function(a,b,c){b=void 0===b?null:b;c=void 0===c?{get:function(){return null},set:function(){return null}}:c;Object.defineProperty(e.Accessors,a,{value:"function"==typeof b?function(d){for(var e=
[],f=0;f<arguments.length;++f)e[f-0]=arguments[f];return Object.assign(Object.create(c),b.apply(null,$jscomp.arrayFromIterable(e)),{__id__:a})}:Object.assign(Object.create(c),b,{__id__:a}),enumerable:!0})};e.Accessors={};e.StopIteration=function(a){this.value=a};var g={},k=new Set,m={Get:function(a){if(g.hasOwnProperty(a))return g[a].value;h.error("[xNDC.Web Error]: Config::Get: Cannot 'Get' non existing property: "+a);return null},Set:function(b,d){if(g.hasOwnProperty(b)){if(typeof d===g[b].type){if("number"==
typeof d&&isNaN(d))return h.error("[xNDC.Web Error]: Config::Set: Cannot set property to NaN"),!1;var e=g[b].value;g[b].value=d;h.debug("xConfig::Set: "+b+" => "+d);c(g[b]._notify)&&g[b]._notify&&a.telemetry.doTelemetry(f.telemetry.CATEGORY.FEATURES,f.telemetry.ACTIONTYPE.ALERT,b+" => "+d);k.forEach(function(a){setTimeout(function(){try{a(b,e,g[b].value)}catch(D){}},0)});return!0}h.error("[xNDC.Web Error]: Config::Set: Unexpected type <"+typeof d+"> for property '"+b+"' of type <"+typeof g[b].value+
">")}else h.error("[xNDC.Web Error]: Config::Set: Property does not exist: "+b);return!1},Keys:function(){return Object.keys(g).filter(function(a){return!1===g[a]._hidden})},Has:function(a){return g.hasOwnProperty(a)},IsLocked:function(a){return g.hasOwnProperty(a)?g[a]._locked:null},IsHidden:function(a){return g.hasOwnProperty(a)?g[a]._hidden:null},AddListener:function(a){return"function"==typeof a?(k.add(a),!0):!1},RemoveListener:function(a){return k.delete(a)},HasListener:function(a){return k.has(a)},
ResetDefaults:function(){l.Clear();n.Clear()}};e.CreateAccessor("persist",{get:function(a,b){return l.Get(b)},set:function(a,b){l.Insert(b,a);return a}});e.CreateAccessor("asyncAndPersistent",{get:function(a,b){b=l.GetEx(b);return b instanceof Promise?b.then(function(b){return null!==b?b:a}):b}},e.Accessors.persist);e.CreateAccessor("validate",{get:function(a){return a},set:function(a,b){if(!Object.values(f.recommendation).includes(a))throw e.StopIteration(null);return a}});e.CreateAccessor("firefox",
{get:function(a){return"Firefox"==b.globals.BROWSER?a:!1},set:function(a){return a}});e.CreateAccessor("bounded",function(a,b){return{get:function(a){return a},set:function(c){if(c<a||c>b)throw e.StopIteration(null);return c},args:function(){return[a,b]}}});var q=f.telemetry.LABEL.FEATURES,u=f.telemetry.LABEL.EXCEPTIONS,p=e.Accessors;g={allowScan:new e(!0,q.NDCSCANNER,[p.persist]),allowTelemetry:new e(!0,q.TELEMETRY,[p.persist]),allowUrlQuery:new e(!1,q.URLQUERY,[p.persist]),allowMessaging:new e(!1,
q.NATIVEMESSAGING,[p.persist]),allowConfigSync:new e(!0,q.CFGSRVR,[p.asyncAndPersistent]),asyncScan:new e(!1,q.ASYNCSCAN,[p.persist]),allowStreamFilter:new e(!0,"contentScan",[p.persist,p.firefox]),allowScriptInjection:new e(!0,"scriptInjection",[p.persist]),blockAds:new e(!1,"blockAds",[p.persist]),isGAEnabled:new e(!0,q.GOOGANALYTICS,[p.persist]),isAppConnected:new e(!1,q.NATIVEAPP,[p.persist],{hidden:!0}),autoUpdateContent:new e(!0,"autoUpdateContent",[p.persist]),notificationCallback:new e(function(){},
null,null,{notify:!1}),ADLUrl:new e("https://stnd-ipsg.crsi.symantec.com",null),redirectionUrl:new e("https://www.symantec.com/security_response/safelanding.jsp?asid=",null),configServerUrl:new e("https://static.nortoncdn.com/ips/config/v1/config.json","configServerUrl",[p.persist]),contentServerUrl:new e("https://static.nortoncdn.com/ips/content/v1/content.json","contentServerUrl",[p.persist]),isolationUrl:new e("https://demo.isolation.symantec.com/?url=","isolationUrl",[p.persist]),browserLanguage:new e("en-US",
null),browserName:new e(b.globals.BROWSER,null),GUID:new e("00000000-0000-0000-0000-000000000000",null),watchdogFrequency:new e(f.POLL_FREQUENCY.MAX,"watchdogFrequency",[p.bounded(f.POLL_FREQUENCY.MIN-1,f.POLL_FREQUENCY.MAX),p.persist]),updateCheckFrequency:new e(f.POLL_FREQUENCY.MAX,"updateCheckFrequency",[p.bounded(f.POLL_FREQUENCY.MIN-1,f.POLL_FREQUENCY.MAX),p.persist]),ProductName:new e("None",null),ProductVersion:new e("0.0.0.0",null),browserObject:new e({},u.INVALIDBROWSEROBJ,null,{notify:!1}),
scanAction:new e(f.recommendation.REDIRECT_PAGE,"scanAction",[p.validate,p.persist]),reputationActionHigh:new e(f.recommendation.REDIRECT_PAGE,"reputationActionHigh",[p.validate,p.persist]),reputationActionMed:new e(f.recommendation.APPLY_CSP,"reputationActionMed",[p.validate,p.persist]),parentalControlAction:new e(f.recommendation.BLOCK_PAGE,"parentalControlAction",[p.validate,p.persist]),downloadAction:new e(f.recommendation.ALLOW,"downloadAction",[p.validate,p.persist])};r.AddAccessor=function(a,
b,c,d){d=void 0===d?[]:d;return g.hasOwnProperty(a)?g[a].AddAccessor(b,c,d):!1};r.DropAccessor=function(a,b){return g.hasOwnProperty(a)?g[a].DropAccessor(b):!1};r.Lock=function(a){return g.hasOwnProperty(a)?g[a].Lock():null};r.Unlock=function(a){return g.hasOwnProperty(a)?g[a].Unlock():null};r.Hide=function(a){return g.hasOwnProperty(a)?g[a].Hide():null};r.Unhide=function(a){return g.hasOwnProperty(a)?g[a].Unhide():null};r.NotifyOnChange=function(a,b){return g.hasOwnProperty(a)?g[a].SetNotify(b):
null};r.GetPropertyInfo=function(a){return(a=g[a])?{accessors:a._accessors.map(function(a){return{id:a.__id__,args:a.hasOwnProperty("args")?a.args():void 0}}),locked:a._locked,hidden:a._hidden,notify:a._notify,type:a._type}:null};r.ForceSet=function(a,b){if(!g.hasOwnProperty(a))return!1;var c=null;new r.OverrideLock(function(){c=m.Set(a,b)},g[a]);return c};return m}();m._initFuture=new Promise(function(a,b){m.initialize=function(c){m.initialize=function(){return m._initFuture};c.hasOwnProperty("browserObject")&&
c.hasOwnProperty("notificationCallback")?Object.keys(c).every(function(a){return m.Has(a)?m.Set(a,c[a]):!0})?a(new g.InitResult({self:m},r)):b("Invalid configs"):b(Error("Configs failed to init"));return m._initFuture}});m.OnInitComplete=function(){return this._initFuture};return m}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.cfgctrl=function(b,a){function c(){return new m(function(a,c){fetch(l.Get("configServerUrl"),{method:"GET"}).then(function(a){if(a.ok)return a.json();k.sendWrapper(n.XNE_CATEGORY.REMOTECONFIG,"Notification","Config Server invalid response "+a.status);throw Error("Config server response KO");}).then(function(d){h.JWTVerify(d,n.configServerPKU);var e=d.payload.Throttle;try{if(b.utils.isNil(e)||100<=e)var f=!0;else{var g=$jscomp.makeIterator([17,l.Get("GUID").replace(/-/g,""),0,1]),
u=g.next().value,p=g.next().value,k=g.next().value,q=g.next().value;for(g=0;g<p.length;g++)k+=parseInt(p[g],16)*q,q*=-1;k%=u;k=0>k?u+k:k;r.debug("isThrottleGroup: throttle: "+e+"%  enablement-threshold: "+100*k/u);f=k<e*u/100?!0:!1}}catch(B){r.debug("ConfigSyncControl::isThrottleGroup::"+B),f=!0}!1===f||!1===d.payload.xNDCWeb?a(d.payload):c(d.payload)}).catch(c)},{expiry:n.WEBCONF_RESPONSE_TIMEOUT})}function d(a){function b(a){if(a.hasOwnProperty("filters"))for(var b={"no-apply":function(a,b){return b.includes(l.Get(a))},
apply:function(a,b){return!b.includes(l.Get(a))}},c=$jscomp.makeIterator(Object.keys(a.filters)),d=c.next();!d.done;d=c.next())if(d=d.value,l.Has(d))for(var e=$jscomp.makeIterator(Object.keys(b)),f=e.next();!f.done;f=e.next())if(f=f.value,a.filters[d].hasOwnProperty(f)){var g=a.filters[d][f];if(Array.isArray(g)&&b[f](d,g))return!1}return!0}if(a&&!(a instanceof Error))try{if(a.hasOwnProperty("SignatureExclusions")&&Array.isArray(a.SignatureExclusions)&&v._escalated){var c={add:function(a){v.AddSignatureExclusions(new Set(a))},
remove:function(a){v.RemoveSignatureExclusions(new Set(a))}};a.SignatureExclusions.forEach(function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),d=b.next();!d.done;d=b.next())switch(d=d.value,d.toLowerCase()){case "add":case "remove":var e=a[d];if(Array.isArray(e))c[d](e)}})}if(a.hasOwnProperty("Configuration")&&Array.isArray(a.Configuration))if(l._escalated)a.Configuration.forEach(function(a){if(l.Has(a.key)&&b(a)){var c=a.key;Object.keys(a).forEach(function(b){switch(b.toLowerCase()){case "value":l.ForceSet(c,
a[b]);break;case "lock":1==a[b]?l.Lock(c):l.Unlock(c);break;case "hide":1==a[b]?l.Hide(c):l.Unhide(c);break;case "notify":l.NotifyOnChange(c,1==a[b])}})}});else for(var d=$jscomp.makeIterator(a.Configuration),e=d.next();!e.done;e=d.next()){var f=e.value;l.Has(f.key)&&!l.IsLocked(f.key)&&f.hasOwnProperty("value")&&b(f)&&l.Set(f.key,f.value)}}catch(D){r.debug("RemoteConfigUpdateException: "+D)}}function g(){try{return c().then(function(b){a.init.Disable();return b}).catch(function(b){b&&b.hasOwnProperty("xNDCWeb")&&
1==b.xNDCWeb&&a.init.Enable();return b}).then(d)}catch(u){r.warn("RemoteConfigException: "+u.message)}}function f(b){l=b(l);v=b(a.scanner)}var h=a.common,l=a.config,n=a.constants,k=a.telemetry,r=h.logging.GetLogger("CFGSRVR"),m=h.Contract,t=h.InitResult,v={},w={},y={self:w,pollers:[[g,function(){return l.Get("watchdogFrequency")},null,{name:"watchdog",delayedStart:!0}]]};w.handleAlarm=function(a){"watchdog"==a.name&&(r.debug("handling alarm for config"),g())};w.handleStartup=function(){r.debug("handling startup event for config");
return(new Promise(function(a,b){function d(d){1==d?c().then(b).catch(a):a()}var e=l.Get("allowConfigSync");e instanceof Promise?e.then(d).catch(function(){d(!1)}):d(e)})).then(d).catch(d)};var q=2==chrome.runtime.getManifest().manifest_version?w.handleStartup():new Promise(function(a,b){a()});w._initFuture=q.then(function(a){y.enable=!0;return new t(y,null,f)}).catch(function(a){y.enable=!1;return new t(y,null,f)});w.OnInitComplete=function(){return this._initFuture};return w}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.content=function(b,a){function c(a){return y.xdb.Query().Update(a).Into(v.CONTENT_STORE_NAME).As(E.version).Run()}function d(a){return y.xdb.Query().Update(a).Into(v.CONTENT_STORE_NAME).As(E.content).Run()}function g(){return y.xdb.Query().Select(E.updateAvailable).From(v.CONTENT_STORE_NAME).Run()}function f(a){return y.xdb.Query().Update(a).Into(v.CONTENT_STORE_NAME).As(E.updateAvailable).Run()}function h(a,b){m.notify((new x(0)).Set({message:"Update",version:a,action:b}))}function l(){return new u(function(a,
b){fetch(t.Get("contentServerUrl"),{method:"GET"}).then(function(a){if(a.ok)return a.json();w.doTelemetry(v.telemetry.CATEGORY.REMOTECONF,"xNDC.Web.Notification","Content Server invalid response "+a.status);throw Error("Content server response KO: "+a.status);}).then(function(a){var b=new D(a);return y.xdb.Query().Select(E.version).From(v.CONTENT_STORE_NAME).Run().then(function(a){if(a&&a[0]){if(a[0]>b.version)throw q.error("Stale content on remote"),Error("Stale content on remote");if(a[0]==b.version)throw q.debug("No updates available"),
"No updates available";}return b})}).then(a).catch(b)},{expiry:v.WEBCONF_RESPONSE_TIMEOUT})}function n(){var a=l();a.then(function(a){g().then(function(b){b&&!b[0]&&f(!0).then(function(){h(a.version,"required")})})}).catch(function(){f(!1)});return a}function k(){try{n().then(function(a){t.Get("autoUpdateContent")&&(q.debug("Auto updating content version "+a.version),a.Apply())}).catch(function(a){q.debug("ContentWatch: "+a+" ")})}catch(H){q.warn("[xNDC.Web Warn]: "+H.message)}}function r(b){A=b(a.scanner)}
var m=a.common,t=a.config,v=a.constants,w=a.telemetry,y=a.db,q=m.logging.GetLogger("CONTENT"),u=m.Contract,p=m.InitResult,x=m.GenericResult,A={},z={},E={version:"version",content:"blob",updateAvailable:"isUpdateAvailable"},D=function(a){m.JWTVerify(a,v.configServerPKU);if(!a.payload.version)throw Error("Cannot retrive content version");var b=atob(a.payload.blob);this.content=new Uint8Array(b.length);this.version=a.payload.version;for(a=0;a<b.length;a++)this.content[a]=b.charCodeAt(a)};D.prototype.Apply=
function(){var a=this;if(!A._escalated)throw Error("Does not have privileges to update content");var b=A.UpdateContent(this.content);if(b==v.status.STATUS_OK)return d(this.content).then(function(){return c(a.version).then(function(){return f(!1).then(function(){h(a.version,"success")})})}).catch(function(a){q.debug("Error while saving content: "+a)});A.SetupLastKnownGoodContent();throw Error("Error while applying content: "+b);};var C={self:z,pollers:[[k,function(){return t.Get("updateCheckFrequency")},
null,{name:"contentwatch",delayedStart:!0}]]};z.handleAlarm=function(a){"contentwatch"==a.name&&(q.debug("handling alarm for content"),k())};z.handleStartup=function(){q.debug("handling startup event for content");k()};var G=null;z._initFuture=y.OnInitComplete().then(function(a){return a.self?(g().then(function(a){a&&1==a[0]&&h(null,"required")}),z.Check=function(){return n().then(function(a){G=a;return a.version})},z.Apply=function(){function a(){var a=G.Apply();G=null;return a}return G?a():z.Check().then(a)},
new p(C,null,r)):new p({self:null,error:Error("Content: DB not initialized")})}).catch(function(a){return new p({self:null,error:a})});z.OnInitComplete=function(){return this._initFuture};return z}(b.SymBfw,b.XNE)})(this);var $Reader=protobuf.Reader,$Writer=protobuf.Writer,$util=protobuf.util,$root=protobuf.roots["default"]||(protobuf.roots["default"]={});
$root.StarPulse=function(){var b={};b.ReputationRequest=function(){function b(a){this.WebRequestList=[];if(a)for(var b=Object.keys(a),d=0;d<b.length;++d)null!=a[b[d]]&&(this[b[d]]=a[b[d]])}b.prototype.Version=0;b.prototype.WebRequestList=$util.emptyArray;b.create=function(a){return new b(a)};b.encode=function(a,b){b||(b=$Writer.create());null!=a.Version&&a.hasOwnProperty("Version")&&b.uint32(8).uint32(a.Version);if(null!=a.WebRequestList&&a.WebRequestList.length)for(var c=0;c<a.WebRequestList.length;++c)$root.StarPulse.WebRequest.encode(a.WebRequestList[c],
b.uint32(18).fork()).ldelim();return b};b.encodeDelimited=function(a,b){return this.encode(a,b).ldelim()};b.decode=function(a,b){a instanceof $Reader||(a=$Reader.create(a));b=void 0===b?a.len:a.pos+b;for(var c=new $root.StarPulse.ReputationRequest;a.pos<b;){var d=a.uint32();switch(d>>>3){case 1:c.Version=a.uint32();break;case 2:c.WebRequestList&&c.WebRequestList.length||(c.WebRequestList=[]);c.WebRequestList.push($root.StarPulse.WebRequest.decode(a,a.uint32()));break;default:a.skipType(d&7)}}return c};
b.decodeDelimited=function(a){a instanceof $Reader||(a=new $Reader(a));return this.decode(a,a.uint32())};b.verify=function(a){if("object"!==typeof a||null===a)return"object expected";if(null!=a.Version&&a.hasOwnProperty("Version")&&!$util.isInteger(a.Version))return"Version: integer expected";if(null!=a.WebRequestList&&a.hasOwnProperty("WebRequestList")){if(!Array.isArray(a.WebRequestList))return"WebRequestList: array expected";for(var b=0;b<a.WebRequestList.length;++b){var d=$root.StarPulse.WebRequest.verify(a.WebRequestList[b]);
if(d)return"WebRequestList."+d}}return null};b.fromObject=function(a){if(a instanceof $root.StarPulse.ReputationRequest)return a;var b=new $root.StarPulse.ReputationRequest;null!=a.Version&&(b.Version=a.Version>>>0);if(a.WebRequestList){if(!Array.isArray(a.WebRequestList))throw TypeError(".StarPulse.ReputationRequest.WebRequestList: array expected");b.WebRequestList=[];for(var d=0;d<a.WebRequestList.length;++d){if("object"!==typeof a.WebRequestList[d])throw TypeError(".StarPulse.ReputationRequest.WebRequestList: object expected");
b.WebRequestList[d]=$root.StarPulse.WebRequest.fromObject(a.WebRequestList[d])}}return b};b.toObject=function(a,b){b||(b={});var c={};if(b.arrays||b.defaults)c.WebRequestList=[];b.defaults&&(c.Version=0);null!=a.Version&&a.hasOwnProperty("Version")&&(c.Version=a.Version);if(a.WebRequestList&&a.WebRequestList.length){c.WebRequestList=[];for(var d=0;d<a.WebRequestList.length;++d)c.WebRequestList[d]=$root.StarPulse.WebRequest.toObject(a.WebRequestList[d],b)}return c};b.prototype.toJSON=function(){return this.constructor.toObject(this,
$protobuf.util.toJSONOptions)};return b}();b.ReputationResponse=function(){function b(a){this.WebResponseList=[];if(a)for(var b=Object.keys(a),d=0;d<b.length;++d)null!=a[b[d]]&&(this[b[d]]=a[b[d]])}b.prototype.Version=0;b.prototype.WebResponseList=$util.emptyArray;b.create=function(a){return new b(a)};b.encode=function(a,b){b||(b=$Writer.create());null!=a.Version&&a.hasOwnProperty("Version")&&b.uint32(8).uint32(a.Version);if(null!=a.WebResponseList&&a.WebResponseList.length)for(var c=0;c<a.WebResponseList.length;++c)$root.StarPulse.WebResponse.encode(a.WebResponseList[c],
b.uint32(18).fork()).ldelim();return b};b.encodeDelimited=function(a,b){return this.encode(a,b).ldelim()};b.decode=function(a,b){a instanceof $Reader||(a=$Reader.create(a));b=void 0===b?a.len:a.pos+b;for(var c=new $root.StarPulse.ReputationResponse;a.pos<b;){var d=a.uint32();switch(d>>>3){case 1:c.Version=a.uint32();break;case 2:c.WebResponseList&&c.WebResponseList.length||(c.WebResponseList=[]);c.WebResponseList.push($root.StarPulse.WebResponse.decode(a,a.uint32()));break;default:a.skipType(d&7)}}return c};
b.decodeDelimited=function(a){a instanceof $Reader||(a=new $Reader(a));return this.decode(a,a.uint32())};b.verify=function(a){if("object"!==typeof a||null===a)return"object expected";if(null!=a.Version&&a.hasOwnProperty("Version")&&!$util.isInteger(a.Version))return"Version: integer expected";if(null!=a.WebResponseList&&a.hasOwnProperty("WebResponseList")){if(!Array.isArray(a.WebResponseList))return"WebResponseList: array expected";for(var b=0;b<a.WebResponseList.length;++b){var d=$root.StarPulse.WebResponse.verify(a.WebResponseList[b]);
if(d)return"WebResponseList."+d}}return null};b.fromObject=function(a){if(a instanceof $root.StarPulse.ReputationResponse)return a;var b=new $root.StarPulse.ReputationResponse;null!=a.Version&&(b.Version=a.Version>>>0);if(a.WebResponseList){if(!Array.isArray(a.WebResponseList))throw TypeError(".StarPulse.ReputationResponse.WebResponseList: array expected");b.WebResponseList=[];for(var d=0;d<a.WebResponseList.length;++d){if("object"!==typeof a.WebResponseList[d])throw TypeError(".StarPulse.ReputationResponse.WebResponseList: object expected");
b.WebResponseList[d]=$root.StarPulse.WebResponse.fromObject(a.WebResponseList[d])}}return b};b.toObject=function(a,b){b||(b={});var c={};if(b.arrays||b.defaults)c.WebResponseList=[];b.defaults&&(c.Version=0);null!=a.Version&&a.hasOwnProperty("Version")&&(c.Version=a.Version);if(a.WebResponseList&&a.WebResponseList.length){c.WebResponseList=[];for(var d=0;d<a.WebResponseList.length;++d)c.WebResponseList[d]=$root.StarPulse.WebResponse.toObject(a.WebResponseList[d],b)}return c};b.prototype.toJSON=function(){return this.constructor.toObject(this,
$protobuf.util.toJSONOptions)};return b}();b.WebRequest=function(){function b(a){if(a)for(var b=Object.keys(a),d=0;d<b.length;++d)null!=a[b[d]]&&(this[b[d]]=a[b[d]])}b.prototype.QueryID=0;b.prototype.RequestType=0;b.prototype.Url="";b.prototype.RequestReason=0;b.prototype.Method="";b.prototype.DestinationIP="";b.prototype.ReferrerURL="";b.prototype.BrowserURL="";b.prototype.IsUserActive=!1;b.prototype.CacheHits=0;b.prototype.InterceptedUserAgent="";b.prototype.InterceptedContentLength=0;b.prototype.InterceptedContentType=
"";b.prototype.InterceptedXRequestedWith="";b.prototype.ProcessPath="";b.prototype.ProcessSHA256=$util.newBuffer([]);b.prototype.RequestMode=0;b.create=function(a){return new b(a)};b.encode=function(a,b){b||(b=$Writer.create());null!=a.QueryID&&a.hasOwnProperty("QueryID")&&b.uint32(8).uint32(a.QueryID);null!=a.RequestType&&a.hasOwnProperty("RequestType")&&b.uint32(16).int32(a.RequestType);null!=a.Url&&a.hasOwnProperty("Url")&&b.uint32(26).string(a.Url);null!=a.RequestReason&&a.hasOwnProperty("RequestReason")&&
b.uint32(32).int32(a.RequestReason);null!=a.Method&&a.hasOwnProperty("Method")&&b.uint32(42).string(a.Method);null!=a.DestinationIP&&a.hasOwnProperty("DestinationIP")&&b.uint32(50).string(a.DestinationIP);null!=a.ReferrerURL&&a.hasOwnProperty("ReferrerURL")&&b.uint32(58).string(a.ReferrerURL);null!=a.BrowserURL&&a.hasOwnProperty("BrowserURL")&&b.uint32(66).string(a.BrowserURL);null!=a.IsUserActive&&a.hasOwnProperty("IsUserActive")&&b.uint32(72).bool(a.IsUserActive);null!=a.CacheHits&&a.hasOwnProperty("CacheHits")&&
b.uint32(80).uint32(a.CacheHits);null!=a.InterceptedUserAgent&&a.hasOwnProperty("InterceptedUserAgent")&&b.uint32(90).string(a.InterceptedUserAgent);null!=a.InterceptedContentLength&&a.hasOwnProperty("InterceptedContentLength")&&b.uint32(96).uint32(a.InterceptedContentLength);null!=a.InterceptedContentType&&a.hasOwnProperty("InterceptedContentType")&&b.uint32(106).string(a.InterceptedContentType);null!=a.InterceptedXRequestedWith&&a.hasOwnProperty("InterceptedXRequestedWith")&&b.uint32(114).string(a.InterceptedXRequestedWith);
null!=a.ProcessPath&&a.hasOwnProperty("ProcessPath")&&b.uint32(122).string(a.ProcessPath);null!=a.ProcessSHA256&&a.hasOwnProperty("ProcessSHA256")&&b.uint32(130).bytes(a.ProcessSHA256);null!=a.RequestMode&&a.hasOwnProperty("RequestMode")&&b.uint32(136).int32(a.RequestMode);return b};b.encodeDelimited=function(a,b){return this.encode(a,b).ldelim()};b.decode=function(a,b){a instanceof $Reader||(a=$Reader.create(a));b=void 0===b?a.len:a.pos+b;for(var c=new $root.StarPulse.WebRequest;a.pos<b;){var d=
a.uint32();switch(d>>>3){case 1:c.QueryID=a.uint32();break;case 2:c.RequestType=a.int32();break;case 3:c.Url=a.string();break;case 4:c.RequestReason=a.int32();break;case 5:c.Method=a.string();break;case 6:c.DestinationIP=a.string();break;case 7:c.ReferrerURL=a.string();break;case 8:c.BrowserURL=a.string();break;case 9:c.IsUserActive=a.bool();break;case 10:c.CacheHits=a.uint32();break;case 11:c.InterceptedUserAgent=a.string();break;case 12:c.InterceptedContentLength=a.uint32();break;case 13:c.InterceptedContentType=
a.string();break;case 14:c.InterceptedXRequestedWith=a.string();break;case 15:c.ProcessPath=a.string();break;case 16:c.ProcessSHA256=a.bytes();break;case 17:c.RequestMode=a.int32();break;default:a.skipType(d&7)}}return c};b.decodeDelimited=function(a){a instanceof $Reader||(a=new $Reader(a));return this.decode(a,a.uint32())};b.verify=function(a){if("object"!==typeof a||null===a)return"object expected";if(null!=a.QueryID&&a.hasOwnProperty("QueryID")&&!$util.isInteger(a.QueryID))return"QueryID: integer expected";
if(null!=a.RequestType&&a.hasOwnProperty("RequestType"))switch(a.RequestType){default:return"RequestType: enum value expected";case 0:case 1:}if(null!=a.Url&&a.hasOwnProperty("Url")&&!$util.isString(a.Url))return"Url: string expected";if(null!=a.RequestReason&&a.hasOwnProperty("RequestReason"))switch(a.RequestReason){default:return"RequestReason: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:}if(null!=a.Method&&a.hasOwnProperty("Method")&&!$util.isString(a.Method))return"Method: string expected";
if(null!=a.DestinationIP&&a.hasOwnProperty("DestinationIP")&&!$util.isString(a.DestinationIP))return"DestinationIP: string expected";if(null!=a.ReferrerURL&&a.hasOwnProperty("ReferrerURL")&&!$util.isString(a.ReferrerURL))return"ReferrerURL: string expected";if(null!=a.BrowserURL&&a.hasOwnProperty("BrowserURL")&&!$util.isString(a.BrowserURL))return"BrowserURL: string expected";if(null!=a.IsUserActive&&a.hasOwnProperty("IsUserActive")&&"boolean"!==typeof a.IsUserActive)return"IsUserActive: boolean expected";
if(null!=a.CacheHits&&a.hasOwnProperty("CacheHits")&&!$util.isInteger(a.CacheHits))return"CacheHits: integer expected";if(null!=a.InterceptedUserAgent&&a.hasOwnProperty("InterceptedUserAgent")&&!$util.isString(a.InterceptedUserAgent))return"InterceptedUserAgent: string expected";if(null!=a.InterceptedContentLength&&a.hasOwnProperty("InterceptedContentLength")&&!$util.isInteger(a.InterceptedContentLength))return"InterceptedContentLength: integer expected";if(null!=a.InterceptedContentType&&a.hasOwnProperty("InterceptedContentType")&&
!$util.isString(a.InterceptedContentType))return"InterceptedContentType: string expected";if(null!=a.InterceptedXRequestedWith&&a.hasOwnProperty("InterceptedXRequestedWith")&&!$util.isString(a.InterceptedXRequestedWith))return"InterceptedXRequestedWith: string expected";if(null!=a.ProcessPath&&a.hasOwnProperty("ProcessPath")&&!$util.isString(a.ProcessPath))return"ProcessPath: string expected";if(null!=a.ProcessSHA256&&a.hasOwnProperty("ProcessSHA256")&&!(a.ProcessSHA256&&"number"===typeof a.ProcessSHA256.length||
$util.isString(a.ProcessSHA256)))return"ProcessSHA256: buffer expected";if(null!=a.RequestMode&&a.hasOwnProperty("RequestMode"))switch(a.RequestMode){default:return"RequestMode: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null};b.fromObject=function(a){if(a instanceof $root.StarPulse.WebRequest)return a;var b=new $root.StarPulse.WebRequest;null!=a.QueryID&&(b.QueryID=a.QueryID>>>0);switch(a.RequestType){case "NONE":case 0:b.RequestType=0;break;case "URL":case 1:b.RequestType=
1}null!=a.Url&&(b.Url=String(a.Url));switch(a.RequestReason){case "UNKNOWN":case 0:b.RequestReason=0;break;case "OTHER":case 1:b.RequestReason=1;break;case "BROWSER_INSPECTION":case 2:b.RequestReason=2;break;case "NETWORK_INSPECTION":case 3:b.RequestReason=3;break;case "FILE_INSPECTION":case 4:b.RequestReason=4;break;case "EMAIL_INSPECTION":case 5:b.RequestReason=5}null!=a.Method&&(b.Method=String(a.Method));null!=a.DestinationIP&&(b.DestinationIP=String(a.DestinationIP));null!=a.ReferrerURL&&(b.ReferrerURL=
String(a.ReferrerURL));null!=a.BrowserURL&&(b.BrowserURL=String(a.BrowserURL));null!=a.IsUserActive&&(b.IsUserActive=!!a.IsUserActive);null!=a.CacheHits&&(b.CacheHits=a.CacheHits>>>0);null!=a.InterceptedUserAgent&&(b.InterceptedUserAgent=String(a.InterceptedUserAgent));null!=a.InterceptedContentLength&&(b.InterceptedContentLength=a.InterceptedContentLength>>>0);null!=a.InterceptedContentType&&(b.InterceptedContentType=String(a.InterceptedContentType));null!=a.InterceptedXRequestedWith&&(b.InterceptedXRequestedWith=
String(a.InterceptedXRequestedWith));null!=a.ProcessPath&&(b.ProcessPath=String(a.ProcessPath));null!=a.ProcessSHA256&&("string"===typeof a.ProcessSHA256?$util.base64.decode(a.ProcessSHA256,b.ProcessSHA256=$util.newBuffer($util.base64.length(a.ProcessSHA256)),0):a.ProcessSHA256.length&&(b.ProcessSHA256=a.ProcessSHA256));switch(a.RequestMode){case "UNKNOWN_MODE":case 0:b.RequestMode=0;break;case "NO_DRTR":case 1:b.RequestMode=1;break;case "REAL_TIME":case 2:b.RequestMode=2;break;case "BACKGROUND":case 3:b.RequestMode=
3;break;case "CACHE_HIT_UPDATE":case 4:b.RequestMode=4;break;case "MALWARE_URL":case 5:b.RequestMode=5;break;case "FEEDBACK":case 6:b.RequestMode=6;break;case "PREEMPTIVE":case 7:b.RequestMode=7}return b};b.toObject=function(a,b){b||(b={});var c={};b.defaults&&(c.QueryID=0,c.RequestType=b.enums===String?"NONE":0,c.Url="",c.RequestReason=b.enums===String?"UNKNOWN":0,c.Method="",c.DestinationIP="",c.ReferrerURL="",c.BrowserURL="",c.IsUserActive=!1,c.CacheHits=0,c.InterceptedUserAgent="",c.InterceptedContentLength=
0,c.InterceptedContentType="",c.InterceptedXRequestedWith="",c.ProcessPath="",b.bytes===String?c.ProcessSHA256="":(c.ProcessSHA256=[],b.bytes!==Array&&(c.ProcessSHA256=$util.newBuffer(c.ProcessSHA256))),c.RequestMode=b.enums===String?"UNKNOWN_MODE":0);null!=a.QueryID&&a.hasOwnProperty("QueryID")&&(c.QueryID=a.QueryID);null!=a.RequestType&&a.hasOwnProperty("RequestType")&&(c.RequestType=b.enums===String?$root.StarPulse.WebRequest.WebRequestType[a.RequestType]:a.RequestType);null!=a.Url&&a.hasOwnProperty("Url")&&
(c.Url=a.Url);null!=a.RequestReason&&a.hasOwnProperty("RequestReason")&&(c.RequestReason=b.enums===String?$root.StarPulse.WebRequest.WebRequestReason[a.RequestReason]:a.RequestReason);null!=a.Method&&a.hasOwnProperty("Method")&&(c.Method=a.Method);null!=a.DestinationIP&&a.hasOwnProperty("DestinationIP")&&(c.DestinationIP=a.DestinationIP);null!=a.ReferrerURL&&a.hasOwnProperty("ReferrerURL")&&(c.ReferrerURL=a.ReferrerURL);null!=a.BrowserURL&&a.hasOwnProperty("BrowserURL")&&(c.BrowserURL=a.BrowserURL);
null!=a.IsUserActive&&a.hasOwnProperty("IsUserActive")&&(c.IsUserActive=a.IsUserActive);null!=a.CacheHits&&a.hasOwnProperty("CacheHits")&&(c.CacheHits=a.CacheHits);null!=a.InterceptedUserAgent&&a.hasOwnProperty("InterceptedUserAgent")&&(c.InterceptedUserAgent=a.InterceptedUserAgent);null!=a.InterceptedContentLength&&a.hasOwnProperty("InterceptedContentLength")&&(c.InterceptedContentLength=a.InterceptedContentLength);null!=a.InterceptedContentType&&a.hasOwnProperty("InterceptedContentType")&&(c.InterceptedContentType=
a.InterceptedContentType);null!=a.InterceptedXRequestedWith&&a.hasOwnProperty("InterceptedXRequestedWith")&&(c.InterceptedXRequestedWith=a.InterceptedXRequestedWith);null!=a.ProcessPath&&a.hasOwnProperty("ProcessPath")&&(c.ProcessPath=a.ProcessPath);null!=a.ProcessSHA256&&a.hasOwnProperty("ProcessSHA256")&&(c.ProcessSHA256=b.bytes===String?$util.base64.encode(a.ProcessSHA256,0,a.ProcessSHA256.length):b.bytes===Array?Array.prototype.slice.call(a.ProcessSHA256):a.ProcessSHA256);null!=a.RequestMode&&
a.hasOwnProperty("RequestMode")&&(c.RequestMode=b.enums===String?$root.StarPulse.WebRequest.WebRequestMode[a.RequestMode]:a.RequestMode);return c};b.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)};b.WebRequestType=function(){var a={},b=Object.create(a);b[a[0]="NONE"]=0;b[a[1]="URL"]=1;return b}();b.WebRequestReason=function(){var a={},b=Object.create(a);b[a[0]="UNKNOWN"]=0;b[a[1]="OTHER"]=1;b[a[2]="BROWSER_INSPECTION"]=2;b[a[3]="NETWORK_INSPECTION"]=
3;b[a[4]="FILE_INSPECTION"]=4;b[a[5]="EMAIL_INSPECTION"]=5;return b}();b.WebRequestMode=function(){var a={},b=Object.create(a);b[a[0]="UNKNOWN_MODE"]=0;b[a[1]="NO_DRTR"]=1;b[a[2]="REAL_TIME"]=2;b[a[3]="BACKGROUND"]=3;b[a[4]="CACHE_HIT_UPDATE"]=4;b[a[5]="MALWARE_URL"]=5;b[a[6]="FEEDBACK"]=6;b[a[7]="PREEMPTIVE"]=7;return b}();return b}();b.WebResponse=function(){function b(a){this.CategoryInfo=[];if(a)for(var b=Object.keys(a),d=0;d<b.length;++d)null!=a[b[d]]&&(this[b[d]]=a[b[d]])}b.prototype.QueryID=
0;b.prototype.ResponseCode=0;b.prototype.RiskLevel=0;b.prototype.CategoryInfo=$util.emptyArray;b.prototype.Application="";b.prototype.Operation="";b.prototype.LevelToCache=0;b.prototype.TimeToLive=0;b.create=function(a){return new b(a)};b.encode=function(a,b){b||(b=$Writer.create());null!=a.QueryID&&a.hasOwnProperty("QueryID")&&b.uint32(8).uint32(a.QueryID);null!=a.ResponseCode&&a.hasOwnProperty("ResponseCode")&&b.uint32(16).uint32(a.ResponseCode);null!=a.RiskLevel&&a.hasOwnProperty("RiskLevel")&&
b.uint32(24).uint32(a.RiskLevel);if(null!=a.CategoryInfo&&a.CategoryInfo.length)for(var c=0;c<a.CategoryInfo.length;++c)$root.StarPulse.WebResponse.CategoryType.encode(a.CategoryInfo[c],b.uint32(34).fork()).ldelim();null!=a.Application&&a.hasOwnProperty("Application")&&b.uint32(42).string(a.Application);null!=a.Operation&&a.hasOwnProperty("Operation")&&b.uint32(50).string(a.Operation);null!=a.LevelToCache&&a.hasOwnProperty("LevelToCache")&&b.uint32(56).int32(a.LevelToCache);null!=a.TimeToLive&&a.hasOwnProperty("TimeToLive")&&
b.uint32(64).uint32(a.TimeToLive);return b};b.encodeDelimited=function(a,b){return this.encode(a,b).ldelim()};b.decode=function(a,b){a instanceof $Reader||(a=$Reader.create(a));b=void 0===b?a.len:a.pos+b;for(var c=new $root.StarPulse.WebResponse;a.pos<b;){var d=a.uint32();switch(d>>>3){case 1:c.QueryID=a.uint32();break;case 2:c.ResponseCode=a.uint32();break;case 3:c.RiskLevel=a.uint32();break;case 4:c.CategoryInfo&&c.CategoryInfo.length||(c.CategoryInfo=[]);c.CategoryInfo.push($root.StarPulse.WebResponse.CategoryType.decode(a,
a.uint32()));break;case 5:c.Application=a.string();break;case 6:c.Operation=a.string();break;case 7:c.LevelToCache=a.int32();break;case 8:c.TimeToLive=a.uint32();break;default:a.skipType(d&7)}}return c};b.decodeDelimited=function(a){a instanceof $Reader||(a=new $Reader(a));return this.decode(a,a.uint32())};b.verify=function(a){if("object"!==typeof a||null===a)return"object expected";if(null!=a.QueryID&&a.hasOwnProperty("QueryID")&&!$util.isInteger(a.QueryID))return"QueryID: integer expected";if(null!=
a.ResponseCode&&a.hasOwnProperty("ResponseCode")&&!$util.isInteger(a.ResponseCode))return"ResponseCode: integer expected";if(null!=a.RiskLevel&&a.hasOwnProperty("RiskLevel")&&!$util.isInteger(a.RiskLevel))return"RiskLevel: integer expected";if(null!=a.CategoryInfo&&a.hasOwnProperty("CategoryInfo")){if(!Array.isArray(a.CategoryInfo))return"CategoryInfo: array expected";for(var b=0;b<a.CategoryInfo.length;++b){var d=$root.StarPulse.WebResponse.CategoryType.verify(a.CategoryInfo[b]);if(d)return"CategoryInfo."+
d}}if(null!=a.Application&&a.hasOwnProperty("Application")&&!$util.isString(a.Application))return"Application: string expected";if(null!=a.Operation&&a.hasOwnProperty("Operation")&&!$util.isString(a.Operation))return"Operation: string expected";if(null!=a.LevelToCache&&a.hasOwnProperty("LevelToCache"))switch(a.LevelToCache){default:return"LevelToCache: enum value expected";case 0:case 1:case 2:case 3:}return null!=a.TimeToLive&&a.hasOwnProperty("TimeToLive")&&!$util.isInteger(a.TimeToLive)?"TimeToLive: integer expected":
null};b.fromObject=function(a){if(a instanceof $root.StarPulse.WebResponse)return a;var b=new $root.StarPulse.WebResponse;null!=a.QueryID&&(b.QueryID=a.QueryID>>>0);null!=a.ResponseCode&&(b.ResponseCode=a.ResponseCode>>>0);null!=a.RiskLevel&&(b.RiskLevel=a.RiskLevel>>>0);if(a.CategoryInfo){if(!Array.isArray(a.CategoryInfo))throw TypeError(".StarPulse.WebResponse.CategoryInfo: array expected");b.CategoryInfo=[];for(var d=0;d<a.CategoryInfo.length;++d){if("object"!==typeof a.CategoryInfo[d])throw TypeError(".StarPulse.WebResponse.CategoryInfo: object expected");
b.CategoryInfo[d]=$root.StarPulse.WebResponse.CategoryType.fromObject(a.CategoryInfo[d])}}null!=a.Application&&(b.Application=String(a.Application));null!=a.Operation&&(b.Operation=String(a.Operation));switch(a.LevelToCache){case "DOMAIN_LEVEL":case 0:b.LevelToCache=0;break;case "DIRECTORY_LEVEL":case 1:b.LevelToCache=1;break;case "FILE_LEVEL":case 2:b.LevelToCache=2;break;case "NONE_LEVEL":case 3:b.LevelToCache=3}null!=a.TimeToLive&&(b.TimeToLive=a.TimeToLive>>>0);return b};b.toObject=function(a,
b){b||(b={});var c={};if(b.arrays||b.defaults)c.CategoryInfo=[];b.defaults&&(c.QueryID=0,c.ResponseCode=0,c.RiskLevel=0,c.Application="",c.Operation="",c.LevelToCache=b.enums===String?"DOMAIN_LEVEL":0,c.TimeToLive=0);null!=a.QueryID&&a.hasOwnProperty("QueryID")&&(c.QueryID=a.QueryID);null!=a.ResponseCode&&a.hasOwnProperty("ResponseCode")&&(c.ResponseCode=a.ResponseCode);null!=a.RiskLevel&&a.hasOwnProperty("RiskLevel")&&(c.RiskLevel=a.RiskLevel);if(a.CategoryInfo&&a.CategoryInfo.length){c.CategoryInfo=
[];for(var d=0;d<a.CategoryInfo.length;++d)c.CategoryInfo[d]=$root.StarPulse.WebResponse.CategoryType.toObject(a.CategoryInfo[d],b)}null!=a.Application&&a.hasOwnProperty("Application")&&(c.Application=a.Application);null!=a.Operation&&a.hasOwnProperty("Operation")&&(c.Operation=a.Operation);null!=a.LevelToCache&&a.hasOwnProperty("LevelToCache")&&(c.LevelToCache=b.enums===String?$root.StarPulse.WebResponse.CacheLevel[a.LevelToCache]:a.LevelToCache);null!=a.TimeToLive&&a.hasOwnProperty("TimeToLive")&&
(c.TimeToLive=a.TimeToLive);return c};b.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)};b.CategoryType=function(){function a(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)null!=a[b[c]]&&(this[b[c]]=a[b[c]])}a.prototype.CategoryValue=0;a.create=function(b){return new a(b)};a.encode=function(a,b){b||(b=$Writer.create());null!=a.CategoryValue&&a.hasOwnProperty("CategoryValue")&&b.uint32(8).uint32(a.CategoryValue);return b};a.encodeDelimited=function(a,
b){return this.encode(a,b).ldelim()};a.decode=function(a,b){a instanceof $Reader||(a=$Reader.create(a));b=void 0===b?a.len:a.pos+b;for(var c=new $root.StarPulse.WebResponse.CategoryType;a.pos<b;){var d=a.uint32();switch(d>>>3){case 1:c.CategoryValue=a.uint32();break;default:a.skipType(d&7)}}return c};a.decodeDelimited=function(a){a instanceof $Reader||(a=new $Reader(a));return this.decode(a,a.uint32())};a.verify=function(a){return"object"!==typeof a||null===a?"object expected":null!=a.CategoryValue&&
a.hasOwnProperty("CategoryValue")&&!$util.isInteger(a.CategoryValue)?"CategoryValue: integer expected":null};a.fromObject=function(a){if(a instanceof $root.StarPulse.WebResponse.CategoryType)return a;var b=new $root.StarPulse.WebResponse.CategoryType;null!=a.CategoryValue&&(b.CategoryValue=a.CategoryValue>>>0);return b};a.toObject=function(a,b){b||(b={});var c={};b.defaults&&(c.CategoryValue=0);null!=a.CategoryValue&&a.hasOwnProperty("CategoryValue")&&(c.CategoryValue=a.CategoryValue);return c};a.prototype.toJSON=
function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)};return a}();b.CacheLevel=function(){var a={},b=Object.create(a);b[a[0]="DOMAIN_LEVEL"]=0;b[a[1]="DIRECTORY_LEVEL"]=1;b[a[2]="FILE_LEVEL"]=2;b[a[3]="NONE_LEVEL"]=3;return b}();return b}();return b}();(function(b){b.XNE.urlCache=function(b,a){var c=a.common.logging.GetLogger("CACHE"),d=a.common,g=d.GenericResult,f=d.ParsedUrl;b={};var h=function(b,c){return a.cacheImpl.Cache.call(this,b,c)||this};$jscomp.inherits(h,a.cacheImpl.Cache);h.prototype.Insert=function(b,e,f){return b?a.cacheImpl.Cache.prototype.Insert.call(this,d.hash.SHA256(b),e,f):(c.debug("ReputationCache::Insert: Null URL"),!1)};h.prototype.InsertVolatile=function(b,e,f){return b?a.cacheImpl.Cache.prototype.InsertVolatile.call(this,
d.hash.SHA256(b),e,f):(c.debug("ReputationCache::InsertVolatile: Null URL"),!1)};h.prototype.Remove=function(b){return b?a.cacheImpl.Cache.prototype.Remove.call(this,d.hash.SHA256(b)):(c.debug("ReputationCache::Remove: Null URL"),!1)};h.prototype.GetEx=function(b){b=new f(b);return a.cacheImpl.Cache.prototype.GetEx.call(this,b.HostHash())||a.cacheImpl.Cache.prototype.GetEx.call(this,b.DirectoryHash())||a.cacheImpl.Cache.prototype.GetEx.call(this,b.PathHash())};h.prototype.Get=function(b){var c=new f(b),
d=a.cacheImpl.Cache.prototype.Get.call(this,c.HostHash())||a.cacheImpl.Cache.prototype.Get.call(this,c.DirectoryHash())||a.cacheImpl.Cache.prototype.Get.call(this,c.PathHash());return d?(d.toGenericResult=function(a,c){c=void 0===c?{}:c;return(new g(0,a,{url:b,categories:d.categories})).Set(d.risk).SetOptional(c)},d):null};b.reputationManager=new h("Reputation",a.constants.CACHE_LIMIT);b.reputationManager.policy=a.cacheImpl.Cache.Policy.FIFO;return b}(b.SymBfw,XNE)})(this);(function(b){b.XNE.connection=function(b){function a(a,b){b=void 0===b?{}:b;return k.create({Version:1,WebRequestList:[{QueryID:Infinity===++m?m=1:m,RequestType:n.WebRequest.WebRequestType.URL,Url:a,RequestReason:n.WebRequest.WebRequestReason.BROWSER_INSPECTION,Method:b.method||null,BrowserURL:b.documentUrl||null,ReferrerURL:b.originUrl||null,RequestMode:n.WebRequest.WebRequestMode.REAL_TIME,InterceptedUserAgent:navigator.userAgent}]})}b={};var c=["host","directory"],d=XNE.common,g=d.logging.GetLogger("WPCON"),
f=XNE.constants,h=XNE.urlCache,l=XNE.config,n=(protobuf.roots["default"]||(protobuf.roots["default"]={})).StarPulse,k=n.ReputationRequest,r=n.ReputationResponse,m=1;b.fetchReputation=function(b,e){e=void 0===e?{}:e;try{var v=new XNE.common.ParsedUrl(b),m=fetch(f.WEBPULSE_URL,{method:"POST",headers:new Headers({"Content-Type":"application/json;charset=UTF-8","X-Prod-Name":l.Get("ProductName"),"X-Prod-Ver":l.Get("ProductVersion"),"X-Platform-GUID":l.Get("GUID")}),body:k.encode(a(d.url.PIIClean(b),e)).finish()}).then(function(a){if(a.ok)return a.arrayBuffer();
throw Error("Reputation response KO: "+a.status);}).then(function(a){var e=r.decode(new Uint8Array(a));a=e.WebResponseList[0].RiskLevel;var f=e.WebResponseList[0].TimeToLive,g=e.WebResponseList[0].CategoryInfo,k=e.WebResponseList[0].ResponseCode,q=e.WebResponseList[0].LevelToCache;e=[];if(1>a||10<a)throw Error("WebPulse returned an invalid reputation ("+b+": "+a+")");g=$jscomp.makeIterator(g);for(var l=g.next();!l.done;l=g.next())e.push(l.value.CategoryValue);var m={risk:a,categories:e};switch(q){case 0:case 1:h.reputationManager.Insert(v[c[q]],
m,f);h.reputationManager.Remove(v.path);break;default:h.reputationManager.InsertVolatile(v.path,m,f)}m.status=k;m.toGenericResult=function(a,c){c=void 0===c?{}:c;return(new d.GenericResult(m.status,a,{url:b,categories:m.categories,cacheLevel:q})).Set(m.risk).SetOptional(c)};return m});h.reputationManager.InsertVolatile(v.path,m);m.catch(function(){h.reputationManager.Remove(v.path)});return m}catch(q){return g.debug("Exception while fetching reputation: "+q),Promise.reject(q)}};return b}(b.SymBfw)})(this);(function(b){b.XNE.exclusionManager=function(b,a){a.common.logging.GetLogger("EXCMAN");var c=a.constants,d=new a.cacheImpl.Cache(c.URL_EXCLUSION_STORE_NAME,c.EXCLUSION_LIMIT);d.policy=a.cacheImpl.Cache.Policy.FIFO;b={AddExclusion:function(a,b){b=void 0===b?"noTab":b;try{var e=(new URL(a)).hostname;if(!1===d.Insert(e,b,c.EXCLUSION_TTL))throw Error("Unable to insert exclusion to cache");}catch(l){throw Error("Exception while adding exclusion (host: "+e+") (error: "+l+")");}},IsExcluded:function(a,b){b=
void 0===b?null:b;try{var c=null;return(c=d.Get((new URL(a)).hostname))?"noTab"==c||c==b:!1}catch(l){return!1}},DropExclusion:function(a){try{var b=(new URL(a)).hostname;if(d.Has(b))return d.Remove(b),!0}catch(h){}return!1},Size:function(){return d.Size()},handleStartup:function(){d.Clear()}};b._initFuture=d.OnInitComplete();return b}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.repManager=function(b,a){var c=a.urlCache,d=a.connection,g=a.config,f=a.constants,h=b.logger,l=b.utils.isNil,n=a.common;h=a.common.logging.GetLogger("REP-LU");var k=n.GenericResult,r=n.Contract,m=n.InitResult,t={IsTrustedHost:function(a){var b=a.split("."),c=b.length;2<c&&(a=b[c-2]+"."+b[c-1],2==b[c-2].length&&2==b[c-1].length&&(a=b[c-3]+"."+a));return f.TRUSTED_DOMAINS.includes(a)},GetReputation:function(a,b){b=void 0===b?{tabId:null}:b;var e=null;e=null;n.url.isValidHttp(a)?(e=
c.reputationManager.GetEx(a),l(e)?(h.debug("No cache for "+a+", fetching..."),e=d.fetchReputation(a,b).then(function(c){return(new k(c.status,b.tabId,{url:a,isExcluded:!1})).Set(c.risk)})):e instanceof Promise||e instanceof r?(h.debug("Still resolving reputation..."),e=e.then(function(c){return(new k(c.status,b.tabId,{url:a,isExcluded:!1})).Set(c.risk)})):(h.debug("Resolving reputation from cache: "+a+" <-- "+e),e=Promise.resolve((new k(0,b.tabId,{url:a,isExcluded:!1})).Set(e.risk)))):e=Promise.reject("Invalid URL");
e.then(function(b){h.debug("Resolved reputation for "+a+" --\x3e "+b.reputation)}).catch(function(a){h.error("[xNDC.Web Error]: Error while reputation fetch: "+a)});return e},OnInitComplete:function(){return g.OnInitComplete().then(function(){return new m({self:t})}).catch(function(a){return new m({self:null,error:a})})}};return t}(b.SymBfw,b.XNE)})(this);(function(b){b.XNE.scanner=function(b,a){var c=b.utils.isNil;b=a.common;var d=a.constants,g=a.db,f=b.logging.GetLogger("SCAN I/F"),h=b.Contract,l=b.GenericResult,n=b.InitResult,k=d.status.scanner,r=function(){},m={},t=function(a,b,c){a=void 0===a?d.MAX_HEAP:a;b=void 0===b?ALLOC_NORMAL:b;if(!t.instance){this.maxHeap=a;this.current=0;this.allowDynamicAlloc=void 0===c?!0:c;this.isHeapInit=!1;this.allocType=b;this.pool=void 0;try{this.pool=allocate(this.maxHeap,"i32*",this.allocType),this.isHeapInit=
!0}catch(q){if(f.debug("Error: Exception while pre-allocating heap: "+q.message),this.allowDynamicAlloc)f.debug("Falling back to dynamic heap allocation"),this.allocType=ALLOC_STACK;else throw q;}t.instance=this}return t.instance};t.prototype.WrapIfNeeded=function(a){return a>this.maxHeap-this.current?(this.current=0,!0):!1};t.prototype.AllocateString=function(a){if(!this.isHeapInit&&!this.allowDynamicAlloc)throw f.debug("Error: No heap is preallocated and dynamic allocation is not allowed"),Error("No heap is preallocated and dynamic allocation is not allowed");
if(a.length>this.maxHeap)throw f.debug("Error: Buffer too large to handle: "+a.length),Error("Buffer too large to handle");var b=a.length+1;this.WrapIfNeeded(b);if(this.isHeapInit){var c=this.pool+this.current;stringToUTF8(a,c,a.length+1);this.current+=b+(4-b%4)}else a=intArrayFromString(a),c=allocate(a,"i8",this.allocType);return c};t.prototype.AllocateIntArray=function(a){if(!this.isHeapInit&&!this.allowDynamicAlloc)throw f.debug("Error: No heap is preallocated and dynamic allocation is not allowed"),
Error("No heap is preallocated and dynamic allocation is not allowed");if("number"!=typeof a&&!(a instanceof Uint32Array))throw Error('Invalid param "arrayOrSize". Must be an Uint32Array or a number');var b=a instanceof Uint32Array?a.byteLength:a*Uint32Array.BYTES_PER_ELEMENT;if(0==b||b>this.maxHeap)throw f.error("Requested allocation size <"+b+"> is invalid or too large to handle"),Error("Requested allocation size <"+b+"> is invalid or too large to handle");this.WrapIfNeeded(b);if(this.isHeapInit){var c=
this.pool+this.current;this.current+=b}else c=allocate(b,"i8",this.allocType);c&&a instanceof Uint32Array&&HEAPU32.set(a,c>>2);return c};t.prototype.MakeIntArray=function(a,b){return new Uint32Array(HEAPU8.buffer,a,b)};t.prototype.SetForceDynamicAllocation=function(a){a?(this.isHeapInit=!1,this.allowDynamicAlloc=!0,this.allocType=ALLOC_STACK):this.isHeapInit=!0};t.prototype.SetAllocationType=function(a){[ALLOC_NORMAL,ALLOC_STACK,ALLOC_STATIC,ALLOC_DYNAMIC,ALLOC_NONE].includes(a)&&(this.allocType=
a)};$jscomp.global.Object.defineProperties(t.prototype,{GetMaxHeap:{configurable:!0,enumerable:!0,get:function(){return this.maxHeap}}});m.MakeContractId=function(a,b,c){return a.toString()+":"+b+":"+c.toString()};m.ScanBuffer=function(){return new l(k.ERR_WASM_NOT_INIT,null,{error:"ScannerInterface not initialized"})};m.ScanBufferAsync=function(){return h.reject(Error("ScannerInterface not initialized"))};m.ScanBufferOOB=function(){return h.reject(Error("Scanner not initialized"))};m.removeTab=function(){return k.ERR_WASM_NOT_INIT};
m.EndSession=function(){return k.ERR_WASM_NOT_INIT};m._initFuture=(new Promise(function(a,b){Module.onRuntimeInitialized=function(){try{m.ScanBufferAsync=function(a,b,e,g,k,z){f.debug("ScanBufferAsync");return c(a)||c(b)||c(e)||c(g)||c(k)||c(z)?h.reject(Error("One or more null parameter to ScanBufferAsync")):new h(function(c,f){setTimeout(function(){try{var u=m.heapManager.AllocateString(a),h=m.heapManager.AllocateString(g),p=m.heapManager.AllocateIntArray(d.MAX_EVENTS_PER_ALERT),q=m.heapManager.MakeIntArray(p,
d.MAX_EVENTS_PER_ALERT),E=_xapiSubmitBuffer(e,h,k,z,u,p),n=(new l(E,e,{url:b,isExcluded:!1})).Set(q);c(n)}catch(I){f(I)}},0)},{contractId:m.MakeContractId(e,g,z),expiry:d.CONTRACT_EXPIRY})};m.ScanBuffer=function(a,b,d,e,g,h){f.debug("ScanBuffer");if(c(a)||c(b)||c(d)||c(e)||c(g)||c(h))return(new l(-1,d,{error:Error("One or more parameters is null")})).Set([]);try{var u=this.heapManager.AllocateString(a),k=this.heapManager.AllocateString(e),p=this.heapManager.AllocateIntArray(32),q=this.heapManager.MakeIntArray(p,
32),m=_xapiSubmitBuffer(d,k,g,h,u,p);return(new l(m,d,{url:b,isExcluded:!1})).Set(q)}catch(B){return f.debug("ScanBuffer exception: "+B),(new l(-1,d,{error:B})).Set([])}};m.ScanBufferOOB=function(a,b,e,g,k,l){if(c(a)||c(b)||c(e)||c(g)||c(k)||c(l))return h.reject(Error("One or more null parameter to ScanBufferOOB"));var u={postMessage:function(a){var b=this;f.debug("[XAPI][NATIVE][DBG] _xapiSubmitBuffer ++");setTimeout(function(a){b.onMessage('{"tabId":"'+a.tabId+'","requestId":"'+a.requestId+'","direction":"'+
a.direction+'","status":"0","sigIds":["12","34","67"]}');f.debug("[XAPI][NATIVE][DBG] _xapiSubmitBuffer --")},100,a)},onMessage:function(a){a=JSON.parse(a);r(a.tabId,a.requestId,a.direction,a.status,a.sigIds)}},p={tabId:e,requestId:g,frameID:k,direction:l,buffer:a},q=this.MakeContractId(e,g,l);a=new h(function(a,b){try{m.scanContracts[q]=[a,b],u.postMessage(p)}catch(B){f.debug("Error: ScanBufferOOB: postMessage error: "+B),b(B)}},{contractId:q,expiry:d.CONTRACT_EXPIRY});a.then(function(){delete m.scanContracts[q]},
function(){delete m.scanContracts[q]});return a};m.removeTab=function(a,b){return _xapiRemoveTab(a)};m.EndSession=function(a,b){if(c(a)||c(b))return k.ERR_NULL_PARAM;b=m.heapManager.AllocateString(b);return _xapiEndSession(a,b)};var e={AddSignatureExclusions:function(a){if(!(a instanceof Set))return k.ERR_INVALID_PARAM;if(0==a.size)return k.ERR_PARAM_EMPTY;var b=this.heapManager.AllocateIntArray(new Uint32Array(a));return _xapiAddSignatureExclusions(a.size,b)},RemoveSignatureExclusions:function(a){if(!(a instanceof
Set))return k.ERR_INVALID_PARAM;if(0==a.size)return k.ERR_PARAM_EMPTY;var b=this.heapManager.AllocateIntArray(new Uint32Array(a));return _xapiRemoveSignatureExclusions(a.size,b)},GetSignatureExclusions:function(){var a=_xapiGetSignatureExclusions(0);if(0==a)return new Uint32Array;var b=this.heapManager.AllocateIntArray(a);_xapiGetSignatureExclusions(b);return Uint32Array.from(this.heapManager.MakeIntArray(b,a))},UpdateContent:function(a){if(!(a&&a instanceof Uint8Array))return _xapiUpdateContent(0,
0);var b=k.ERR_CONTENT_UPDATE_FAILURE,c=null;try{c=_malloc(a.length),HEAPU8.set(a,c),b=_xapiUpdateContent(c,a.length)}catch(x){f.debug("Exception while xapiUpdateContent: "+x)}finally{c&&_free(c)}return b},SetupLastKnownGoodContent:function(){return g.OnInitComplete().then(function(a){if(a.self)return a.self.xdb.Query().Select("blob").From("content").Run().then(function(a){return a[0]}).catch(function(a){f.debug("Content fetch from DB failed : "+a)})}).catch(function(a){f.debug("DB is not intialized: "+
a+" (using factory content)")}).then(function(a){var b=e.UpdateContent(a);b!=d.status.STATUS_OK&&a&&(b=e.UpdateContent());return b}).catch(function(a){f.debug("Exception while updating content: "+a);return k.ERR_CONTENT_UPDATE_FAILURE})}};_xapiSetLogLevel(3);m.heapManager=new t;m.scanContracts={};r=function(a,b,c,e,g){g=Array.isArray(g)?g:m.heapManager.MakeIntArray(g,d.MAX_EVENTS_PER_ALERT);b="string"===typeof b?b:UTF8ToString(b);e=(new l(e,a,{url:null,isExcluded:!1})).Set(g);a=m.MakeContractId(a,
b,c);f.debug(a);if(a in m.scanContracts)m.scanContracts[a][0](e)};addFunction(r,"viiiii");e.SetupLastKnownGoodContent().then(function(c){c==d.status.STATUS_OK?a(e):b(Error("Content init failed: "+c))})}catch(q){b(Error("ScannerInterface runtime init failed: "+q.message))}}})).then(function(a){return new n({self:m},a)}).catch(function(a){return new n({self:null,error:a})});m.OnInitComplete=function(){return this._initFuture};return m}(b.SymBfw,XNE)})(this);(function(b){b.XNE.httpScanner=function(b,a){function c(a,b,c){if(!1===Array.isArray(a))throw Error("Invalid headers while making BlockingResponse");c=c==q.direction.request?"requestHeaders":c===q.direction.response?"responseHeaders":null;if(g(c))throw Error("Invalid direction while making BlockingResponse");var d=[],e=[];b=$jscomp.makeIterator(b);for(var f=b.next();!f.done;f=b.next()){f=f.value;if(f.hasOwnProperty("cancel")&&!0===f.cancel)return{cancel:!0};f.hasOwnProperty("headers")&&(d=d.concat(f.headers.filter(function(a){return null===
a.value}).map(function(a){return a.name})),e=e.concat(f.headers.filter(function(a){return null!==a.value})))}b=0<d.length?a.filter(function(a){return!d.includes(a.name)}):[];b=0<e.length?0<b.length?b.concat(e):a.concat(e):b;return 0<b.length?(a={},a[c]=b,a):{cancel:!1}}function d(a){function b(a){setTimeout(function(a){try{l.Get("notificationCallback")(a)}catch(C){w.debug("Exception in notificationCallback: "+C)}},0,a)}var c=r.doTelemetry;if(g(a)||!a.hasOwnProperty("type"))return w.error("[xNDC.Web Error]: ProcessResult: Invalid event"),
{cancel:!1};var d=null;a.optional.isExcluded=a.optional.url&&a.tabId&&v.IsExcluded(a.optional.url,a.tabId)?!0:!1;switch(a.type){case k.msgType.URL_REPUTATION:0<=a.status?(d=a.reputation>=k.reputation.URL_HIGH_RISK?a.recommendation||l.Get("reputationActionHigh"):a.reputation>=k.reputation.URL_MED_RISK?a.recommendation||l.Get("reputationActionMed"):null,f(d)&&(a.optional.reason="Reputation Action",c(k.telemetry.CATEGORY.URLREPUTATION,a.optional.isExcluded?k.telemetry.LABEL.EXCLUSION:d,"URL reputation event: Reputation: "+
a.reputation+" URL: \n                                "+m.url.PIIClean(a.optional.url)))):w.debug("Reputation fetch error: "+a.status);break;case k.msgType.HTTP_HDR_SCANNER:if(0<=a.status){var e=a.sigIds.filter(function(a){return 0!==a});0<e.length&&(d=a.recommendation||l.Get("scanAction"),a.optional.reason="Scan Action",c(k.telemetry.CATEGORY.SCANNER,a.optional.isExcluded?k.telemetry.LABEL.EXCLUSION:d,"Scan action event: SigId: "+e[0]+" URL: "+m.url.PIIClean(a.optional.url)))}else w.debug("Scan Error: "+
a.status);break;case k.msgType.OTHER:d=k.recommendation.ALLOW}a.recommendation=d;switch(d){case k.recommendation.REDIRECT_PAGE:b(a);!a.optional.isExcluded&&0<a.tabId&&l.Get("browserObject").tabs.update(a.tabId,{url:l.Get("redirectionUrl")+k.CLOUDLOOKUP_SIG_ID,active:!0});break;case k.recommendation.BLOCK_PAGE:return b(a),{cancel:!a.optional.isExcluded};case k.recommendation.APPLY_CSP:return b(a),a.optional.isExcluded?{cancel:!1}:{headers:[{name:"Content-Security-Policy",value:"script-src 'none'"}]};
case k.recommendation.ALLOW:b(a);break;case k.recommendation.CANCEL:b(a);a.optional.cancel&&"function"==typeof a.optional.cancel&&a.optional.cancel(a);break;case k.recommendation.ALERT_AND_LOG:b(a);case k.recommendation.SILENT_AND_LOG:w.warn("[xNDC.Web Warn]: Event: "+JSON.stringify(a))}return{cancel:!1}}var g=b.utils.isNil,f=b.utils.isntNil,h=a.scanner,l=a.config,n=a.repManager,k=a.constants,r=a.telemetry,m=a.common,t=a.urlCache,v=a.exclusionManager,w=m.logging.GetLogger("HTTP"),y=m.InitResult,q=
{direction:{request:0,response:1},scanRequestHdr:function(b){var c=b.method,e=b.url,g=new URL(e),k=g.hostname;if(n.IsTrustedHost(k))return w.debug("[Out]Trusted host: "+e),{cancel:!1};var m=0<=b.type.indexOf("main_frame");if(l.Get("allowUrlQuery")&&0==b.frameId&&m){var u=t.reputationManager.Get(e);if(f(u)){if(1==d(u.toGenericResult(b.tabId,{isMainFrame:m})).cancel)return{cancel:!0}}else w.debug("Query reputation: "+e),n.GetReputation(e,{tabId:b.tabId,method:c,documentUrl:b.documentUrl,originUrl:b.originUrl})}return l.Get("allowScan")&&
f(b.requestHeaders)?(w.debug("Scanning request "+b.tabId+":"+b.requestId+" for "+b.url),c=c.toUpperCase(),k="Host: "+k,g=e.substr(e.indexOf(g.hostname)+g.hostname.length),g=c+" "+g+" HTTP/1.1",m=b.requestHeaders.map(function(a){return a.name+": "+a.value}),m.unshift(g),m.push("X-Request-Id: "+b.requestId),m.push(k),["POST","PUT","PATCH","DELETE"].includes(c)&&m.push("Content-Length: 0"),m=m.join("\r\n")+"\r\n",b=(l.Get("isAppConnected")?h.ScanBufferOOB:l.Get("asyncScan")?h.ScanBufferAsync:h.ScanBuffer).bind(h)(m,
e,b.tabId,b.requestId,b.frameId,0),b instanceof a.common.Contract?Promise.all([b.then(d).catch(function(a){w.debug("ScanContract rejected: "+a);return{cancel:!1}})]).then(function(a){return a[0]}):d(b)):{cancel:!1}},scanResponseHdr:function(b){var e=new URL(b.url);if(n.IsTrustedHost(e.hostname))return w.debug("[In]Trusted host: "+b.url),{cancel:!1};var g=0<=b.type.indexOf("main_frame");e={cancel:!1};l.Get("allowUrlQuery")&&0==b.frameId&&g&&(g=t.reputationManager.Get(b.url),f(g)?e=d(g.toGenericResult(b.tabId)):
l.Get("asyncScan")&&(e=n.GetReputation(b.url,{tabId:b.tabId}).then(d).catch(function(a){w.debug("Reputation failure: "+a);return{cancel:!1}})));if(l.Get("allowScan")&&f(b.responseHeaders)){w.debug("Scanning response "+b.tabId+":"+b.requestId+" for "+b.url);g=b.statusLine;var k=b.responseHeaders.map(function(a){return a.name+": "+a.value});k.unshift(g);k=k.join("\r\n")+"\r\n";g=(l.Get("isAppConnected")?h.ScanBufferOOB:l.Get("asyncScan")?h.ScanBufferAsync:h.ScanBuffer).bind(h)(k,b.url,b.tabId,b.requestId,
b.frameId,1);if(g instanceof a.common.Contract)return Promise.all([e,g.then(d).catch(function(a){w.debug("ScanContract rejected: "+a);return{cancel:!1}})]).then(function(a){return c(b.responseHeaders,a,1)}).catch(function(a){w.debug("Error while making BlockingResponse: "+a)});e=c(b.responseHeaders,[d(g),e],1)}return e},removeTab:function(a,b){return h.removeTab(a,b)},onComplete:function(a){h.EndSession(a.tabId,a.requestId)}};q._initFuture=l.OnInitComplete().then(function(){var a=[];2==chrome.runtime.getManifest().manifest_version&&
a.push("blocking");var b=l.Get("browserObject");return new y({self:q,listeners:[[b.webRequest.onBeforeSendHeaders,[q.scanRequestHdr,{urls:["<all_urls>"]},["requestHeaders"].concat(a)]],[b.webRequest.onHeadersReceived,[q.scanResponseHdr,{urls:["<all_urls>"]},["responseHeaders"].concat(a)]],[b.tabs.onRemoved,[q.removeTab]],[b.webRequest.onCompleted,[q.onComplete,{urls:["<all_urls>"]}]]]})}).catch(function(a){return new y({self:null,error:a})});q.OnInitComplete=function(){return this._initFuture};return q}(b.SymBfw,
XNE)})(this);(function(b){b.XNE.init=function(b,a){function c(a){if(A.has(a)){var b=A.get(a);if(b)return Object.assign(Object.create(a),b,{_escalated:!0})}return a}function d(){if(!x){for(var a=$jscomp.makeIterator(this.listenerGroups),b=a.next();!b.done;b=a.next()){b=$jscomp.makeIterator(b.value);for(var c=b.next();!c.done;c=b.next()){c=c.value;try{c[0]&&!c[0].hasListener(c[1][0])&&c[0].addListener.apply(c[0],c[1])}catch(C){w.error("[xNDC.Web Error]: Error while configuring listener "+c+" ("+C+")")}}}x=!0}}function g(){if(x){for(var a=
$jscomp.makeIterator(this.listenerGroups),b=a.next();!b.done;b=a.next()){b=$jscomp.makeIterator(b.value);for(var c=b.next();!c.done;c=b.next()){c=c.value;try{c[0]&&c[0].hasListener(c[1][0])&&c[0].removeListener(c[1][0])}catch(C){w.error("[xNDC.Web Error]: Error while removing listener "+c+" ("+C+")")}}}x=!1}}function f(){this.pollerGroups.forEach(function(b){for(var c in b)try{b[c]=new (Function.prototype.bind.apply(a.common.Poller,[null].concat($jscomp.arrayFromIterable(b[c]))))}catch(D){w.debug("Poller create failure: ("+
D+") <"+b[c]+">")}})}function h(){2==chrome.runtime.getManifest().manifest_version?this.pollerGroups.forEach(function(b){return b.filter(function(b){return b instanceof a.common.Poller}).forEach(function(a){return a.Run()})}):this.pollerGroups.forEach(function(a){a.forEach(function(a){chrome.alarms.get(a.name,function(b){b||chrome.alarms.create(a.name,{periodInMinutes:a.frequency/60})})})})}function l(){2==chrome.runtime.getManifest().manifest_version?this.pollerGroups.forEach(function(b){return b.filter(function(b){return b instanceof
a.common.Poller}).forEach(function(a){return a.Stop()})}):this.pollerGroups.forEach(function(a){a.forEach(function(a){chrome.alarms.get(a.name,function(b){b&&chrome.alarms.clear(a.name)})})})}var n=a.config,k=a.storage,r=a.httpScanner,m=a.scanner,t=a.repManager,v=b.utils.isntNil,w=a.common.logging.GetLogger("INIT"),y=a.cfgctrl,q=a.db,u=a.content,p={},x=!1,A=new WeakMap;p.listenerGroups=[];p.pollerGroups=[];p.isEnabled=function(){return x};p._initFuture=new Promise(function(b,e){p.initialize=function(x){p.initialize=
function(){return p._initFuture};try{Promise.all([k.initialize(x),q.initialize(x),n.initialize(x),m.OnInitComplete(),r.OnInitComplete(),t.OnInitComplete(),y.OnInitComplete(),u.OnInitComplete()]).then(function(b){var c={status:[],enable:!0,fp:new a.common.FlatPromise},d=0;b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next())e=e.value,v(e)&&(e.hasOwnProperty("enable")&&(c.enable=c.enable&&e.enable),e.hasOwnProperty("self")&&v(e.self)?(e instanceof a.common.InitResult&&($jscomp.initSymbol(),
e.self.__symbol__=Symbol(),A.set(e.self,e.SetupPrivilegeAccess(c.fp.promise))),2==chrome.runtime.getManifest().manifest_version&&e.hasOwnProperty("listeners")&&p.listenerGroups.push(e.listeners),e.hasOwnProperty("pollers")&&p.pollerGroups.push(e.pollers)):(e=e.hasOwnProperty("error")?e.error instanceof Error?e.error.message:e.error.toString():"Unknown error",w.error("[xNDC.Web Error]: A soft dependency (seq: "+d+") failed to initialize: "+e),c.status.push(e))),d++;return c}).then(function(k){p.Enable=
d.bind(p);p.Disable=g.bind(p);p.StartPolling=h.bind(p);p.StopPolling=l.bind(p);var m=$jscomp.makeIterator([0,1]),n=m.next().value;m=m.next().value;for(var q=$jscomp.makeIterator(Object.entries(a)),r=q.next();!r.done;r=q.next())r=r.value,a[r[n]]=Object.freeze(r[m]);a=Object.freeze(a);k.fp.resolve(c);setTimeout(function(){f.bind(p)();p.StartPolling()},0);k.enable?(p.Enable(),b({self:p,status:k.status}),w.debug("xneInit success")):e("xneInit disabled")}).catch(function(a){w.error("[xNDC.Web Error]: xneInit failed to initialize: "+
a.message);e(a)})}catch(C){w.error("[xNDC.Web Error]: Exception while initialising xneInit: "+C.message),e(C)}return p._initFuture}});p.OnInitComplete=function(){return this._initFuture};return p}(b.SymBfw,b.XNE)})(this);chrome.webRequest.onBeforeSendHeaders.addListener(function(b){return XNE.init.OnInitComplete().then(function(){return XNE.httpScanner.scanRequestHdr(b)})},{urls:["<all_urls>"]},["requestHeaders"]);chrome.webRequest.onHeadersReceived.addListener(function(b){return XNE.init.OnInitComplete().then(function(){return XNE.httpScanner.scanResponseHdr(b)})},{urls:["<all_urls>"]},["responseHeaders"]);
chrome.tabs.onRemoved.addListener(function(b,d){return XNE.init.OnInitComplete().then(function(){return XNE.httpScanner.removeTab(b,d)})});chrome.webRequest.onCompleted.addListener(function(b){return XNE.init.OnInitComplete().then(function(){return XNE.httpScanner.onComplete(b)})},{urls:["<all_urls>"]});chrome.alarms.onAlarm.addListener(function(b){XNE.init.OnInitComplete().then(function(){XNE.cfgctrl.handleAlarm(b);XNE.content.handleAlarm(b)})});
function handleStartup(){XNE.init.OnInitComplete().then(function(){XNE.cfgctrl.handleStartup();XNE.content.handleStartup();XNE.exclusionManager.handleStartup()})}chrome.runtime.onStartup.addListener(handleStartup);self.addEventListener("install",function(b){b.waitUntil(XNE.init.OnInitComplete());handleStartup()});
