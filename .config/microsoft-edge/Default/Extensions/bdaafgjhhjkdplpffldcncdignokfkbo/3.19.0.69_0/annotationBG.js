!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.annotationSDK=i():t.annotationSDK=i()}(this,(function(){return function(t){var i={};function s(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=t,s.c=i,s.d=function(t,i,n){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)s.d(n,a,function(i){return t[i]}.bind(null,a));return n},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=28)}({0:function(t,i,s){"use strict";s.d(i,"e",(function(){return n})),s.d(i,"a",(function(){return a})),s.d(i,"d",(function(){return e})),s.d(i,"c",(function(){return o})),s.d(i,"b",(function(){return c}));const n={MESSAGES:{FETCH_WRS_RATING:"975843B2-13E8-4947-80C6-97AB31E6F696",IS_ANNOTATION_SUPPORTED_FOR_THIS_PAGE:"33E7E2A5-6FED-4BD6-8722-C92CBEFFAED2",OPEN_FULLREPORT:"0705FC0E-9629-4D48-AC2D-B00AE608EF29",FETCH_ANNOTATION_RULES:"224bd6b4-8a58-4385-b59b-00820d3014f9",ANNOTATION_POPUP_INIT:"5d4c828c-9e03-4f1c-9203-b4c7b8bd9577",DISPLAY_POPUP_MAIN_WINDOW:"04D11A9A-C255-40FF-ABB4-1B157E30D7B8",DISPLAY_POPUP_MAIN_WINDOW_CS:"30AB7916-2441-4AAB-BF89-FD5E7EA5826F"},EXTENSION_PROTOCOL:{Chrome:"chrome-extension:",Firefox:"moz-extension:","Edge-Chromium":"chrome-extension:"},DEFAULT_FULL_REPORT_URL:"https://safeweb.norton.com/report/show",ANNOTATION_DIV_ELEMENT:"annotation-div",ANNOTATION_POPUP_DIV_ELEMENT:"618ED870-F5C2-45EC-9577-C62E3071FA43",ANNOTATION_POPUP_STRINGS:["Threats","This site has not been tested yet","SAFE","SECURE","CAUTION","UNTESTED","UNSAFE","Full Report"],SUPPORTED_LANGUAGES:{el:!0,en:!0,pt_br:!0,it:!0,ar:!0,cs:!0,es:!0,ru:!0,nl:!0,pt:!0,no:!0,nb:!0,tr:!0,ro:!0,pl:!0,fr:!0,zh_tw:!0,de:!0,hu:!0,fi:!0,da:!0,ja:!0,he:!0,zh_cn:!0,ko:!0,sv:!0},MUTATION_OBSERVER_NOT_REQUIRED_DOMAINS:["search.yahoo.com"],ANNOTATION_POPUP_TIMEOUT_DURATION:3e3,RULES_CDN_URL:"https://static.nortoncdn.com/nortonsafesearch/annotation/URLParsingRules.json",ROOT_CA:"\n    -----BEGIN CERTIFICATE-----\n    MIIEvjCCA6agAwIBAgIQBtjZBNVYQ0b2ii+nVCJ+xDANBgkqhkiG9w0BAQsFADBh\n    MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\n    d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD\n    QTAeFw0yMTA0MTQwMDAwMDBaFw0zMTA0MTMyMzU5NTlaME8xCzAJBgNVBAYTAlVT\n    MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxKTAnBgNVBAMTIERpZ2lDZXJ0IFRMUyBS\n    U0EgU0hBMjU2IDIwMjAgQ0ExMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC\n    AQEAwUuzZUdwvN1PWNvsnO3DZuUfMRNUrUpmRh8sCuxkB+Uu3Ny5CiDt3+PE0J6a\n    qXodgojlEVbbHp9YwlHnLDQNLtKS4VbL8Xlfs7uHyiUDe5pSQWYQYE9XE0nw6Ddn\n    g9/n00tnTCJRpt8OmRDtV1F0JuJ9x8piLhMbfyOIJVNvwTRYAIuE//i+p1hJInuW\n    raKImxW8oHzf6VGo1bDtN+I2tIJLYrVJmuzHZ9bjPvXj1hJeRPG/cUJ9WIQDgLGB\n    Afr5yjK7tI4nhyfFK3TUqNaX3sNk+crOU6JWvHgXjkkDKa77SU+kFbnO8lwZV21r\n    eacroicgE7XQPUDTITAHk+qZ9QIDAQABo4IBgjCCAX4wEgYDVR0TAQH/BAgwBgEB\n    /wIBADAdBgNVHQ4EFgQUt2ui6qiqhIx56rTaD5iyxZV2ufQwHwYDVR0jBBgwFoAU\n    A95QNVbRTLtm8KPiGxvDl7I90VUwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG\n    CCsGAQUFBwMBBggrBgEFBQcDAjB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUHMAGG\n    GGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBABggrBgEFBQcwAoY0aHR0cDovL2Nh\n    Y2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNydDBCBgNV\n    HR8EOzA5MDegNaAzhjFodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRH\n    bG9iYWxSb290Q0EuY3JsMD0GA1UdIAQ2MDQwCwYJYIZIAYb9bAIBMAcGBWeBDAEB\n    MAgGBmeBDAECATAIBgZngQwBAgIwCAYGZ4EMAQIDMA0GCSqGSIb3DQEBCwUAA4IB\n    AQCAMs5eC91uWg0Kr+HWhMvAjvqFcO3aXbMM9yt1QP6FCvrzMXi3cEsaiVi6gL3z\n    ax3pfs8LulicWdSQ0/1s/dCYbbdxglvPbQtaCdB73sRD2Cqk3p5BJl+7j5nL3a7h\n    qG+fh/50tx8bIKuxT8b1Z11dmzzp/2n3YWzW2fP9NsarA4h20ksudYbj/NhVfSbC\n    EXffPgK2fPOre3qGNm+499iTcc+G33Mw+nur7SpZyEKEOxEXGlLzyQ4UfaJbcme6\n    ce1XR2bFuAJKZTRei9AqPCCcUZlM51Ke92sRKw2Sfh3oius2FkOH6ipjv3U/697E\n    A7sKPPcw7+uvTPyLNhBzPvOk\n    -----END CERTIFICATE-----\n    ",CERT_INFO:{CERT_ISSUER_NAME:"DigiCert TLS RSA SHA256 2020 CA1",CERT_ISSUED:"static.nortoncdn.com"},ANNOTATION_STORAGE_CONTAINER:"ANNOTATION_STORAGE_CONTAINER",ANNOTATION_RULES:"ANNOTATION_RULES",ANNOTATION_RULES_DOWNLOAD_INTERVAL_IN_MINUTES:1440,ANNOTATION_RULES_DOWNLOAD_RETRY_INTERVAL_IN_MINUTES:30,ANNOTATION_RULES_LAST_DOWNLOAD_TIMESTAMP:"ANNOTATION_RULES_LAST_DOWNLOAD_TIMESTAMP",RETRY_ANNOTATION_RULES_DOWNLOAD:"RETRY_ANNOTATION_RULES_DOWNLOAD",ANNOTATION_RULES_DOWNLOAD:"ANNOTATION_RULES_DOWNLOAD",VISIBILITY_HIDDEN:"hidden"},a=["sb_safeAnnotation.svg","sb_unknownAnnotation.svg","sb_unsafeAnnotation.svg","sb_webnuisanceAnnotation.svg"];var e,o,c;!function(t){t.middleLeft="middleLeft",t.topLeft="topLeft",t.bottomLeft="bottomLeft",t.topRight="topRight",t.bottomRight="bottomRight",t.middleRight="middleRight",t.bottomMiddle="bottomMiddle",t.topMiddle="topMiddle"}(e||(e={})),function(t){t.left="left",t.top="top",t.right="right",t.bottom="bottom"}(o||(o={})),function(t){t.SAFE="Safe",t.CAUTION="Caution",t.WARNING="Warning",t.SUSPICIOUS="Suspicious",t.UNTESTED="Untested",t.MONITORING="Monitoring",t.UNSAFE_TO_SHOP="Unsafe to Shop",t.SAFEWEB_IS_OFF="Safe Web is off",t.PAGE_NOT_ANALYZED="Page not analyzed"}(c||(c={}))},2:function(t,i,s){"use strict";s.d(i,"b",(function(){return n})),s.d(i,"a",(function(){return a}));const n=globalThis.SymBfw,a=globalThis.SafeWeb},25:function(t){t.exports=JSON.parse('{"yahoo":{"organic":[{"url":"//div[contains(@class,\'algo-sr\')]//div//h3//a[contains(@class,\'ac-algo\')]","description":"Common for all the Search Results"},{"url":"//div[contains(@class,\'algo-sr\')]//ul[contains(@class,\'compArticleList\')]//li[contains(@class,\'ov-a\')]//h4/a","description":"Comp Article list is the result occured when we search a keyword like bestbuyapplestore etc"},{"url":"//li[contains(@class,\'first\')]//ul/li//div[2]/p[contains(@class, \'title\')]/a","description":"Top section for specific keywords like online URL parser"},{"url":"//div[@class=\'sw-CardBase\']//div[@class=\'sw-Card__title\']/a","description":"Rule for search.yahoo.co.jp"},{"url":"//div[contains(@class,\'algo-sr\')]//div[contains(@class,\'compTitle\')]/h3//a","description":"Rule for de.search.yahoo.com"},{"url":"//div[contains(@class,\'algo-sr\')]/div[contains(@class,\'compList\')]/ul/li/a[contains(@class,\'tc\')]","description":"Rule for organic sub results"}],"advt":[{"root":"//div[contains(@class,\'AdTop\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class, \'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in top section"},{"root":"//div[contains(@class,\'AdTop\') or contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class, \'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutBottom\') or contains(@class, \'layoutCenter\')]//ul[contains(@class, \'ov-a\')]/li/a","description":"Advt Sub Results in top section for hk.yahoo"},{"root":"//div[contains(@class,\'AdTop\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in top section sg.search.yahoo"},{"root":"//div[contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]/div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in bottom section"},{"root":"//div[contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in bottom section sg.search.yahoo"},{"text":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","url":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in top section but below sub advt results"},{"text":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","url":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in top section but below sub advt results"},{"text":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","url":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in bottom section but below sub advt results"},{"text":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","url":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in bottom section but below sub advt results"},{"text":"//div[contains(@id, \'right\')]//div[contains(@class,\'layoutMiddle\')]/div[contains(@class,\'compTitle\')]/h3[contains(@class, \'title\')]/a","url":"//div[contains(@id, \'right\')]//div[contains(@class,\'layoutMiddle\')]/div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Right side ad results"}]},"ask":{"organic":[{"url":"//div[contains(@class,\'PartialSearchResults\')]//div[contains(@class,\'PartialSearchResults-item\')]/div[contains(@class,\'PartialSearchResults-block-right\')]//a[1]","description":"Common for all the Search Results"}],"advt":[{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si33\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section for mac"},{"text":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"top side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"Bottom side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si39\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si41\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si43\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si42\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"}]},"avira":{"organic":[{"url":"//div[contains(@class,\'PartialSearchResults\')]//div[contains(@class,\'PartialSearchResults-item\')]/div[contains(@class,\'PartialSearchResults-block-right\')]//a[1]","description":"Common for all the Search Results"}],"advt":[{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si33\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"top side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"Bottom side advt section for windows"}]},"google":{"organic":[{"url":"//div[contains(@class,\'g\')]//div[contains(@class,\'yuRUbf\')]/a","description":"Common search results"},{"url":"//g-section-with-header//div[contains(@class,\'EPLo7b\')]//div[contains(@class,\'HCUNre\')]/a","text":"//g-section-with-header//div[contains(@class,\'EPLo7b\')]//div[contains(@class,\'HCUNre\')]/a//div[contains(@role,\'heading\')]","description":"Top Stories section"},{"root":"//div[contains(@id,\'search\')]//div[contains(@class,\'hlcw0c\')]/div[contains(@class,\'g\')]","parentUrl":".//div[contains(@class,\'yuRUbf\')]/a","childItems":".//div[contains(@class,\'usJj9c\')]/h3/a","description":"Sub Results"}],"advt":[{"url":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a","text":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a/div[contains(@class,\'MUxGbd\')]","description":"Top advt section without sub results"},{"root":"//div[contains(@class,\'uEierd\')]","parentUrl":".//div[contains(@class,\'v5yQqb\')]/a/div[2]/span[2]","parentText":".//div[contains(@class,\'v5yQqb\')]/a/div[contains(@class,\'MUxGbd\')]","childItems":".//div[contains(@class,\'fCBnFe\')]/h3/div[contains(@role,\'listitem\')]/a","readParentUrlAsTextElement":true,"description":"Sub Results"}]},"bing":{"organic":[{"url":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]//h2/a","description":"Common for all the Search Results"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":"./h2/a","childItems":".//ul[contains(@class,\'b_vList\')]//div[contains(@class,\'b_listnav_item\')]/div[contains(@class,\'b_single_title\')]/a","description":"Sub Results in single colum"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":".//div[contains(@class, \'b_title\')]/h2/a","childItems":".//div[contains(@class,\'dlCollapsedCnt\')]/div[contains(@class,\'b_deep\')]//h3/a","description":"Organic sub results in bing japan url"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":"./h2/a","childItems":".//div[contains(@class,\'dlCollapsedCnt\')]/div[contains(@class,\'b_deep\')]//h3/a","description":"Sub Results which occurs under the search results e.g norton"},{"url":"//ol[contains(@id,\'b_results\')]//div[contains(@class,\'b_algo\')]/h2/a","description":"Top and Bottom Bleed results when searching oops polymorphism etc"},{"url":"//ol[contains(@id,\'b_results\')]//div[contains(@class,\'b_rs\')]//ul[contains(@class,\'b_vList\')]/li/a","description":"Results of related searches which is displayed on the footer"}],"advt":[{"text":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]/h2/a[last()]","url":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]//div[contains(@class,\'b_adurl\')]/cite","description":"top and bottom advt section"},{"root":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]","parentUrl":".//div[contains(@class,\'b_caption\')]//div[contains(@class,\'b_adurl\')]/cite","parentText":".//h2//a[contains(@h,\'Ads\')]","childItems":".//div[contains(@class,\'b_vlist2col\')]//h3[contains(@class,\'ad\')]/a | .//div[contains(@class,\'b_vlist2col\')]//span[contains(@class,\'ad\')]/a","readParentUrlAsTextElement":true,"description":"Sub Results advt section"}]}}')},28:function(t,i,s){"use strict";s.r(i);var n=s(0),a=s(25),e=s(2);const{settings:o}=e.b;const c=new class{constructor(){this._container=null}_checkInitialized(){if(!this._container)throw new Error("Storage accessed before initialization")}initialize(){return new Promise((t,i)=>{o.loadSettingsContainer(n.e.ANNOTATION_STORAGE_CONTAINER,!0,(s,n,a)=>{!1!==s&&n?(this._container=n,t(!0)):i(a)})})}getValue(t){return this._checkInitialized(),this._container.getObject(t)}setValue(t,i){this._checkInitialized(),this._container.setObject(t,i)}};var l=function(t,i,s,n){return new(s||(s=Promise))((function(a,e){function o(t){try{l(n.next(t))}catch(t){e(t)}}function c(t){try{l(n.throw(t))}catch(t){e(t)}}function l(t){var i;t.done?a(t.value):(i=t.value,i instanceof s?i:new s((function(t){t(i)}))).then(o,c)}l((n=n.apply(t,i||[])).next())}))};const{cdnFileDownloader:d,logger:r,alarmHelper:u}=e.b;class A{static _retryFetchRules(){return l(this,void 0,void 0,(function*(){u.setAlarm(n.e.RETRY_ANNOTATION_RULES_DOWNLOAD,{delayInMinutes:n.e.ANNOTATION_RULES_DOWNLOAD_RETRY_INTERVAL_IN_MINUTES})}))}static _fetchRules(){return l(this,void 0,void 0,(function*(){try{const t=yield d.getPayloadFromCdnFile(n.e.RULES_CDN_URL,n.e.ROOT_CA,n.e.CERT_INFO);c.setValue(n.e.ANNOTATION_RULES,t)}catch(t){r.error("Fetching rules from CDN failed.",t),A._retryFetchRules()}}))}static initializeRules(){return l(this,void 0,void 0,(function*(){yield c.initialize();c.getValue(n.e.ANNOTATION_RULES)||(yield A._fetchRules()),A.createRulesDownloadAlarm()}))}static _handleAnnotationRulesAlarm(){return l(this,void 0,void 0,(function*(){yield c.initialize(),yield A._fetchRules()}))}static createRulesDownloadAlarm(){return l(this,void 0,void 0,(function*(){yield u.setAlarm(n.e.ANNOTATION_RULES_DOWNLOAD,{periodInMinutes:n.e.ANNOTATION_RULES_DOWNLOAD_INTERVAL_IN_MINUTES})}))}static handleAlarm(t){t&&t.name&&(t.name!==n.e.ANNOTATION_RULES_DOWNLOAD&&t.name!==n.e.RETRY_ANNOTATION_RULES_DOWNLOAD||A._handleAnnotationRulesAlarm())}}e.b.alarmHelper.registerAlarmListener(A.handleAlarm);var T=function(t,i,s,n){return new(s||(s=Promise))((function(a,e){function o(t){try{l(n.next(t))}catch(t){e(t)}}function c(t){try{l(n.throw(t))}catch(t){e(t)}}function l(t){var i;t.done?a(t.value):(i=t.value,i instanceof s?i:new s((function(t){t(i)}))).then(o,c)}l((n=n.apply(t,i||[])).next())}))};const _=n.e.MESSAGES,{cdnFileDownloader:v,extensionAdapter:N,localizer:h,logger:E,utils:{isntNil:p}}=e.b,R=e.a.Rating;i.default={AnnotationBG:class{constructor(){this._enableFlag=!0,this._domains=null,this._uiConfig=null,this._safeWebInitPromise=void 0,this._supportedDomains=null,this._initReadyPromise=null,this.initializeLocalizer=function(){const t=N.getExtensionURL("/content/i18n/annotationsdk");return new Promise((i,s)=>{h.initialize(n.e.SUPPORTED_LANGUAGES,(function(t,i){!0===t&&E.debug("localizer initialize success")}),t),h.loadDictionary("annotation_strings",(t,n)=>{!0===t?(E.debug("Loading annotation Strings status - "+t),i("localizer is ready")):s("localizer loadDictionary failed: "+n)})})}}_getSiteStatus(t){let i=n.b.PAGE_NOT_ANALYZED;switch(t){case R.SITE_RATING.SW_UNTRUSTED_TRANSACTION_STATE:i=n.b.UNSAFE_TO_SHOP;break;case R.SITE_RATING.SW_KNOWN_PHISHING_STATE:case R.SITE_RATING.SW_SUSPECTED_PHISHING_STATE:case R.SITE_RATING.SW_KNOWN_MALICIOUS_STATE:case R.SITE_RATING.SW_PAGE_BAD_UNTRUSTED_TRANSACTION_STATE:case R.SITE_RATING.SW_ERROR_STATE:i=n.b.WARNING;break;case R.SITE_RATING.SW_REGIONAL_BLOCK:i=n.b.SUSPICIOUS;break;case R.SITE_RATING.SW_NEUTRAL_STATE:i=n.b.UNTESTED;break;case R.SITE_RATING.SW_CAUTION_MALICIOUS_STATE:i=n.b.CAUTION;break;case R.SITE_RATING.SW_PENDING_STATE:i=n.b.MONITORING;break;case R.SITE_RATING.SW_TRUSTED_STATE:case R.SITE_RATING.SW_TRUSTED_TRANSACTION_STATE:case R.SITE_RATING.SW_NORTON_CERTIFIED:i=n.b.SAFE;break;case R.SITE_RATING.SW_DISABLED_STATE:i=n.b.SAFEWEB_IS_OFF;break;default:i=n.b.PAGE_NOT_ANALYZED}return i}_fetchRatingsFromSafewebSDK(t,i,s){return T(this,void 0,void 0,(function*(){let n,a;const e={senderURL:s},o={senderURL:s,bAdvtFlag:!0};this._safeWebInitPromise&&(yield this._safeWebInitPromise),n=0===t.length?[]:this._getRatingsFromSafeweb(t,e),a=0===i.length?[]:this._getRatingsFromSafeweb(i,o);return(yield Promise.all([n,a])).flat()}))}_getRatingsFromSafeweb(t,i){const s=e.a.manager,n=this;return new Promise(a=>{s.getRatingsForURLs(t,t=>{a(t.map(t=>{var i,s;t.siteStatus=n._getSiteStatus(t.siteRating);const a=null===(s=null===(i=this._uiConfig)||void 0===i?void 0:i.popupUIConfig)||void 0===s?void 0:s.isShowFullReport;return p(a)?t.showFullReport=a:t.showFullReport=t.siteRating!==R.SITE_RATING.SW_REGIONAL_BLOCK,t}))},i)})}_checkAnnotationSupportedForThisPage(t,i){return T(this,void 0,void 0,(function*(){yield this.ready(),i(this._isSearchDomainSupported(t))}))}_fetchAnnotationRules(t,i){return T(this,void 0,void 0,(function*(){yield this.ready();const s=new URL(t),e=c.getValue(n.e.ANNOTATION_RULES)||a,o=Object.keys(e).find(t=>s.hostname.includes(`.${t}.`));i(e[o])}))}_fetchWrsRating(t,i,s,n){return T(this,void 0,void 0,(function*(){if(!this.isAnnotationEnabled()||!this._isSearchDomainSupported(t))return void n(null);yield this.ready();this._fetchRatingsFromSafewebSDK(i,s,t).then(n)}))}_initAnnotationPopup(t){return T(this,void 0,void 0,(function*(){yield this.ready();const i={strings:{},uiConfig:this._uiConfig};i.strings=h.getLocalizedStringsFromDictionary(n.e.ANNOTATION_POPUP_STRINGS,"annotation_strings"),t(i)}))}_handleMessage(t,i,s){const n=t.payload;switch(t.id){case _.OPEN_FULLREPORT:n.fullReportURL&&N.createTab(n.fullReportURL);break;case _.IS_ANNOTATION_SUPPORTED_FOR_THIS_PAGE:return this._checkAnnotationSupportedForThisPage(s.url,i),!0;case _.FETCH_ANNOTATION_RULES:return this._fetchAnnotationRules(s.url,i),!0;case _.FETCH_WRS_RATING:return this._fetchWrsRating(s.url,n.urls,n.AdvtURLs,i),!0;case _.ANNOTATION_POPUP_INIT:return this._initAnnotationPopup(i),!0;case _.DISPLAY_POPUP_MAIN_WINDOW:n.uiConfig=this._uiConfig;const t={id:_.DISPLAY_POPUP_MAIN_WINDOW_CS,payload:n};N.sendMessageToTab(s,t)}}_isSearchDomainSupported(t){const i=new URL(t);return this._domains.supportedDomains.filter(t=>i.hostname.match(t.domain)).some(t=>{const s=t.params;if(!s)return!0;const n=i.searchParams;return Object.entries(s).every(([t,i])=>!!n.has(t)&&(i.includes("*")||i.includes(n.get(t))))})}isAnnotationEnabled(){return this._enableFlag}enableAnnotation(t){this._enableFlag=t}ready(){return T(this,void 0,void 0,(function*(){yield this._initReadyPromise}))}_initializeListeners(t,i){try{this._handleMessage=this._handleMessage.bind(this),N.addMessageListener(this._handleMessage),Promise.all([this.initializeLocalizer(),A.initializeRules()]).then(i=>{t("Initialized Annotation SDK")}).catch(t=>{i("Annotaion BG listeners initialization error: "+t)})}catch(t){i("Annotaion BG listeners initialize failed: "+t)}}init(t){return T(this,void 0,void 0,(function*(){return this._domains=t.domains,this._safeWebInitPromise=t.safeWebInitPromise,this._uiConfig=t.uiConfig,p(this._initReadyPromise)||(this._initReadyPromise=new Promise((t,i)=>{this._initializeListeners(t,i)})),this._initReadyPromise}))}}}}}).default}));